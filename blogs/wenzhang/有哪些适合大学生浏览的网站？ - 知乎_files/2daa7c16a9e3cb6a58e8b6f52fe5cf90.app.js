(function(a){with(a){
a.Lr=function(b,c){this.ba=b;this.offset=c},a.Mr=function(b){return b.length||b.childNodes.length},a.Nr=function(b,c,d){for(;1==b.nodeType;){var e=b.childNodes[c];if(!e&&!b.lastChild)break;e?(b=e.previousSibling,d&&b?c=Mr(b):(b=e,c=0)):(b=b.lastChild,c=Mr(b))}return new Lr(b,c)},a.Or=function(b,c){b!=k&&this.append.apply(this,arguments)};t=Or.prototype;t.xh="";t.set=function(b){this.xh=""+b};t.append=function(b,c,d){this.xh+=b;if(c!=k)for(var e=1;e<arguments.length;e++)this.xh+=arguments[e];return this};
t.clear=function(){this.xh=""};t.qr=u(49);t.toString=p("xh");a.Pr=function(b){this.type="anon_change";this.ib=b};z(Pr,fd);a.Qr=function(b){if("outerHTML"in b)return b.outerHTML;var c=Qb(b).createElement("div");c.appendChild(b.cloneNode(j));return c.innerHTML},a.Y=function(b,c){return da[b]=c};Of.prototype.expand=Y(63,function(b,c,d,e){qa(b)?(this.top-=b.top,this.right+=b.right,this.bottom+=b.bottom,this.left-=b.left):(this.top-=b,this.right+=c,this.bottom+=d,this.left-=e);return this});
Hj.prototype.expand=Y(62,function(){this.Ka(j)});Ph.prototype.lm=Y(61,function(b){Qh(this);this.Jk=b});wi.prototype.lm=Y(60,function(b){this.Jk=b;this.za&&xi(this)});oj.prototype.mm=Y(56,function(b){this.Ea(b)});Xd.prototype.mi=Y(55,ca("CF"));Ph.prototype.Cx=Y(54,function(){return this.Bj||150>za()-this.Kx});yn.prototype.Bb=Y(53,function(){var b=this.rc();return 1==b.nodeType?b:b.parentNode});vh.prototype.Jf=Y(52,ca("vi"));Rj.prototype.Jf=Y(51,ca("vi"));gp.prototype.Ie=Y(50,function(b){this.Z.wt(b)});
Or.prototype.qr=Y(49,function(){return this.xh.length});Kn.prototype.Ec=Y(34,function(){return this.P.toString()});Pn.prototype.Ec=Y(33,function(){return this.P.text});Zn.prototype.Ec=Y(32,function(){return co(this).Ec()});fo.prototype.Ec=Y(31,s(""));mo.prototype.Ec=Y(30,function(){return A.map(An(this),function(b){return b.Ec()}).join("")});uq.prototype.Ec=Y(29,function(){return Ec(this.h())});
Pb.prototype.qv=Y(24,function(b,c,d){for(var e=this.Ha,g=!!d,d=["<tr>"],h=0;h<c;h++)d.push(g?"<td>&nbsp;</td>":"<td></td>");d.push("</tr>");d=d.join("");c=["<table>"];for(h=0;h<b;h++)c.push(d);c.push("</table>");b=e.createElement("DIV");b.innerHTML=c.join("");return b.removeChild(b.firstChild)});Uh.prototype.ap=Y(21,ca("Vj"));oj.prototype.ap=Y(20,ca("Vj"));vh.prototype.sz=Y(19,function(b){this.$w=Math.pow(b,2)});
gf.prototype.Yp=Y(16,function(b,c,d){var e=za(),g=d?d:e,h=this.il.Bg.length?this.il.Bg.pop():this.il.Uk();h.er=2;h.dr=g;h.type=c;h.WB=b;b=(b=this.RW)&&b.isTracing()?b.totalVarAlloc:-1;h.JH=b;this.kv++;if(d){d=this.Lf.length;for(b=0;b<d;b++)if(this.Lf[b].dr>g){A.Un(this.Lf,h,b);break}b==d&&this.Lf.push(h)}else this.Lf.push(h);if(g=h.type)h=this.hk.get(g),h||(h=this.kp.Bg.length?this.kp.Bg.pop():this.kp.Uk(),h.type=g,this.hk.set(g,h)),h.count++;this.Vt+=za()-e});
Zd.prototype.config=Y(15,function(b,c){this.log(ee,b,c)});Ph.prototype.yt=Y(14,function(b,c){this.wm=b;this.Cl=c});Rh.prototype.yt=Y(13,function(b,c,d,e){this.Tj=b;this.Sj=c;this.Lk=d;this.Kk=e});Sm.prototype.rw=Y(12,function(){return Vm});qp.prototype.or=Y(0,p("Ja"));
a.Rr=function(b,c){b.Yx=c==k||c instanceof Of?c:new Of(c,i,i,i);b.Q()&&b.Y()},a.Sr=function(b){return b.Qd?b.Ja:b.Ja.h()},a.Tr=function(b){b.zx=j;b.kC=tg(b.h()).height;Wo+=b.kC;A.forEach(Uo,function(b){b&&(!b.zx&&b.nl)&&b.No()})},a.Ur=function(b,c){var d=b.parentNode,e=A.indexOf(d.childNodes,b)+(c?0:1),d=Nr(d,e,c);B&&(E("9")&&1==d.ba.nodeType&&"HR"==d.ba.tagName)&&(e=d.ba,d.ba=e.parentNode,d.offset=A.indexOf(d.ba.childNodes,e)+(c?0:1));to(d.ba,d.offset).select()},a.Vr=function(b,c){return b.Cd.get(c)},
a.Wr=function(b,c){if(xl(b))b.selectionStart=c,b.selectionEnd=c;else if(B){var c=Al(b,c),d=b.createTextRange();d.collapse(j);d.move("character",c);d.select()}},a.Xr=function(b){var c={};A.forEach(b.data.Db(),function(b){c[b]=this.data.get(b)},b);return c},a.Yr=function(b){b.Xb()&&b.fire()},a.Zr=function(b,c,d){var e=Ki,g={title:"确认使用匿名身份？",content:'<p>使用匿名身份后，你将</p><ul style="margin: 5px 0 0 5px;list-style-position: inside;"><li>不能在该问题下评论（你之前的评论将被隐藏）</li><li>不能邀请别人回答该问题</li></ul>'},h={title:"确认放弃匿名身份？",
content:"你对该问题的回答、赞同和关注行为将以实名显示。"};Bi(b?g:h,function(g){if(g){var h=new V(j),q="/question/"+(b?"set_anonymous":"set_public"),r="qid="+(d||dh.ha);h.on("success",function(){var c=Ie(h);c&&!c.r&&e.dispatchEvent(new Pr(b))});h.ajax(q,r)}c&&c(g)})},a.$r=function(b,c){return b.Sb&&c?A.indexOf(b.Sb,c):-1},a.as=function(b){return b!=k},a.bs=function(b){return!/[^\t\n\r ]/.test(b)},a.cs=function(b,c,d){this.HF=b;this.FR=!!d;b&&!c&&this.next()};z(cs,Md);
cs.prototype.next=function(){var b=this.HF;b||f(P.$a);this.HF=this.FR?b.previousSibling:b.nextSibling;return b};a.ds=function(b){return 1==b.nodeType||3==b.nodeType&&!bs(b.nodeValue)},a.es=function(b){try{return b.next()}catch(c){return k}},a.fs=function(b,c,d){ka(d)||(d=c&&b.childNodes.length?b.childNodes.length-1:0);cs.call(this,b.childNodes[d],j,c)};z(fs,cs);
a.gs=function(b){return 1==b.length?"0"+b:b},a.hs=/^#(?:[0-9a-f]{3}){1,2}$/i,a.is=function(b,c,d,e,g,h,l,n,q){fd.call(this,b);this.FW=c;this.event=d;this.AW=e;this.GW=g;this.Xq=h;this.HW=l;this.aX=n;this.bX=q};z(is,fd);
a.js=function(b,c){return b>c},a.ks=function(b,c){return b<c},a.ls=function(b){return b.left||0},a.ms=function(b){return b.left+b.width-1},a.ns=function(b){return b.top+b.height-1},a.os=function(b,c){var d=b.bl;return Math.abs(c.y-(d.top+(d.height-1)/2))},a.ps=function(b,c){var d=$.extend({all:m},ps.defaults,c||{}),e=$(b).get(0).getBoundingClientRect();return!d.all&&(e.bottom<d.paddingTop||e.bottom>$(window).height())||d.all&&(e.top<d.paddingTop||e.bottom>$(window).height())?m:j};ps.defaults={paddingTop:0};
a.qs=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,a.rs=/#(.)(.)(.)/,a.ss=function(b,c,d){var e=dg(b);c instanceof Kb&&(d=c.y,c=c.x);$f(b,b.offsetLeft+(c-e.x),b.offsetTop+(d-e.y))},a.ts=function(b){var c=b.body,b=b.documentElement;return new Kb(c.scrollLeft||b.scrollLeft,c.scrollTop||b.scrollTop)},a.us=function(b,c){this.Dh=b instanceof Kb?b:new Kb(b,c)};z(us,pq);
us.prototype.Y=function(b,c,d,e){var g=ts(Qb(b)),h=this.Dh.x+g.x,g=this.Dh.y+g.y,l=cm(b),h=h-l.x,g=g-l.y;dm(new Kb(h,g),b,c,d,k,k,e)};a.vs=function(b){for(var c;c=!b||1!=b.nodeType?k:es(P.filter(new fs(b,m),ds));)b=c;return b},a.ws=function(b,c,d){pn.call(this,b,0,d?"添加父话题":"添加子话题");this.Dx=d;this.uf=c;this.Wr="";this.MG="/topic/parent/remove";this.$V=j};z(ws,pn);t=ws.prototype;t.o=function(b){if(this.isEnabled=!b.getAttribute("data-disabled"))ws.n.o.call(this,b),this.Ee(j),Q(this.cD,m)};
t.Ig=function(b){var c;this.Dx&&(c="/topic/autocomplete?no_create=true");ws.n.Ig.call(this,b,c);this.T.Fe.$C=m};t.gm=function(){return v(function(b,c){return A.filter(b,function(b){return 3>=b.length?m:A.every(this.data,function(e){return e[1]===b[2]?c===b[1]?(b[0]="plain_text",b[1]='"'+c+'"已在现有列表中',j):m:j})},this)},this)};
t.Qe=function(b,c){this.Og||(this.Og=j,this.xhr=new V(j),ne(this.m(),this.xhr,"complete",this.Bu),b||(b=-1),this.Dx?this.xhr.ajax("/topic/add","tid="+this.uf+"&pid="+b+"&topic_text="+encodeURIComponent(c)):this.xhr.ajax("/topic/add","tid="+this.uf+"&cid="+b+"&topic_text="+encodeURIComponent(c)))};t.kD=function(b){return'<a class="nor" href="/topic/'+b[1]+'/organize">'+b[0]+"</a>"};
t.Go=function(b){if(!this.ia||!this.ia.Xb()){var c=new V(j);this.m().e(c,"success",function(){var d=Ie(c);d.r?U(d.msg):(rn(this),this.Je(),this.dispatchEvent({type:"remove_tag",data:{id:b}}))});this.Dx?c.ajax(this.MG,"cid="+this.uf+"&pid="+b):c.ajax(this.MG,"pid="+this.uf+"&cid="+b);this.ia=c}};a.xs=function(){N.call(this);this.Qc=[];this.cl=[];this.Jv={};this.O=new le(this);this.gO=this.KE=m;this.pA=j};z(xs,Fd);t=xs.prototype;t.jE=0;t.sz=ca("jE");a.ys=function(b,c,d){c.IC=d;c.Vi=i;b.Qc.push(c)};
t.B=function(){if(!this.KE){for(var b=0,c=this.Qc.length;b<c;b++)for(var d=nc(this.Qc[b]),e=0,g=d.length;e<g;++e){var h=d[e],l=h,n=ua(l);this.Jv[n]=h;this.LC&&(this.O.e(h,"mouseover",this.vM),this.O.e(h,"mouseout",this.uM));this.KC&&(this.O.e(l,"mouseover",this.tM),this.O.e(l,"mouseout",this.sM));this.cl.push(h);this.O.e(l,["mousedown","touchstart"],this.ZM)}this.KE=j}};
t.w=function(){this.O.G();for(var b=0,c=this.Qc.length;b<c;b++){var d=this.Qc[b];d.IC=i;d.Vi=i}this.Qc.length=0;this.cl.length=0;this.Jv=k;zs(this);xs.n.w.call(this)};a.As=function(b,c){for(var d=0,e=b.Qc.length;d<e;d++){var g=b.Qc[d];g.bl=og(g)}d=0;for(e=b.cl.length;d<e;d++)g=b.cl[d],g!=c&&(g.bl=og(g))};
t.ZM=function(b){var c=ua(b.currentTarget);this.wa=this.Jv[c];a:{var c=this.wa,d=c.cloneNode(j);switch(c.tagName.toLowerCase()){case "tr":c=L("table",k,L("tbody",k,d));break a;case "td":case "th":c=L("table",k,L("tbody",k,L("tr",k,d)));break a;default:c=d}}this.yb=c;this.Yq&&F.add(this.yb,this.Yq);this.yb.style.margin="0";this.yb.style.position="absolute";this.yb.style.visibility="hidden";Qb(this.wa).body.appendChild(this.yb);c=dg(this.wa);ss(this.yb,c);this.zb=new vh(this.yb);this.zb.sz(this.jE);
O(this.zb,"start",this.Lw,m,this);O(this.zb,"end",this.qM,m,this);O(this.zb,"earlycancel",this.ev,m,this);this.zb.zm(b)};
t.Lw=function(b){if(this.dispatchEvent(new is("beforedragstart",this,b.GB,this.wa,k,k))){this.Os=this.wa.parentNode;this.iC=this.Fy=this.wa.nextElementSibling!=i?this.wa.nextElementSibling:oc(this.wa.nextSibling,j);this.vv=this.Os;this.uv?F.add.apply(k,A.concat(this.wa,this.uv)):this.wa.style.visibility="hidden";var c=ng(this.yb);this.yb.aM=c.width/2;this.yb.$L=c.height/2;this.yb.style.visibility="";this.pA&&(this.wa.style.display="none");As(this,this.wa);this.wa.style.display="";O(this.zb,"drag",
this.wM,m,this);this.dispatchEvent(new is("dragstart",this,b.GB,this.wa,this.yb,this.zb))}else b.preventDefault(),this.ev()};
t.wM=function(b){var c=dg(this.yb),c=new Kb(c.x+this.yb.aM,c.y+this.yb.$L),d;a:{d=k;if("none"!=this.wa.style.display){d=this.wa.parentNode;var e=og(d);if(Bs(c,e))break a}for(var e=0,g=this.Qc.length;e<g;e++){var h=this.Qc[e];if(h!=d&&Bs(c,h.bl)){d=h;break a}}d=k}var l;if(d){d==k&&f(Error("getHoverNextItem_ called with null hoverList."));var n,q,e=m,g=i;switch(d.IC){case 0:l=c.y;n=ns;q=ks;break;case 4:e=j;case 2:l=c.x;n=ms;q=ks;break;case 5:e=j;case 3:l=c.x,n=ls,q=js}for(var h=k,r,w=nc(d),x=0,G=w.length;x<
G;x++){var I=w[x];if(I!=this.wa){var R=n(I.bl);if(e){var Z=os(I,c);ka(g)||(g=Z);if(q(l,R)&&(r==i||Z<g||Z==g&&(q(R,r)||R==r)))h=I,r=R;Z<g&&(g=Z)}else if(q(l,R)&&(r==i||q(R,r)))h=I,r=R}}l=h!==k&&os(h,c)>g?k:h}else l=k;if(!this.dispatchEvent(new is("beforedragmove",this,b,this.wa,this.yb,this.zb,c,d,l)))return m;if(d)this.pA?(this.wa.parentNode!=d||(this.wa.nextElementSibling!=i?this.wa.nextElementSibling:oc(this.wa.nextSibling,j))!=l)&&d.insertBefore(this.wa,l):l&&(this.iC=l),this.wa.style.display=
"",d.Vi&&F.add(d,d.Vi);else{this.gO||(this.wa.style.display="none");n=0;for(q=this.Qc.length;n<q;n++)r=this.Qc[n],r.Vi&&F.remove(r,r.Vi)}d!=this.vv&&(this.vv=d,As(this,this.wa));this.dispatchEvent(new is("dragmove",this,b,this.wa,this.yb,this.zb,c,d,l));return m};t.ev=function(){zs(this);this.zb=this.yb=this.Fy=this.Os=this.vv=this.wa=k;for(var b=0,c=this.Qc.length;b<c;b++)this.Qc[b].bl=k;b=0;for(c=this.cl.length;b<c;b++)this.cl[b].bl=k};
t.qM=function(b){if(!this.dispatchEvent(new is("beforedragend",this,b,this.wa,this.yb,this.zb)))return m;this.pA||this.Os.insertBefore(this.wa,this.iC);zs(this);this.dispatchEvent(new is("dragend",this,b,this.wa,this.yb,this.zb));this.ev();return j};
a.zs=function(b){Sc(b.zb);b.yb&&M(b.yb);b.wa&&"none"==b.wa.style.display&&(b.Os.insertBefore(b.wa,b.Fy),b.wa.style.display="");b.uv&&b.wa?F.remove.apply(k,A.concat(b.wa,b.uv)):b.wa&&(b.wa.style.visibility="visible");for(var c=0,d=b.Qc.length;c<d;c++){var e=b.Qc[c];e.Vi&&F.remove(e,e.Vi)}};t.vM=function(b){F.add.apply(k,A.concat(b.currentTarget,this.LC))};t.uM=function(b){F.remove.apply(k,A.concat(b.currentTarget,this.LC))};t.tM=function(b){F.add.apply(k,A.concat(b.currentTarget,this.KC))};
t.sM=function(b){F.remove.apply(k,A.concat(b.currentTarget,this.KC))};
a.Bs=function(b,c){return b.x>c.left&&b.x<c.left+c.width&&b.y>c.top&&b.y<c.top+c.height},a.Cs=function(b,c){if(b){"number"===$.type(c)&&(c={offsetTop:c});var d=$.extend({fI:ps},dl,c||{});if(!d.fI(b,d)){var e=$(b).offset().top-d.paddingTop-d.offsetTop||0;d.pB?$(document.documentElement).add(document.body).animate({scrollTop:e}):$(window).scrollTop(e)}}},a.Ds=function(b,c){c.all=j;return ps(b,c)},a.Es=function(b,c,d,e){var g=k;e&&(d&&(d=$.proxy(d,e)),g&&(g=$.proxy(g,e)));$.get("/node/"+b,{params:c},
function(b){b&&b.r?g&&g(b):d&&d(b)})},a.Fs=function(b){var c=b.match(qs);if(c){var b=Number(c[1]),d=Number(c[2]),c=Number(c[3]);if(0<=b&&255>=b&&0<=d&&255>=d&&0<=c&&255>=c)return[b,d,c]}return[]},a.Gs=function(b){hs.test(b)||f(Error("'"+b+"' is not a valid hex color"));4==b.length&&(b=b.replace(rs,"#$1$1$2$2$3$3"));return b.toLowerCase()},a.Hs={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",
blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",
darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",
ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",
magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",
palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",
tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},a.Is=/[^\d]+$/,a.Js=function(b,c){us.call(this,b,c)};z(Js,us);Js.prototype.fo=0;Js.prototype.om=ca("fo");
Js.prototype.Y=function(b,c,d,e){var g=ag(b),g=fg(g),h;h=Rb(b);h=Yb(h.Ha);h=new Kb(this.Dh.x+h.scrollLeft,this.Dh.y+h.scrollTop);var l=c,n=dm(h,b,l,d,g,10,e);if(0!=(n&496)){if(n&16||n&32)l^=2;if(n&64||n&128)l^=1;n=dm(h,b,l,d,g,10,e);0!=(n&496)&&dm(h,b,c,d,g,this.fo,e)}};a.Ks=function(b,c,d,e){qq.call(this,b,c);this.fo=d?5:0;this.Iy=e||i};z(Ks,qq);Ks.prototype.Bn=p("fo");Ks.prototype.om=ca("fo");
Ks.prototype.Y=function(b,c,d,e){var g=em(this.element,this.Ff,b,c,k,d,10,e,this.Iy);if(g&496){var h=Ls(g,this.Ff),c=Ls(g,c),g=em(this.element,h,b,c,k,d,10,e,this.Iy);g&496&&(h=Ls(g,h),c=Ls(g,c),em(this.element,h,b,c,k,d,this.Bn(),e,this.Iy))}};
a.Ls=function(b,c){b&48&&(c^=2);b&192&&(c^=1);return c},a.Ms=function(b){to(vs(b),0).select()},a.Ns=function(b,c){var d=Fc(b);if(b.getElementsByTagName)for(var e in So)if(b.tagName==e||0<b.getElementsByTagName(e).length)return m;return!c&&" "==d||bs(d)},a.Os=j,a.Ps=function(b){if(b=zn(b||window))if(b.empty)try{b.empty()}catch(c){}else try{b.removeAllRanges()}catch(d){}},a.Qs=function(b){pn.call(this);this.lC=k;this.Ae="例如：互联网、医学、法律、数学...";this.data=b||[]};z(Qs,pn);t=Qs.prototype;
t.o=function(b){this.g=b;this.gg=K("zm-tag-editor-labels",this.g);this.Ee(j);this.ne();this.nb();this.Mf=J("zh-expert-topics");this.Im=J("zh-active-topics");if(this.Mf)$(this.Mf).on("click",".del",$.proxy(function(b){var d=$(b.target).parents(".item");d.data("active")?(kc(this.Im,d[0],0),Ok(d[0])):M(d[0]);A.forEach(this.data,function(b,c){b+""===d.data("url-token")+""&&this.data.splice(c,1)},this);Rs(this);this.dispatchEvent("remove")},this));if(this.Im)$(this.Im).on("click",".add",$.proxy(function(b){b=
$(b.target).parents(".item");kc(this.Mf,b[0],0);Ok(b[0]);Rs(this);this.dispatchEvent("add")},this));this.data=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();this.em()};t.tn=function(){this.Rc||(this.Rc=L("div","zm-tag-editor-editor",[this.Ye=L("div","zg-section zm-tag-editor-command-buttons-wrap",[this.fb=J("profile-expert-edit-input")])]),this.Ae&&(this.Ix=new dn(this.Ae),this.Ix.o(this.fb),this.fb.title=this.Ae),jc(this.Rc,this.gg),this.Ig(this.Ye))};
t.Ig=function(b){this.T=new nn("/topic/autocomplete",this.fb,k,k,b,j);this.T.gh(j);this.T.Ml=this.Xd;this.T.bp(this.gm());this.T.Uv=[this.Ae];this.m().e(this.T,"select",this.wo);this.m().e(this.T,rl.th.Di,this.Au);this.m().e(this.T,rl.th.Di,this.xu);this.m().e(this.T,rl.th.EI,function(){$(this.T.L.g).hide()})};t.xu=function(){if(0===this.T.Ya.length){var b=L("div",{className:"zu-autocomplete-empty"},"没有名字为 "+$(this.fb).val()+" 的话题");$(this.T.L.g).html(b).show()}};
t.wo=function(){var b=this.T.fj().slice(1);b&&3<b.length&&(this.pC=b,this.Qe(b))};t.Qe=function(b){this.data.push(b[1]);var c=$(this.Mf).find("[data-url-token='"+b[1]+"']")[0];c?Ok(c):(Es("TopicMediumV2",{member_url_token:S[1],topic_url_token:b[1]},this.Kq,this),$(this.Im).find("[data-url-token='"+b[1]+"']").remove(),this.dispatchEvent("add"))};t.Kq=function(b){b=$(b)[0];kc(this.Mf,b,0);Ok(b);Rs(this)};t.Je=ba();
t.em=function(){if(!bh.uc){var b=this;this.If&&this.If.G();var c=new xs;c.Yq="expert-item-moving";ys(c,this.Mf,4);c.B();this.If=c;this.m().e(this.If,"dragend",function(){this.dispatchEvent("sort")});$("a, input, .del, .add",this.Mf).each(function(){b.m().e(this,"mousedown",function(b){b.stopPropagation()})});this.m().e(this.If,"beforedragstart",function(){return K("editing",this.Mf)?m:j})}};
a.Rs=function(b){var c=$(b.Mf).children().length;6<c&&M($(b.Mf).children()[6]);Q(J("zh-profile-expert-empty"),0>=c);0<c&&Q(J("zh-profile-expert-warning"),m);Q(J("active-topics-wrap"),$(b.Im).children().length);b.em()};t.gm=function(){return v(function(b){return A.filter(b,function(b){return A.every(this.data,function(d){return d+""!==b[2]+""&&3<b.length})},this)},this)};a.Ss=function(b){pn.call(this,b,0);this.Wr="";this.DB="/topic/ignore"};z(Ss,ws);
Ss.prototype.Qe=function(b){this.Og||(this.Og=j,this.xhr=new V(j),ne(this.m(),this.xhr,"complete",this.Bu),this.xhr.ajax(this.DB,"tid="+b+"&method=add"))};Ss.prototype.Go=function(b){this.Og||(this.Og=j,this.xhr=new V(j),this.m().e(this.xhr,"complete",function(){rn(this);this.Je();this.Og=m}),this.xhr.ajax(this.DB,"tid="+b+"&method=del"))};a.Ts=function(){pn.call(this,k,k,"搜索话题");this.lC=k;this.Ae="";this.data=[gh[0]]};z(Ts,pn);t=Ts.prototype;
t.o=function(b){this.g=b;this.gg=K("zm-tag-editor-labels",this.g);this.Ee(j);this.ne();this.nb()};t.tn=function(){this.Rc||(this.Rc=L("div","zm-tag-editor-editor",[this.qn=L("div","zg-section zg-clear"),this.Ye=L("div","zg-section zm-tag-editor-command-buttons-wrap",[this.fb=J("zh-topic-merge-input"),L("a",{"class":"zg-mr15 zg-btn-blue",href:"#",name:"add",style:"display:none;"},"添加"),this.cD=J("zh-topic-merge-btn")])]),jc(this.Rc,this.gg),this.Ig(this.Ye))};
t.Ig=function(b){this.T=new nn("/topic/autocomplete",this.fb,k,k,b,j);this.T.gh(j);this.T.Ml=this.Xd;this.T.bp(this.gm());this.T.Uv=[this.Ae];this.m().e(this.T,"select",this.wo);this.m().e(this.T,rl.th.Di,this.Au)};t.gm=function(){return v(function(b){return A.filter(b,function(b){return A.every(this.data,function(d){return d[1]!==b[1]&&3<b.length})},this)},this)};t.wo=function(){var b=this.T.fj().slice(1);b&&3<b.length&&(this.pC=b,this.Qe(b[3],b[0]))};
t.Qe=function(b,c){var d=this;setTimeout(function(){d.fb.value=c});this.lC=b};t.Je=ba();a.Us=function(b,c,d){T.call(this,d);this.L=c||Sm.N();this.wb=b||this.L.rw()};z(Us,T);t=Us.prototype;t.Gx=k;t.lb=k;t.L=k;t.wb=k;t.jb=j;t.fc=j;t.hw=j;t.Eb=-1;t.jc=k;t.Wf=m;t.xJ=m;t.xQ=j;t.tg=k;t.hc=function(){return this.Gx||this.L.hc(this)};t.pr=function(){return this.lb||(this.lb=new fj(this.hc()))};t.v=function(){this.g=this.L.v(this)};t.V=function(){return this.L.V(this.h())};t.dc=function(b){return this.L.dc(b)};
t.$=function(b){this.g=this.L.o(this,b);"none"==b.style.display&&(this.jb=m)};t.z=function(){Us.n.z.call(this);Mh(this,function(b){b.za&&Vs(this,b)},this);var b=this.h();this.L.ze(this);this.D(this.jb,j);this.m().e(this,"enter",this.Mw).e(this,"highlight",this.Qw).e(this,"unhighlight",this.Yw).e(this,"open",this.WM).e(this,"close",this.jM).e(b,"mousedown",this.we).e(Qb(b),"mouseup",this.pM).e(b,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.hM);this.Xh()&&Ws(this,j)};
a.Ws=function(b,c){var d=b.m(),e=b.hc();c?d.e(e,"focus",b.ve).e(e,"blur",b.Tc).e(b.pr(),"key",b.Vb):d.Fa(e,"focus",b.ve).Fa(e,"blur",b.Tc).Fa(b.pr(),"key",b.Vb)};t.hb=function(){this.Nb(-1);this.jc&&this.jc.sb(m);this.Wf=m;Us.n.hb.call(this)};t.w=function(){Us.n.w.call(this);this.lb&&(this.lb.G(),this.lb=k);this.L=this.jc=this.tg=this.Gx=k};t.Mw=s(j);
t.Qw=function(b){var c=$r(this,b.target);if(-1<c&&c!=this.Eb){var d=Xs(this);d&&d.pd(m);this.Eb=c;d=Xs(this);this.Wf&&d.setActive(j);this.xQ&&(this.jc&&d!=this.jc)&&(d.Ob&64?d.sb(j):this.jc.sb(m))}Mc(this.h(),Tc.Em,b.target.h().id)};t.Yw=function(b){b.target==Xs(this)&&(this.Eb=-1);Mc(this.h(),Tc.Em,"")};t.WM=function(b){if((b=b.target)&&b!=this.jc&&b.getParent()==this)this.jc&&this.jc.sb(m),this.jc=b};t.jM=function(b){b.target==this.jc&&(this.jc=k)};
t.we=function(b){this.fc&&(this.Wf=j);var c=this.hc();c&&Bc(c)?c.focus():b.preventDefault()};t.pM=function(){this.Wf=m};t.hM=function(b){var c;a:{c=b.target;if(this.tg)for(var d=this.h();c&&c!==d;){var e=c.id;if(e in this.tg){c=this.tg[e];break a}c=c.parentNode}c=k}if(c)switch(b.type){case "mousedown":c.we(b);break;case "mouseup":c.Rf(b);break;case "mouseover":c.kd(b);break;case "mouseout":c.Uh(b);break;case "contextmenu":c.Gn(b)}};t.ve=ba();t.Tc=function(){this.Nb(-1);this.Wf=m;this.jc&&this.jc.sb(m)};
t.Vb=function(b){return this.isEnabled()&&this.Q()&&(0!=Nh(this)||this.Gx)&&this.ff(b)?(b.preventDefault(),b.stopPropagation(),j):m};
t.ff=function(b){var c=Xs(this);if(c&&"function"==typeof c.Vb&&c.Vb(b)||this.jc&&this.jc!=c&&"function"==typeof this.jc.Vb&&this.jc.Vb(b))return j;if(b.shiftKey||b.ctrlKey||b.metaKey||b.altKey)return m;switch(b.keyCode){case 27:if(this.Xh())this.hc().blur();else return m;break;case 36:Ys(this);break;case 35:Zs(this,function(b,c){b--;return 0>b?c-1:b},0);break;case 38:if(this.wb==Vm)$s(this);else return m;break;case 37:if(this.wb==Um)this.zd()?at(this):$s(this);else return m;break;case 40:if(this.wb==
Vm)at(this);else return m;break;case 39:if(this.wb==Um)this.zd()?$s(this):at(this);else return m;break;default:return m}return j};a.Vs=function(b,c){var d=c.h(),d=d.id||(d.id=c.Sd());b.tg||(b.tg={});b.tg[d]=c};t.H=function(b,c){Us.n.H.call(this,b,c)};t.Fk=function(b,c,d){b.gk|=2;b.gk|=64;(this.Xh()||!this.xJ)&&rj(b,32,m);b.Zo(m);Us.n.Fk.call(this,b,c,d);b.za&&this.za&&Vs(this,b);c<=this.Eb&&this.Eb++};
t.removeChild=function(b,c){if(b=na(b)?Kh(this,b):b){var d=$r(this,b);-1!=d&&(d==this.Eb?b.pd(m):d<this.Eb&&this.Eb--);(d=b.h())&&(d.id&&this.tg)&&H.remove(this.tg,d.id)}b=Us.n.removeChild.call(this,b,c);b.Zo(j);return b};t.$o=function(b){this.h()&&f(Error("Component already rendered"));this.wb=b};t.Q=p("jb");
t.D=function(b,c){if(c||this.jb!=b&&this.dispatchEvent(b?"show":"hide")){this.jb=b;var d=this.h();if(d){Q(d,b);if(this.Xh()&&(d=this.hc()))d.tabIndex=this.fc&&this.jb?0:-1;c||this.dispatchEvent(this.jb?"aftershow":"afterhide")}return j}return m};t.isEnabled=p("fc");
t.Za=function(b){if(this.fc!=b&&this.dispatchEvent(b?"enable":"disable"))if(b?(this.fc=j,Mh(this,function(b){b.iI?delete b.iI:b.Za(j)})):(Mh(this,function(b){b.isEnabled()?b.Za(m):b.iI=j}),this.Wf=this.fc=m),this.Xh()){var c=this.hc();c&&(c.tabIndex=b&&this.jb?0:-1)}};t.Xh=p("hw");t.Le=function(b){b!=this.hw&&this.za&&Ws(this,b);this.hw=b;if(this.fc&&this.jb){var c=this.hc();c&&(c.tabIndex=b?0:-1)}};t.Nb=function(b){(b=Oh(this,b))?b.pd(j):-1<this.Eb&&Xs(this).pd(m)};
t.pd=function(b){this.Nb($r(this,b))};a.Xs=function(b){return Oh(b,b.Eb)},a.Ys=function(b){Zs(b,function(b,d){return(b+1)%d},Nh(b)-1)},a.at=function(b){Zs(b,function(b,d){return(b+1)%d},b.Eb)},a.$s=function(b){Zs(b,function(b,d){b--;return 0>b?d-1:b},b.Eb)},a.Zs=function(b,c,d){for(var d=0>d?$r(b,b.jc):d,e=Nh(b),d=c.call(b,d,e),g=0;g<=e;){var h=Oh(b,d);if(h&&b.JB(h)){b.rz(d);break}g++;d=c.call(b,d,e)}};t.JB=function(b){return b.Q()&&b.isEnabled()&&!!(b.Ob&2)};t.rz=function(b){this.Nb(b)};
a.bt=function(b){if(b){var c=b.getBoundingClientRect(),d=c.bottom,c=c.top;d<Xb().height&&0>c&&setTimeout(function(){var c=b.getBoundingClientRect().bottom,g=ts(document);window.scrollTo(g.x,g.y+c-d)})}},a.ct=function(b){function c(b){return $.isNumeric(b)?b+" ":b}var d;d=d||+new Date;if(0>=d-b)return"刚刚";b=Math.floor((d-b)/1E3);d=Math.floor(b/31536E3);if(1<=d)return c(d)+"年前";d=Math.floor(b/2592E3);if(1<=d)return c(d)+"月前";d=Math.floor(b/604800);if(1<=d)return c(d)+"周前";d=Math.floor(b/86400);if(1<=
d)return c(d)+"天前";d=Math.floor(b/3600);if(1<=d)return c(d)+"小时前";d=Math.floor(b/60);if(1<=d)return c(d)+"分钟前";d=Math.floor(b);return c(d)+"秒前"},a.dt=function(){var b=S;return 1===b||0===b?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'" title="'+b[0]+'" class="','zm-item-link-avatar">','<img class="zm-item-img-avatar" src="'+b[2]+'" />',"</a>"].join("")},a.et=function(b,c){return!la(b)?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'"',c?' class="'+c+'"':"",' title="',b[0],'">',
b[0],"</a>"].join("")},a.ft=function(b){if(0===b||1===b)return"匿名用户";var c=L("a",{href:"/people/"+b[1],title:b[0]},b[0]);c.setAttribute("data-tip","p$t$"+b[1]);return c},a.gt=function(b){if(0===b||1===b)return L("span");if(la(b)){var c=L("a",{href:"/people/"+b[1],title:b[0],"class":"zm-item-link-avatar"},L("img",{src:b[2],"class":"zm-list-avatar"}));c.setAttribute("data-tip","p$t$"+b[1]);return c}},a.ht=function(b){return 1===b?j:la(b)?b[3]===S[3]:m},a.it=function(b,c){return $.post("/question/askpeople",
{qid:b,uid:c,op:"remove"})},a.jt=function(b,c,d){return $.post("/question/askpeople",{qid:b,uid:c,_source_type:d,op:"add"})},a.kt=function(b,c){return $.post("/node/AnswerVoteBarV2",{method:c,params:{answer_id:b}},function(b){b&&b.r&&Ci("提示信息","<p>"+b.msg+'</p><p><a href="/question/24752645" target="_blank">为什么回答会被建议修改？</a></p>')})},a.lt=function(b,c){return $.get(c?"/node/AnswerFullVoteInfoV2":"/node/AnswerVoteInfoV2",{params:{answer_id:b}})},a.mt=function(b,c,d,e,g){Uj.call(this,b,[c],[d],e,g)};
z(mt,Uj);mt.prototype.qh=function(){this.element.style.height=Math.round(this.coords[0])+"px"};a.nt=function(b,c,d,e,g){Uj.call(this,b,[c],[d],e,g)};z(nt,Uj);nt.prototype.qh=function(){this.element.style.width=Math.round(this.coords[0])+"px"};a.ot=function(b,c,d,e,g){(2!=c.length||2!=d.length)&&f(Error("Start and end points must be 2D"));Uj.apply(this,arguments)};z(ot,Uj);
ot.prototype.qh=function(){var b=this.vi&&this.zd()?"right":"left";this.element.style[b]=Math.round(this.coords[0])+"px";this.element.style.top=Math.round(this.coords[1])+"px"};
a.pt=function(b){var c={},b=String(b),d="#"==b.charAt(0)?b:"#"+b;if(hs.test(d))return c.Jr=Gs(d),c.type="hex",c;d=Fs(b);if(d.length){var e=d[0],b=d[1],d=d[2],e=Number(e),b=Number(b),d=Number(d);(isNaN(e)||0>e||255<e||isNaN(b)||0>b||255<b||isNaN(d)||0>d||255<d)&&f(Error('"('+e+","+b+","+d+'") is not a valid RGB color'));e=gs(e.toString(16));b=gs(b.toString(16));d=gs(d.toString(16));c.Jr="#"+e+b+d;c.type="rgb";return c}if(Hs&&(d=Hs[b.toLowerCase()]))return c.Jr=d,c.type="named",c;f(Error(b+" is not a valid color string"))},
a.qt=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||112<=b.keyCode&&123>=b.keyCode)return m;switch(b.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 224:case 92:return m;case 0:return!C;default:return 166>b.keyCode||183<b.keyCode}},a.rt=function(b){var c=Qb(b),d=B&&b.currentStyle;if(d&&Jc(Rb(c))&&"auto"!=d.width&&"auto"!=d.height&&!d.boxSizing)return c=
ug(b,d.width,"width","pixelWidth"),b=ug(b,d.height,"height","pixelHeight"),new Nb(c,b);d=tg(b);c=wg(b);b=gg(b);return new Nb(d.width-b.left-c.left-c.right-b.right,d.height-b.top-c.top-c.bottom-b.bottom)},a.st=function(b,c){var d=Rb(c),e=k;if(B)d=e=d.Ca().createStyleSheet(),B?d.cssText=b:d.innerHTML=b;else{var g=Sb(d.Ha,"head",i,i)[0];g||(e=Sb(d.Ha,"body",i,i)[0],g=d.v("head"),e.parentNode.insertBefore(g,e));var h=e=d.v("style");B?h.cssText=b:h.innerHTML=b;d.appendChild(g,e)}},a.tt=function(b,c){var d=
b.style[db(c)];return"undefined"!==typeof d?d:b.style[Uf(b,c)]||""},a.ut=function(b){var c=arguments,d=c.length;return function(){for(var b,g=0;g<d;g++)b=c[g].apply(this,arguments);return b}},a.vt=function(b,c,d){return Math.min(Math.max(b,c),d)},a.wt=function(){f(Error("unimplemented abstract method"))},a.xt=function(b){N.call(this);this.view=this.name=k;H.extend(this.options={},this.defaults,b||{})};z(xt,Fd);
a.yt={},a.zt=function(b,c){function d(c){xt.call(this,c);this.name=b}z(d,xt);ya(d.prototype,c);yt[b]=d};xt.prototype.defaults={};xt.prototype.m=function(){return this.Fg||(this.Fg=new le(this))};xt.prototype.B=ba();xt.prototype.w=function(){xt.n.w.call(this);this.view&&(H.remove(this.view.nd,this.name),this.view=k);this.Fg&&(this.Fg.G(),this.Fg=k)};a.At=function(b){T.call(this);H.extend(this.F={},this.defaults,b||{});this.source=this.F.source;this.promise=$.Deferred().resolve();this.nd={}};z(At,T);t=At.prototype;t.defaults={source:k,ma:["autoload","shortcut"],hh:j,Vm:"zg-btn-white zu-button-more"};t.ma=function(b,c){var d,e=yt[b];e||f(Error("Cannot find constructor"));d=new e(c);d.view=this;this.za?d.B(this):this.m().e(this,"initialized",function(){d.B(this)});this.nd[b]=d;return this};
t.Ni=function(){!this.Jd&&this.F.hh&&(this.Jd=this.uq(),jc(this.Jd,this.g),this.m().e(this.Jd,"click",this.Tx))};t.z=function(){At.n.z.call(this);this.Ni();A.forEach(this.Cb(),this.Kq,this);A.forEach(this.F.ma,this.ma,this);this.dispatchEvent("initialized")};t.w=function(){H.forEach(this.nd,function(b){b.G()});this.nd=k;At.n.w.call(this)};a.Bt=function(b,c,d){b.za&&A.forEach(b.Cb(),c,d);b.m().e(b,"itemcreated",function(b){c.call(d,b.item)})};t.Cb=function(){return nc(this.g)};
t.Kq=function(b,c){this.Nj(b,c);this.dispatchEvent({type:"itemcreated",item:b,index:c})};t.Nj=ha;a.Ct=function(b){b.Jd&&(M(b.Jd),b.Jd=k);b.dispatchEvent("complete")};t.PP=function(b){if(b){var c=b.results,d=!c||!c.length;d||this.X(c);this.dispatchEvent("next");(d||b.next===m)&&Ct(this)}};t.X=function(b,c){var b=$.isArray(b)?b.join(""):b,d=ec(b+" ");A.forEach($.makeArray(nc(d)),this.Kq,this);kc(this.g,d,c)};
t.Tx=function(){this.dispatchEvent("beforeloadnext")!==m&&"pending"!==this.promise.state()&&(this.Ez(j),this.promise=this.source().done(v(this.PP,this)).always(v(xa(this.Ez,m),this)))};t.gd=p("Jd");t.uq=function(){return L("a",{"aria-role":"button","class":this.F.Vm},"更多")};t.Ez=function(b){this.Jd&&(this.Jd.innerHTML=b?'<i class="spinner-gray"></i> 加载中':"更多",F.enable(this.Jd,"loading",b))};a.Et=function(b,c){var d=Array.prototype.slice.call(arguments),e=d.shift();"undefined"==typeof e&&f(Error("[goog.string.format] Template required"));return e.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(b,c,e,n,q,r,w,x){if("%"==r)return"%";var G=d.shift();"undefined"==typeof G&&f(Error("[goog.string.format] Not enough arguments"));arguments[0]=G;return Dt[r].apply(k,arguments)})},a.Dt={s:function(b,c,d){return isNaN(d)||""==d||b.length>=d?b:b=-1<c.indexOf("-",0)?b+Array(d-b.length+
1).join(" "):Array(d-b.length+1).join(" ")+b},f:function(b,c,d,e,g){e=b.toString();isNaN(g)||""==g||(e=b.toFixed(g));var h;h=0>b?"-":0<=c.indexOf("+")?"+":0<=c.indexOf(" ")?" ":"";0<=b&&(e=h+e);if(isNaN(d)||e.length>=d)return e;e=isNaN(g)?Math.abs(b).toString():Math.abs(b).toFixed(g);b=d-e.length-h.length;0<=c.indexOf("-",0)?e=h+e+Array(b+1).join(" "):(c=0<=c.indexOf("0",0)?"0":" ",e=h+Array(b+1).join(c)+e);return e},d:function(b,c,d,e,g,h,l,n){return Dt.f(parseInt(b,10),c,d,e,0,h,l,n)}};Dt.i=Dt.d;
Dt.u=Dt.d;zt("activeSource",{defaults:{dK:"%d 条新动态",Vm:"zu-main-feed-fresh-button",aY:ha},B:function(b){this.data=[];this.button=this.uq();ic(this.button,b.h());this.m().e(this.button,"click",function(){b.X(this.data,0);this.setData([])});var c=this,d=this.options.source(function(b){b&&b.length&&c.setData(b.concat(c.data))},function(){return c.data});(!d||!pa(d.G))&&f(Error("Source must return a disposable object."));this.iL=d},setData:function(b){this.data=b;this.yP()},yP:function(){var b=this.data.length;
wc(this.button,Et(this.options.dK,b));Q(this.button,!!b)},uq:function(){return L("a",{href:"javascript:;",style:"display:none","class":this.options.Vm})},G:function(){xt.prototype.G.call(this);Sc(this.iL);this.options=k;this.button&&(M(this.button),this.button=k)}});a.Ft=function(){N.call(this);this.size=k;this.hW=wg(document.body).top;this.da=new le(this);this.qp=k;this.cL=250;this.gf()};z(Ft,Fd);ia(Ft);Ft.prototype.gf=function(){this.size=Xb();var b=this.qp=new Ym(this.update,this.cL,this);this.da.e(window,"scroll",b.fire,m,b).e(window,"resize",b.fire,m,b)};Ft.prototype.m=p("da");Ft.prototype.w=function(){Ft.n.w.call(this);this.da.G();this.da=k;this.qp.G();this.qp=k};Ft.prototype.update=function(){this.size=Xb();this.dispatchEvent("update")};
a.Ht=function(b,c,d){var e=Gt;e.da.e(e,"update",function h(){b.getBoundingClientRect().bottom<this.size.height&&(c.call(d),this.da.Fa(this,"update",h))})},a.Gt=Ft.N();$(function(){Gt.update()});zt("autoload",{defaults:{KR:function(b){return 0!==b%3}},B:function(b){if(b.gd()&&S.na()){var c=this,d=Gt;c.m().e(d,"update",function(d){var e;e=ua(c);var l=rd[e];if(l){var n=ka("abouttosee"),q=ka(i);n&&q?(l=qd.abouttosee,e=!!l&&!!l[i]&&e in l[i]):e=!n&&!q?j:A.some(l,function(b){return n&&"abouttosee"==b.type||q&&b.capture==i})}else e=m;e&&(qg(b.gd())&&400>=b.gd().getBoundingClientRect().top-d.target.size.height)&&c.dispatchEvent("abouttosee")});var e=0;this.m().e(b,"complete",this.G).e(b,"next",
function(){e+=1;this.options.KR(e)&&this.enable()});this.enable()}},enable:function(){ne(this.m(),this,"abouttosee",function(){this.view.Tx()})}});zt("childConstructor",{defaults:{Pi:k,factory:k},B:function(b){pa(this.options.Pi)&&Bt(b,this.IK,this);pa(this.options.factory)&&Bt(b,this.ZQ,this)},IK:function(b){var c=new this.options.Pi;this.view.H(c);c.o(b)},ZQ:function(b){var c=this.options.factory(b);this.view.H(c);c.o(b)}});zt("dataPagingSource",{defaults:{OB:j},B:function(b){var c=$(b.h()).data("paging").next;c||Ct(b);b.source=function(){return $.get(c).then(function(b){c=b.paging.next;return{results:b.htmls,next:!!c}})}}});a.It=function(b){H.extend(this.F={},this.defaults,b||{});this.content="";this.xc=this.Oe=this.Pe=k;this.vd=m;this.valid=j};z(It,T);t=It.prototype;t.defaults={AH:"textarea.content",HB:".toggle-expand",FS:".summary",nv:"zm-editable-content",lr:m};
t.z=function(){It.n.z.call(this);var b=this.g,c=this.F;c.lr?(this.Pe=$("."+c.nv,b),this.content=this.Pe.val(),this.xc=$(c.HB,b)):(this.Op=$(c.AH,b),this.content=this.Op.is(":input")?this.Op.val():this.Op.html(),this.Pe=$(c.FS,b),this.xc=$(c.HB,this.Pe));if(this.Pe.length){if(this.xc.length)this.xc.click(m).on("click",$.proxy(this.expand,this));this.Pe.on("click",$.proxy(this.eN,this))}else this.valid=m,this.expand=this.collapse=ha,this.dispatchEvent("invalid")};t.gd=function(){return this.xc.get(0)};
t.bb=p("content");t.Ka=function(b,c){b?this.expand(c):this.collapse(c)};t.eN=function(b){var c=ro();if(!c||!c.Ec())c=$(b.target).closest("a").get(0),c&&"javascript:"!==c.protocol||(b.preventDefault(),this.expand())};
t.expand=function(b){!this.vd&&this.dispatchEvent("beforeexpand")!==m&&(this.vd=j,this.F.lr?(this.Pe.removeClass("fixed-summary"),this.xc.remove()):(this.Oe?this.Oe.show():this.Pe.length&&(this.Oe=$("<div>",{html:this.content,"class":this.F.nv}).insertBefore(this.Op)),this.Pe.hide()),b!==j&&this.dispatchEvent("expand"))};t.collapse=function(b){this.vd&&(this.vd=m,this.Oe&&this.Oe.hide(),this.F.lr?this.Pe.addClass("fixed-summary"):this.Pe.show(),b!==j&&this.dispatchEvent("collapse"))};zt("expandLimit",{defaults:{TS:3},B:function(b){var c=Yi.create("ExpandLimit");c.get("expandCount")||c.Ed("expandCount","0");S.na()||(this.m().e(b,"beforeexpand",function(b){var e=parseInt(c.get("expandCount"),10)||0;if(b.target instanceof It&&(b=e+1,c.Ed("expandCount",b),b>=this.options.TS))return Gm("expand"),m}),this.m().e(b,"beforeloadnext",function(){Gm("expand");return m}))}});zt("locationSource",{defaults:{qs:20,param:k,Rs:m,offset:function(b){return b.length}},B:function(b){function c(b){return{start:d.Rs?A.Yd(b).id.split("-")[1]:0,offset:d.offset(b)}}var d=this.options,e=d.url||location.href,g=b.Cb().length;(!g||g<d.qs)&&Ct(b);b.source=function(){return $.post(e,(d.param||c)(b.Cb())).then(function(c){if(!c.r){var c=c.msg,e=c[0];oa(e)&&e<d.qs&&Ct(b);return{results:c[1]}}})}}});zt("nodeSource",{defaults:{OB:j},B:function(b){var c=$(b.h()).data("init"),d="/node/"+c.nodename,e=c.params,g=e.offset||0,c=e.limit,h=e.pagesize;this.options.OB&&(c&&b.Cb().length<c)&&Ct(b);b.source=function(){return $.post(d,{method:"next",params:$.extend(e,{offset:g+b.Cb().length})}).then(function(b){var c=j;h&&(!b.r&&b.msg.length<h)&&(c=m);return!b.r&&{results:b.msg,next:c}})}}});zt("shortcut",{defaults:{items:">div"},B:function(b){b.Cb().length&&(this.uo=new gq(this.options),this.uo.o(b.h()),this.m().e(this.uo,"action",function(c){c.data.index>=c.data.size&&b.gd()&&qg(b.gd())&&b.gd().click()}))},G:function(){xt.prototype.G.call(this);this.uo&&(this.uo.G(),this.uo=k)}});a.Jt=function(b){At.call(this,b)};z(Jt,At);a.Kt=function(){};z(Kt,$i);ia(Kt);Kt.prototype.M=s("goog-menuheader");a.Lt=function(b,c,d){oj.call(this,b,d||Kt.N(),c);rj(this,1,m);rj(this,2,m);rj(this,4,m);rj(this,32,m);this.W=1};z(Lt,oj);mj("goog-menuheader",function(){return new Lt(k)});a.Mt=function(){this.dv=[]};z(Mt,$i);ia(Mt);a.Nt=function(b,c){var d=b.dv[c];if(!d){switch(c){case 0:d=b.M()+"-highlight";break;case 1:d=b.M()+"-checkbox";break;case 2:d=b.M()+"-content"}b.dv[c]=d}return d};t=Mt.prototype;t.qc=function(){return Uc.II};t.v=function(b){var c=b.K().v("div",this.cf(b).join(" "),Ot(this,b.bb(),b.K()));Pt(this,b,c,!!(b.Ob&8)||!!(b.Ob&16));bj(this,b,c);return c};t.V=function(b){return b&&b.firstChild};
t.o=function(b,c){var d=pc(c),e=Nt(this,2);d&&F.has(d,e)||c.appendChild(Ot(this,c.childNodes,b.K()));F.has(c,"goog-option")&&(b.Wo(j),this.Wo(b,c,j));return Mt.n.o.call(this,b,c)};t.Ea=function(b,c){var d=this.V(b),e=Qt(this,b)?d.firstChild:k;Mt.n.Ea.call(this,b,c);e&&!Qt(this,b)&&d.insertBefore(e,d.firstChild||k)};a.Ot=function(b,c,d){b=Nt(b,2);return d.v("div",b,c)};t.oi=function(b,c,d){c&&(Lc(c,d?Uc.KI:this.qc()),Pt(this,b,c,d))};t.Wo=function(b,c,d){c&&(Lc(c,d?Uc.JI:this.qc()),Pt(this,b,c,d))};
a.Qt=function(b,c){var d=b.V(c);if(d){var d=d.firstChild,e=Nt(b,1);return!!d&&F.has(d,e)}return m},a.Pt=function(b,c,d,e){e!=Qt(b,d)&&(F.enable(d,"goog-option",e),d=b.V(d),e?(b=Nt(b,1),d.insertBefore(c.K().v("div",b),d.firstChild||k)):d.removeChild(d.firstChild))};t.yn=function(b){switch(b){case 2:return Nt(this,0);case 16:case 8:return"goog-option-selected";default:return Mt.n.yn.call(this,b)}};
t.Bw=function(b){var c=Nt(this,0);switch(b){case "goog-option-selected":return 16;case c:return 2;default:return Mt.n.Bw.call(this,b)}};t.M=s("goog-menuitem");a.Rt=function(b,c,d,e){oj.call(this,b,e||Mt.N(),d);this.Aa(c)};z(Rt,oj);t=Rt.prototype;t.S=function(){var b=this.fy;return b!=k?b:this.Cg()};t.Aa=ca("fy");t.oi=function(b){rj(this,8,b);this.Be()&&!b&&this.Yc(m);var c=this.h();c&&this.L.oi(this,c,b)};t.Wo=function(b){rj(this,16,b);var c=this.h();c&&this.L.Wo(this,c,b)};
t.Cg=function(){var b=this.bb();return la(b)?(b=A.map(b,function(b){var d=F.get(b);return A.contains(d,"goog-menuitem-accel")||A.contains(d,"goog-menuitem-mnemonic-separator")?"":Fc(b)}).join(""),Ka(b)):Rt.n.Cg.call(this)};t.Rf=function(b){var c=this.getParent();if(c){var d=c.hG;c.hG=k;if(c=d&&oa(b.clientX))c=new Kb(b.clientX,b.clientY),c=d==c?j:!d||!c?m:d.x==c.x&&d.y==c.y;if(c)return}Rt.n.Rf.call(this,b)};t.ff=function(b){return b.keyCode==this.dy&&this.Zd(b)?j:Rt.n.ff.call(this,b)};t.VL=p("dy");
mj("goog-menuitem",function(){return new Rt(k)});a.St=function(){};z(St,Sm);ia(St);t=St.prototype;t.qc=function(){return Uc.HI};t.dc=function(b){return"UL"==b.tagName||St.n.dc.call(this,b)};t.An=function(b){return"HR"==b.tagName?new Rm:St.n.An.call(this,b)};t.Ef=function(b,c){return rc(b.h(),c)};t.M=s("goog-menu");t.ze=function(b){St.n.ze.call(this,b);Mc(b.h(),Tc.Ck,"true")};a.Tt=function(b){Rm.call(this,Qm.N(),b)};z(Tt,Rm);mj("goog-menuseparator",function(){return new Rm});a.Ut=function(b,c){Us.call(this,Vm,c||St.N(),b);this.Le(m)};z(Ut,Us);t=Ut.prototype;t.Jm=j;t.yJ=m;t.M=function(){return this.L.M()};t.Ef=function(b){if(this.L.Ef(this,b))return j;for(var c=0,d=Nh(this);c<d;c++){var e=Oh(this,c);if("function"==typeof e.Ef&&e.Ef(b))return j}return m};t.Ga=function(b){this.H(b,j)};t.Gi=function(b,c){this.Fk(b,c,j)};t.removeItem=function(b){(b=this.removeChild(b,j))&&b.G()};t.Rh=function(b){return Oh(this,b)};t.tl=function(){return Nh(this)};
t.Cb=function(){var b=[];Mh(this,function(c){b.push(c)});return b};t.Lc=function(b,c){var d=this.Q();d||Q(this.h(),j);ss(this.h(),b,c);d||Q(this.h(),m)};t.D=function(b,c,d){(c=Ut.n.D.call(this,b,c))&&(b&&this.za&&this.Jm)&&this.hc().focus();this.hG=b&&d&&oa(d.clientX)?new Kb(d.clientX,d.clientY):k;return c};t.Mw=function(b){this.Jm&&this.hc().focus();return Ut.n.Mw.call(this,b)};t.JB=function(b){return(this.yJ||b.isEnabled())&&b.Q()&&!!(b.Ob&2)};
t.$=function(b){var c=this.L,d;d=this.K();d=Sb(d.Ha,"div",c.M()+"-content",b);for(var e=d.length,g=0;g<e;g++)Tm(c,this,d[g]);Ut.n.$.call(this,b)};t.ff=function(b){var c=Ut.n.ff.call(this,b);c||Mh(this,function(d){!c&&(d.VL&&d.dy==b.keyCode)&&(this.isEnabled()&&this.pd(d),c=d.Vb(b))},this);return c};t.Nb=function(b){Ut.n.Nb.call(this,b);(b=Oh(this,b))&&hg(b.h(),this.h())};a.Vt=function(b,c,d,e){Ks.call(this,b,c,d||e);if(d||e)this.om(65|(e?32:132))};z(Vt,Ks);a.Wt=function(){};z(Wt,ej);ia(Wt);t=Wt.prototype;t.v=function(b){var c={"class":"goog-inline-block "+this.cf(b).join(" "),title:b.Qf()||""},c=b.K().v("div",c,this.Ni(b.bb(),b.K()));bj(this,b,c);return c};t.qc=function(){return Uc.Pp};t.V=function(b){return b&&b.firstChild.firstChild};t.Ni=function(b,c){return c.v("div","goog-inline-block "+(this.M()+"-outer-box"),c.v("div","goog-inline-block "+(this.M()+"-inner-box"),b))};t.dc=function(b){return"DIV"==b.tagName};
t.o=function(b,c){Xt(c,j);Xt(c,m);var d;a:{d=b.K().uD(c);var e=this.M()+"-outer-box";if(d&&F.has(d,e)&&(d=b.K().uD(d),e=this.M()+"-inner-box",d&&F.has(d,e))){d=j;break a}d=m}d||c.appendChild(this.Ni(c.childNodes,b.K()));F.add(c,"goog-inline-block",this.M());return Wt.n.o.call(this,b,c)};t.M=s("goog-custom-button");
a.Xt=function(b,c){if(b)for(var d=c?b.firstChild:b.lastChild,e;d&&d.parentNode==b;){e=c?d.nextSibling:d.previousSibling;if(3==d.nodeType){var g=d.nodeValue;if(""==Ma(g))b.removeChild(d);else{d.nodeValue=c?g.replace(/^[\s\xa0]+/,""):Na(g);break}}else break;d=e}};a.Yt=function(){};z(Yt,Wt);ia(Yt);C&&(Yt.prototype.Ea=function(b,c){var d=Yt.n.V.call(this,b&&b.firstChild);d&&lc(this.createCaption(c,Rb(b)),d)});t=Yt.prototype;t.V=function(b){b=Yt.n.V.call(this,b&&b.firstChild);C&&(b&&b.__goog_wrapper_div)&&(b=b.firstChild);return b};t.o=function(b,c){var d=Tb("*","goog-menu",c)[0];if(d){Q(d,m);Qb(d).body.appendChild(d);var e=new Ut;e.o(d);b.fh(e)}return Yt.n.o.call(this,b,c)};
t.Ni=function(b,c){return Yt.n.Ni.call(this,[this.createCaption(b,c),c.v("div","goog-inline-block "+(this.M()+"-dropdown")," ")],c)};t.createCaption=function(b,c){return Zt(b,this.M(),c)};a.Zt=function(b,c,d){return d.v("div","goog-inline-block "+(c+"-caption"),b)};t.M=s("goog-menu-button");a.$t=function(b,c,d,e){vj.call(this,b,d||Yt.N(),e);rj(this,64,j);this.Ol=new Vt(k,5);c&&this.fh(c);this.sF=k;this.pa=new Hd(500);if((Lg||Mg)&&!E("533.17.9"))this.gs=j};z($t,vj);t=$t.prototype;t.gs=m;t.$j=m;t.z=function(){$t.n.z.call(this);this.ra&&au(this,this.ra,j);Mc(this.h(),Tc.Ck,"true")};t.hb=function(){$t.n.hb.call(this);if(this.ra){this.sb(m);this.ra.hb();au(this,this.ra,m);var b=this.ra.h();b&&M(b)}};t.w=function(){$t.n.w.call(this);this.ra&&(this.ra.G(),delete this.ra);delete this.RQ;this.pa.G()};
t.we=function(b){$t.n.we.call(this,b);this.Xb()&&(this.sb(!this.qb(),b),this.ra&&(b=this.qb(),this.ra.Wf=b))};t.Rf=function(b){$t.n.Rf.call(this,b);this.ra&&!this.Xb()&&(this.ra.Wf=m)};t.Zd=function(){this.setActive(m);return j};t.oM=function(b){this.ra&&(this.ra.Q()&&!this.Ef(b.target))&&this.sb(m)};t.Ef=function(b){return b&&rc(this.h(),b)||this.ra&&this.ra.Ef(b)||m};
t.ff=function(b){if(32==b.keyCode){if(b.preventDefault(),"keyup"!=b.type)return j}else if("key"!=b.type)return m;if(this.ra&&this.ra.Q()){var c=this.ra.Vb(b);return 27==b.keyCode?(this.sb(m),j):c}return 40==b.keyCode||38==b.keyCode||32==b.keyCode||13==b.keyCode?(this.sb(j),j):m};t.Hn=function(){this.sb(m)};t.PM=function(){this.Xb()||this.sb(m)};t.Tc=function(b){this.gs||this.sb(m);$t.n.Tc.call(this,b)};t.Ta=function(){this.ra||this.fh(new Ut(this.K()));return this.ra||k};
t.fh=function(b){var c=this.ra;if(b!=c&&(c&&(this.sb(m),this.za&&au(this,c,m),delete this.ra),b)){this.ra=b;Lh(b,this);b.D(m);var d=this.gs;(b.Jm=d)&&b.Le(j);this.za&&au(this,b,j)}return c};a.bu=function(b){b.sF=new Of(7,0,7,0)};t.Ga=function(b){this.Ta().H(b,j)};t.Gi=function(b,c){this.Ta().Fk(b,c,j)};t.removeItem=function(b){(b=this.Ta().removeChild(b,j))&&b.G()};t.Rh=function(b){return this.ra?Oh(this.ra,b):k};t.tl=function(){return this.ra?Nh(this.ra):0};
t.D=function(b,c){var d=$t.n.D.call(this,b,c);d&&!this.Q()&&this.sb(m);return d};t.Za=function(b){$t.n.Za.call(this,b);this.isEnabled()||this.sb(m)};a.cu=function(b){b.Ol.om&&b.Ol.om(33)};t.oH=function(){this.sb(j)};
t.sb=function(b,c){$t.n.sb.call(this,b);if(this.ra&&!!(this.W&64)==b){if(b)this.ra.za||(this.$j?this.ra.X(this.h().parentNode):this.ra.X()),this.qk=fg(this.h()),this.Li=og(this.h()),du(this),this.ra.Nb(-1);else if(this.setActive(m),this.ra.Wf=m,this.h()&&Mc(this.h(),Tc.Em,""),this.Qs!=k){this.Qs=i;var d=this.ra.h();d&&lg(d,"","")}this.ra.D(b,m,c);if(!this.zg){var d=this.m(),e=b?d.e:d.Fa;e.call(d,this.K().Ca(),"mousedown",this.oM,j);this.gs&&e.call(d,this.ra,"blur",this.PM);e.call(d,this.pa,Id,this.Ul);
b?this.pa.start():this.pa.stop()}}};a.du=function(b){if(b.ra.za){var c=b.Ol;b.Ol.element=b.RQ||b.h();var d=b.ra.h();b.ra.Q()||(d.style.visibility="hidden",Q(d,j));!b.Qs&&(b.Ol.Bn&&b.Ol.Bn()&32)&&(b.Qs=ng(d));c.Y(d,c.Ff^1,b.sF,b.Qs);b.ra.Q()||(Q(d,m),d.style.visibility="visible")}};
t.Ul=function(){var b=og(this.h()),c=fg(this.h());if(!(this.Li==b||(!this.Li||!b?0:this.Li.left==b.left&&this.Li.width==b.width&&this.Li.top==b.top&&this.Li.height==b.height))||!(this.qk==c||(!this.qk||!c?0:this.qk.top==c.top&&this.qk.right==c.right&&this.qk.bottom==c.bottom&&this.qk.left==c.left)))this.Li=b,this.qk=c,du(this)};a.au=function(b,c,d){var e=b.m(),d=d?e.e:e.Fa;d.call(e,c,"action",b.Hn);d.call(e,c,"highlight",b.Qw);d.call(e,c,"unhighlight",b.Yw)};t.Qw=function(b){Mc(this.h(),Tc.Em,b.target.h().id)};
t.Yw=function(){Xs(this.ra)||Mc(this.h(),Tc.Em,"")};mj("goog-menu-button",function(){return new $t(k)});a.eu=function(){N.call(this)};z(eu,Fd);eu.prototype.YA={question:"问题",comment:"评论",answer:"回答",favlist:"收藏",member:"用户",message:"私信",image:"图片",video:"视频",post:"文章"};eu.prototype.tv="report-dialog";eu.prototype.iF="loading";eu.prototype.iD='<form><div class="header"><% if (headnote) { %><span class="headnote"><%=headnote%></span><% } %><span class="error-container"></span></div><ul class="options clearfix"><% each(options, function(option) { %><li><label><input value="<%=option.value%>" name="reason" type="radio"><%=option.label%></label><% if (option.description) { %><div class="description visible-if-checked"><%=option.description%></div><% } %><% if (option.options) { %><ul class="group-options clearfix visible-if-checked"><% each(option.options, function(opt) { %><li><label><input required data-description="<%=opt.description%>" value="<%=opt.value%>" name="reason-<%=option.value%>" type="radio"><%=opt.label%></label></li><% }) %></ul><div class="group-description visible-if-checked"></div><% } %><% if (option.value == 0) { %><p class="input-container visible-if-checked"><input placeholder="请填写原因" type="text" name="detail" class="reason-text zg-form-text-input"></p><p class="error-container visible-if-checked"></p><% } %></li><% }) %></ul><p class="footnote"></p></form>';
eu.prototype.submit=wt;t=eu.prototype;t.sw=p("pn");t.Ok=function(b,c){var d=new wi;$h(d,j);d.Ih=j;fi(d,hi);d.addEventListener(gi,this.nM,m,this);Qc(d,this);b&&d.Va(b);c&&d.Ea(c);d.D(j);d.Y();F.add(d.h(),this.tv);return this.pn=d};t.nM=function(b){if("ok"===b.key)return(b=$("form",this.pn.h()).valid())&&this.submit(),b};
t.open=function(b,c,d){var e=this.Ok(this.rD(b),this.Xu());F.add(e.h(),this.iF);this.yD(b).then(v(function(g){e.Ea($k(this.iD,{each:A.forEach,options:g,headnote:d}));F.remove(e.h(),this.iF);e.Y();yi(e,450);this.vL={type:b,id:c};this.nq(g)},this))};t.ND=ba();
t.nq=function(b){var c=this,d=$(this.pn.h()),e=$("form",d),g=$(".reason-text",d);d.on("change",":radio",function(h){h=$(h.target);d.find("li").removeClass("checked");h.parentsUntil(e,"li").addClass("checked");var l=this.value,n=A.find(b,function(b){return l===String(b.value)});c.ND(n);n="0"===l;g.toggle(n);n&&g.placeholder();h.closest("li").find("ul, :text").length||e.valid()});d.find("ul ul").on("change",":radio",function(b){$(b.delegateTarget).parent().find(".group-description").text($(this).data("description"))});
e.validate({rules:{reason:"required",detail:{rangelength:[2,100],required:function(){return!!$("input[name=reason]:checked",d).length}}},messages:{reason:"请选择理由",detail:"理由为 2-100 字"},errorLabelContainer:$(".error-container",e)})};t.Xu=s('<div class="loading">理由加载中<i class="spinner-gray"></i></div>');a.gu=function(b,c,d){T.call(this);this.type=b;this.id=c;this.Mu=d||fu[b]||"other_report"};z(gu,T);a.fu={question:"question_report",answer:"question_answer_report",post:"article_report",member:"member_report",comment:"comment_report",favlist:"favlist_report",message:"message_report"},a.hu=v(Jr(function(b){return $.getJSON(Ga("/report/%s/options",b))}),fa);
gu.submit=function(b,c,d){c=$.extend({type:b,id:c},d);W.ga({type:"ga_click_report",data:{type:b}});$.post("/report",c).done(function(b){if(b.r)"duplicate_report"===b.errtype?U(b.msg,3E3,"重复举报"):U(b.msg);else if(b.noti){var c=Bi({title:"举报成功！",Ql:j,content:'<p>您的举报正在等待人工审核，我们会在 24 小时内审核完成</p><p>处理完成后会「私信」通知您</p><p>您也可以进入 <a href="/community/report">社区服务中心</a> 查看实时处理进度</p><label class="modal-dialog-cancelNoti"><input type="checkbox" name="cancelNoti" />不再提醒</label>',className:"report-success-dialog",
Y:j,Df:["知道啦"]});c.m().e(c,di,function(){$(Xh(c)).find("input[name=cancelNoti]")[0].checked&&$.post("/community/report/noti",{cancel:j});return j})}else U("您的举报正在等待人工审核，我们会在 24 小时内审核完成",2E3,"举报成功！")})};gu.prototype.submit=Hm(function(b){gu.submit(this.type,this.id,b)},function(){return{na:this.Mu,cd:j}});gu.prototype.mH=Hm(function(){(new iu(this.type,this.id)).open(this.type,this.id);W.ga({type:"ga_click_report_box",data:{type:this.type}})},function(){return{na:this.Mu,cd:j}});
a.ju=function(b,c){if(b.type&&b.id&&!$(c).hasClass("goog-menu-button")){var d=new $t("report",new Ut);d.$j=j;d.dc=nf;d.o(c);Qc(d,b);b.rF=d;ne(b.m(),d.h(),["mouseover","focus"],Fk(b.MN))}};
gu.prototype.MN=function(){var b=this.rF,c=this.rF.Ta();hu(this.type).then(function(d){$.each(d,function(b,d){var h=new Rt(d.label,{value:d.value,options:d.options});c.Ga(h)});du(b);$(c.h()).addClass("report-menu")});this.m().e(c,"show",Hm(function(){W.ga({type:"ga_click_report_box",data:{type:this.type}})},{na:this.Mu,cd:j})).e(c,"action",this.Fw)};
gu.prototype.Fw=function(b){var c=b.target.S().value,d=b.target.S().options,b=this.type;0===c?(c=new iu(this.type,this.id),c.Ok("请填写你的举报理由",'<form><p class="input-container"><textarea class="textarea" name="detail"></textarea></p><p class="error-container"></p><input value="0" name="reason" type="hidden"></form>'),c=$(c.sw().h()),c=$("form",c),c.validate({rules:{detail:{rangelength:[2,100],required:j}},messages:{detail:"理由为 2-100 字"},errorLabelContainer:$(".error-container",c)})):"member"===b&&10018!==
c?(new iu(this.type,this.id)).Ok("请填写你的举报理由",'<form><p class="input-container"><input placeholder="填写违规内容链接会更快被管理员处理" type="text" name="link" class="reason-text zg-form-text-input"></p><p class="error-container"></p><input value="'+c+'" name="reason" type="hidden"></form>'):"question"===b&&d?$.get("/report/reported",{type:"question",id:this.id},$.proxy(function(b){if(b.r)U(b.msg);else if(b.reported)U(b.msg,3E3,"重复举报");else{var b=new iu(this.type,this.id),c=$k(b.iD,{each:A.forEach,options:d,headnote:'<a href="http://www.zhihu.com/question/19806261" class="zg-link-gray">知乎提问规范</a>'});
b.Ok("需要进一步修改",c);b.nq(d)}},this)):gu.submit(b,this.id,{reason:c})};a.iu=function(b,c){N.call(this);this.type=b;this.id=c};z(iu,eu);iu.prototype.yD=hu;iu.prototype.submit=function(){var b=$($("form",this.pn.h())[0]).serializeArray(),b=A.reduce(b,function(b,d){d.value&&(b[d.name]=d.value);return b},{});gu.submit(this.type,this.id,b)};iu.prototype.rD=function(b){return Ga("为什么举报这个%s？",this.YA[b]||"条目")};a.ku=function(){N.call(this);this.kf="zm-pm-item"};z(ku,Im);
ku.prototype.B=function(){var b=J("zh-create-pm");b&&this.m().e(b,"click",this.wP);var b=J("zh-pm-item-wrap"),c=new Jt;c.ma("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}});c.o(b);this.m().e(b,"click",this.ua);$(function(){$("#zh-change-pm-admin").change(function(){var b=$(this).find("option:selected").attr("data-token");location.href="self"===b?"/admin_feedback":"/admin_feedback/"+b})});$('a[name="report"]').each(function(b,c){var g=$(c).closest(".zm-pm-item").data("report-token");
ju(new gu("message",g),c)})};ku.prototype.wP=Hm(function(){var b;this.On();this.Mb.show();Uq(this.Mb,-1);(b=Wa(location.pathname,"admin_inbox")?"admin":$("#zh-change-pm-admin option:selected").attr("data-token"))&&this.Mb.wt(b)},j);ku.prototype.On=function(){this.Mb||(this.Mb=new Qq({et:j}))};
ku.prototype.ua=function(b){if(b=Uk(this.JX,b.target)){var c=b.name,d=Hc(b,k,this.kf);if(!d||!b.name)return j;var e=$(d).data(),g=e.member,h=e.name;switch(c){case "reply":Hm(v(function(){this.On();this.Mb.show();var b=this.Mb,c=e.type;b.pp=e.token;b.bA=c;Uq(this.Mb,g,h,m);this.Mb.Wb.focus()},this),j)();break;case "delete":var l=d.getAttribute("data-token");Bi("删除私信会话","你确定要删除与 "+h+"的所有会话吗？",function(b){if(b){var c=new V(j);c.on("success",function(){var b=Ie(c);b.r?U(b.msg):window.location.reload()});
c.ajax("/inbox/delete","type=thread&token="+l)}},this);break;case "edit":b=this.lg,Q(this.Kc,j),Q(b,m),this.qi=-1}}};a.lu=function(){N.call(this);this.kf="zm-pm-item"};z(lu,Im);
lu.prototype.B=function(){this.ts=J("zh-pm-detail-item-wrap");this.m().e(this.ts,"click",this.ua);var b=J("zh-pm-editor-form");if(b){this.Mb=new Qq({et:j});this.Mb.Cp=m;this.Mb.eh(b);this.Mb.show();if(b=this.Cb()[0]){var b=$(b).data(),c=this.Mb,d=b.type;c.pp=b.token;c.bA=d;Uq(this.Mb,b.member,b.name)}else b=hh,Uq(this.Mb,b.id,b.nw);this.Mb.focus()}else this.Mb=new Qq({et:j});this.Cb().length&&(b=new Jt,b.ma("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}}),
b.o(this.ts));this.vj()};lu.prototype.vj=function(){$('a[name="report"]').each(function(b,c){var d=$(c).closest(".zm-pm-item").data("token");ju(new gu("message",d),c)})};lu.prototype.Cb=function(){return nc(this.ts)};
lu.prototype.ua=function(b){var c=Uk(this.ts,b.target);if(c&&(b=c.name,c=Hc(c,k,this.kf))){var c=$(c).data(),d=c.token;switch(b){case "reply":this.Mb.show();var b=this.Mb,e=c.type;b.pp=d;b.bA=e;Uq(this.Mb,c.member,c.name,m);this.Mb.focus();break;case "delete":Bi("删除私信","你确定要删除这封私信吗？",function(b){if(b){var c=new V(j);ne(this.m(),c,"success",function(){var b=Ie(c);b.r?U(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=single&token="+d)}},this)}}};a.mu=function(b,c,d){T.call(this);this.offset=this.Me=0;this.fS=d;this.rL=b;this.url=c||window.location.href;this.Tf="zm-item";this.params={}};z(mu,T);t=mu.prototype;t.tA=!rb;t.sA=!rb;t.li=ca("Tf");t.B=function(){this.Yb=J("zh-load-more");this.o(this.rL)};
t.z=function(){mu.n.z.call(this);this.Nm=1;nu(this);this.Ak=$(this.Yb);this.Yb&&ou(this)&&(this.m().e(this.Yb,"click",function(){this.Yn=j;this.sh&&"pending"===this.sh.state()&&1===this.Nm?(this.sh.done(v(this.Sg,this)),this.Cz=j,pu(this,j)):this.yy()}),this.tA&&(this.cA=new Ym(this.vy,100,this),this.m().e(window,"scroll",function(){this.cA.fire()})));qu(this,this.Cb())};a.pu=function(b,c){c?b.Ak.html('<i class="spinner-gray"></i>正在加载').prop("disabled",j):b.Ak.html("更多").prop("disabled",m)};
t.vy=function(){var b=this.Yb;if(b&&qg(b)&&1E3>=b.getBoundingClientRect().top-Xb().height&&!(this.Ws||this.sh&&"pending"===this.sh.state()))this.sA&&(3===this.Nm?(this.Nm=1,this.Cz=m):(this.Yn=m,this.Nm++,this.Cz=j)),this.Gj()};t.yy=function(){this.tA&&this.Ws?(this.Sg(this.Ws),this.Ws=k):(pu(this,j),this.Gj())};a.ou=function(b){var c=b.Cb();b.offset=b.my?b.my(c):c.length;if(b.Gr)return c=b.Gr(),Q(b.Yb,c),c;if(b.Yb){if("-1"===b.Ak.attr("data-next")||!c||10>c.length)return b.Ak.hide(),m;b.Ak.removeClass("hidden").show()}return j};
t.Gj=function(b,c,d){c=c||ha;if(!(this.sh&&"pending"===this.sh.state())){var e=this.yG($.extend(this.params,{offset:this.offset,start:this.Me}));this.sh=$.post(this.url,e).done(c).done($.proxy(function(c){if(d)return d.call(this,c);this.tA&&!b?this.Cz?this.Sg(c):(this.Ws=c,pu(this,m)):this.Sg(c)},this));1!==this.Nm&&pu(this,j);return this.sh}};t.yG=aa();
t.Sg=function(b){if(b&&!b.r){var c=b.msg,d=c[0],e=c[1],g;2<c.length&&(g=c[2],this.Yb.setAttribute("data-next",g));0<d&&(this.Km(e),this.offset=this.my?this.my(this.Cb()):this.offset+d);c=j;c=this.Gr?this.Gr(b):!(-1===g||10>d);Q(this.Yb,c);pu(this,m);ru(this)}};a.ru=function(b){b.dispatchEvent({data:{Yn:b.Yn,sA:b.sA},type:"afterload"})};t.Cb=function(){return Ub(this.Tf,this.g)};t.qG=function(b){return b.id.split("-")[1]};
a.nu=function(b){var c=b.Cb(),d;if(b.fS)if(b.Yb&&(d=b.Yb.getAttribute("data-next")),d)b.Me=d;else if(c=A.Yd(c))b.Me=b.qG(c)};t.Km=function(b,c){var d=la(b)?b.join(""):b,d=ec(d+" "),e=Ub(this.Tf,d);qu(this,e);"prepend"===c?ic(d,this.g.firstChild):this.g.appendChild(d);nu(this)};a.qu=function(b,c){A.forEach(c,function(b){var c=this.Nj(b);this.dispatchEvent({data:{item:b,wO:c},type:"itemcreated"})},b)};t.Nj=ha;a.su=function(b){N.call(this);this.g=b;b=B||D&&!E("531")&&"TEXTAREA"==b.tagName;this.O=new le(this);this.O.e(this.g,b?["keydown","paste","cut","drop","input"]:"input",this)};z(su,Fd);su.prototype.pa=k;
su.prototype.handleEvent=function(b){if("input"==b.type)tu(this),(!qb||this.g==Qb(this.g).activeElement)&&this.dispatchEvent(uu(b));else if("keydown"!=b.type||qt(b)){var c="keydown"==b.type?this.g.value:k;B&&229==b.keyCode&&(c=k);var d=uu(b);tu(this);this.pa=Jd(function(){this.pa=k;this.g.value!=c&&this.dispatchEvent(d)},0,this)}};a.tu=function(b){b.pa!=k&&(Kd(b.pa),b.pa=k)},a.uu=function(b){b=new jd(b.Ub);b.type="input";return b};su.prototype.w=function(){su.n.w.call(this);this.O.G();tu(this);delete this.g};a.wu=function(b,c,d,e){N.call(this);this.Md=b;this.Jh=c;this.Qg=d;this.GC=e||vu;this.wj=new su(b);O(this.wj,"input",this.yo,m,this);this.Mi()};z(wu,Fd);a.vu=0;t=wu.prototype;t.yo=function(){this.Mi()};t.Mi=function(){var b=this.qr();this.Jh&&(0>this.Qg-b?(wc(this.Jh,"已超出 "+(b-this.Qg)+" 字"),F.add(this.Jh,"zg-text-error")):(wc(this.Jh,"还可以输入 "+(this.Qg-b)+" 字"),F.remove(this.Jh,"zg-text-error")))};t.w=function(){wu.n.w.call(this);delete this.Md;this.wj.G();this.wj=k};
t.isValid=function(){return 0<=this.Qg-this.Md.value.length};t.qr=function(){return this.Md.value.length};a.xu=function(b,c,d,e){wu.call(this,b,c,d,e)};z(xu,wu);xu.prototype.qr=function(){return Wk(this.Md.value)};a.yu=function(b,c){N.call(this);this.ca=k;this.aL=c;this.$R.apply(this,b);this.B()};z(yu,Im);yu.prototype.Ue={};a.zu=Jr(function(){return $.get("/node/WebShareDialogV2")});t=yu.prototype;t.B=function(){this.m().e(Ki,"question_title_change",function(){this.Ue[this.yf]=k});zu().then(v(function(b){b=ec(Ma(b));this.v(b);this.nb();this.show();Au(this,this.aL)},this))};t.show=function(){Bu(this);this.vc&&(this.vc.checked=m,this.Pj());Mm.N().refresh();this.ca.D(j)};t.hide=function(){this.ca.D(m)};
t.$R=function(b,c,d,e){this.qf={title:b,type:c,YS:d,params:e};this.yf=c+":"+d};
a.Bu=function(b){b.ca.Va(b.qf.title);b.Ue[b.yf]||(b.xhr=new V(j),ne(b.m(),b.xhr,"success",b.aS),b.xhr.ajax("/"+b.qf.type+"/"+b.qf.YS+"/sharetext","","GET"));J("zh-webshare-sina-pm").value=b.Ue[b.yf]&&b.Ue[b.yf].sina||"加载中...";b.qH.Mi();Nm(b.Kz);b.Kz.Wt();var c=b.uk;c.Wb.value=b.Ue[b.yf]&&b.Ue[b.yf].pm||"加载中...";c.hK&&c.hK.Mi();Nm(c.tG);c.tG.Wt();Q(c.Kc,j);Q(c.lg,m);if("answer"===b.qf.type||"post"===b.qf.type)$(b.g).find("#tb-webshare-daily").parent().removeClass("zg-hide"),b.Ue[b.yf]&&$(b.g).find(".tb-webshare-daily-title").html(b.Ue[b.yf].daily)};
t.aS=function(){var b=Ie(this.xhr);b&&b.r?U(b.msg):(this.Ue[this.yf]=b,Bu(this))};t.v=function(b){this.g=b;this.ca=new wi(k,m);fi(this.ca,k);this.ca.Ih=j;this.ca.V().appendChild(this.g);this.uk=new Qq({sG:"share"});this.uk.ob=this.ca;this.uk.eh(J("tb-webshare-letter-content"));this.uk.Rk=m;this.uk.B()};t.vz=function(){this.vc.checked=j;this.Pj()};
a.Au=function(b,c){var d=J(c+"-content"),e=J(c);A.forEach(b.IS,function(b){F.remove(b.parentNode,"active")});A.forEach(b.HS,function(b){Q(b,m)});F.add(e.parentNode,"active");Q(d,j);b.zR||(b.ca.Y(),b.zR=j)};
t.nb=function(){var b=K("tab-navs",this.g);this.m().e(b,"click",this.lQ);this.IS=$(".tab-nav > a",this.g);this.HS=Ub("zm-tab-content",this.g);$(".zm-command",this.g).on("click",$.proxy(this.ua,this));this.Oy=J("zh-webshare-sina-pm");this.Kz=new Pm(this.Oy);this.qH=new xu(this.Oy,J("zg-webshare-sina-counter"),140,vu);this.m().e(W,"sina_callback",function(b){this.vz(b.Ic.id,b.Ic.name)});this.Pu();b=K("zg-btn-blue",this.uk.h());S.Fi||F.xH(b,"zg-btn-blue","zg-btn-disabled");this.m().e(b,"click",this.ua)};
t.Pu=function(){this.vc=K("sina-checkbox",this.g);this.m().e(this.vc,"change",this.By)};t.Pj=function(){var b=K("weibo-share-button",this.g),c=this.vc.checked;F.enable(b,"zg-btn-blue",c);F.enable(b,"zg-btn-disabled",!c)};t.By=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.vc&&!ph.id?(window.open(c),b.checked=m,b=j):b=i;b||this.Pj()};t.lQ=function(b){(b=this.bf(b.target))&&Au(this,b.id)};
t.ua=function(b){var c=this.bf(b.target);if(c)switch(c.name){case "send_sina":if(!F.has(c,"zg-btn-disabled")){var d=this.Oy.value;d&&this.yf in this.Ue&&(c=new Vk(j),c.add("content",d),d=[],this.vc.checked&&d.push("sina"),c.add("via",d.join(",")),this.Uj(c),this.qf&&W.ga({type:"ga_click_share_"+this.qf.type+"_weibo",data:{eI:d}}))}break;case "send":if(!F.has(c,"zg-btn-disabled"))if(c=this.uk,"-1"===String(c.qi))Sq(c,"请填写收信人。");else if(d=c.Wb.value,this.yf in this.Ue)if(Ma(d)){var e=new Vk(j);e.add("talker_id",
c.qi);e.add("content",d);e.add("via","pm");this.Uj(e);this.qf&&W.ga("ga_click_share_"+this.qf.type+"_message")}else Sq(c,"请填写私信内容。");break;case "send_daily":c=new Vk(j);c.add("content",$(".tb-webshare-daily-form [name=recommend-reason]").val());c.add("via","daily");this.Uj(c);break;case "cancel":this.hide()}b.stopPropagation();b.preventDefault()};
t.Uj=function(b){H.forEach(this.qf.params,function(c,d){b.add(d,c)});this.xhr=new V(j);ne(this.m(),this.xhr,"complete",this.Du);this.xhr.ajax("/"+this.qf.type+"/share",b.hd())};t.Du=function(){var b=Ie(this.xhr);this.ca.D(m);b&&b.r?U(b.msg):U(b.msg||"分享发送完毕")};t.Q=function(){return this.ca.Q()};a.Cu=void 0,a.Du=[],a.Eu=[].slice,a.Fu=fl(550,function(){if(Du.length){var b=Du;S.na()&&(b={items:JSON.stringify(b)},$.post("/lastread/touch",b));Du=[]}});Cu=function(){Du.push(Eu.call(arguments));Fu()};a.Gu=function(b){var c=k;try{c=b.rules||b.cssRules}catch(d){15==d.code&&(d.styleSheet=b,f(d))}return c},a.Hu=function(b){var c=[],b=b||document.styleSheets,d=ka(i)?i:m;if(b.imports&&b.imports.length)for(var e=0,g=b.imports.length;e<g;e++)A.extend(c,Hu(b.imports[e]));else if(b.length){e=0;for(g=b.length;e<g;e++)A.extend(c,Hu(b[e]))}else{var h=Gu(b);if(h&&h.length)for(var e=0,g=h.length,l;e<g;e++)l=h[e],l.styleSheet&&A.extend(c,Hu(l.styleSheet))}(b.type||b.rules||b.cssRules)&&(!b.disabled||d)&&c.push(b);
return c};a.Iu=/a(:(link|visited|active|hover))?/,a.Ju=function(){this.mn="";this.dh=[]};Ju.prototype.clone=function(){var b=new Ju;b.dh=this.dh.concat();b.mn=this.mn;return b};
a.Ku=function(b,c,d){var e=[],g;for(g in c){var h=c[g];h&&e.push(g,":",h,d?" !important":"",";")}b.mn=e.join("")},a.Lu=/(^|;|{)\s*color:([^;]+);/g,a.Nu=function(b){this.My=[];this.Iu={};if(b){for(var c=[],b=b.split(/\s+/gm),d=0;d<b.length;d++)if(b[d]){var e=new Mu(b[d]);c.push(e)}this.ei=c}},a.Mu=function(b){var c=Ou[b];if(c)return c;for(var c=b.match(/[#\.]/)?b.split(/(?=[#\.])/):[b],d={},e=0;e<c.length;e++){var g=c[e];"."==g.charAt(0)?d.className=g.substring(1,g.length):"#"==g.charAt(0)?d.id=g.substring(1,
g.length):d.tagName=g.toUpperCase()}this.xE=b;this.QO=d;this.BH={};Ou[b]=this},a.Ou={},a.Pu=function(b,c){var d=c.uid,e=b.BH[d];if("undefined"!=typeof e)return e;var g=b.QO,e=g.tagName,h=g.className,g=g.id,l=j;e&&"*"!=e&&e!=c.nodeName?l=m:g&&g!=c.id?l=m:h&&!c.oK[h]&&(l=m);return b.BH[d]=l},a.Ru=function(b){var c=ua(b),d=Qu[c];if(d)return d;d=[];do{var e={id:b.id,nodeName:b.nodeName};e.uid=ua(e);var g={};if(b.className)for(var h=F.get(b),l=0;l<h.length;l++)g[h[l]]=1;e.oK=g;d.unshift(e)}while(b=b.parentNode);
this.IF=d;this.uid=ua(this);Qu[c]=this},a.Qu={},a.Su={},a.Tu="color visibility quotes list-style-type list-style-image list-style-position list-style page-break-inside orphans widows font-family font-style font-variant font-weight text-indent text-align text-transform white-space caption-side border-collapse border-spacing empty-cells cursor".split(" "),a.Uu="font-family font-size font-weight font-variant font-style color text-align text-decoration text-indent text-transform letter-spacing white-space word-spacing".split(" ");a.Vu=function(){N.call(this);this.fc=this.Xp()};z(Vu,Fd);t=Vu.prototype;t.C=k;t.OJ=j;t.Kb=ke("goog.editor.Plugin");t.UH=function(){this.C&&(this.disable(this.C),this.C=k)};t.enable=function(b){this.C==b?this.fc=j:this.Kb.log(be,"Trying to enable an unregistered field with this plugin.",i)};t.disable=function(b){this.C==b?this.fc=m:this.Kb.log(be,"Trying to disable an unregistered field with this plugin.",i)};t.isEnabled=function(b){return this.C==b?this.fc:m};t.Xp=mf;t.sO=mf;
t.w=function(){this.C&&this.UH(this.C);Vu.n.w.call(this)};a.Wu=H.Am({Sw:1,IM:2,Br:3,nj:4,Cr:5,execCommand:6,queryCommandValue:7,xG:8,qK:10,pK:11}),a.Xu=H.Fh(8,10,11);Vu.prototype.execCommand=function(b,c){var d=this.sO(b);d||(C&&Yu(this.C,j,j),this.C.Hh());try{var e=this.$e.apply(this,arguments)}finally{d||(this.C.Xe(),Zu(this.C))}return e};Vu.prototype.Ce=s(m);a.$u=function(b,c,d,e,g){this.ZC=b;this.Nz=c;this.rq=d;this.dD=e;this.Zv=g||{}},a.av=function(b,c){this.AT=b;this.hC=c},a.bv=function(b,c,d,e){var g=[];b.rq&&b.Nz&&g.push("<!DOCTYPE HTML>");g.push('<html style="background:none transparent;min-width:0;');b.rq&&g.push("height:",b.dD?"100%":"auto");g.push('">');g.push("<head><style>");d&&d.hC&&g.push(d.hC);C&&b.Nz&&g.push(" img {-moz-force-broken-image-icon: 1;}");g.push("</style></head>");g.push('<body g_editable="true" hidefocus="true" ');Os&&g.push("contentEditable ");
g.push('class="editable ');g.push('" id="',b.ZC,'" style="min-width:0;');C&&b.rq&&(g.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",b.Nz?"100%":"auto"),b.dD?g.push(";overflow:auto"):g.push(";overflow-y:hidden;overflow-x:auto"));qb&&g.push(";outline:hidden");for(var h in b.Zv)g.push(";"+h+":"+b.Zv[h]);g.push('">',c,"</body></html>");b=g.join("");e=e.contentDocument||e.contentWindow.document;e.open();e.write(b);e.close()};a.iv=function(b,c){N.call(this);this.Gg=this.id=b;this.gb=k;this.nd={};this.tj={};for(var d in Wu)this.tj[d]=[];this.Vk="";this.jk={};this.jk[cv]=1;this.jk[dv]=1;this.xx=this.hs=m;this.Sq=new Mj(this.EC,ev,this);this.Qq={};for(var e in fv)this.Qq[fv[e]]=0;C&&(this.me=new Mj(this.Fn,gv,this));this.gc=new le(this);this.BT=[];this.Hj=hv;this.Wl=Rb(c||document);this.Hc=this.Wl.h(this.id);this.Hk=this.Wl.Oa()};z(iv,Fd);iv.prototype.field=k;iv.prototype.Hc=k;iv.prototype.Kb=ke("goog.editor.Field");
a.cv="change",a.dv="delayedchange",a.fv={YT:"cvc",OU:"load",WV:"unload",PT:"beforechange",WT:cv,cU:dv,QT:"beforefocus",lU:"focus",ST:"blur",RT:"beforetab",BU:"ifrsz",AV:"selectionchange"},a.hv=0,a.jv=k;t=iv.prototype;t.Hg=m;t.aI=m;t.au=m;t.h=p("field");t.addListener=function(b,c,d,e){var g=this.h();Bo&&(g&&this.nc())&&(g=g.ownerDocument);this.gc.e(g,b,c,d,e)};t.Sh=function(b){return this.nd[b]};a.gv=15,a.ev=250;iv.prototype.nc=nf;iv.prototype.Zn=nf;iv.prototype.lH=mf;a.kv={46:j,8:j};B||(kv[9]=j);
a.lv={86:j,88:j};B&&(kv[229]=j);a.mv=function(b){var c=!(b.ctrlKey||b.metaKey)&&b.keyCode in kv;return(b.ctrlKey||b.metaKey)&&b.keyCode in lv||c},a.nv=function(b,c){b.Hj=2;b.field=c;b.gb=Rb(c);b.hs=m;b.xx=m;c.setAttribute("g_editable","true")};
iv.prototype.gv=function(){this.gc&&this.gc.removeAll();if((Lg||Mg)&&this.nc()&&this.lH()){try{var b=this.gb.Oa();b.removeEventListener("keydown",this.Sm,m);b.removeEventListener("touchend",this.Sm,m)}catch(c){}delete this.Sm}if(qb&&this.nc()){try{b=this.gb.Oa(),b.removeEventListener("focus",this.Tu,m),b.removeEventListener("blur",this.Su,m)}catch(d){}delete this.Tu;delete this.Su}this.me&&this.me.stop();this.Sq.stop()};
iv.prototype.w=function(){(1==this.Hj||this.Vd())&&this.Kb.sk("Disposing a field that is in use.");this.Hc&&this.execCommand("clearlorem");this.Hj=hv;for(var b in this.nd){var c=this.nd[b];c.Xp()||c.disable(this)}this.gb=this.field=k;this.gv();this.kl&&(yd(this.kl),this.kl=k);this.Wl=k;this.gc&&(this.gc.G(),this.gc=k);for(;b=this.BT.pop();)b.G();jv==this.id&&(jv=k);for(var d in this.nd)b=this.nd[d],b.OJ&&b.G();delete this.nd;iv.n.w.call(this)};
a.ov=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];iv.prototype.yz=function(){if(yo||!this.nc())this.gc.e(this.h(),"DOMSubtreeModified",this.Tw);else{var b=this.gb.Ca();this.gc.e(b,ov,this.Tw,j);this.gc.e(b,"DOMAttrModified",v(this.ED,this,this.Tw),j)}};
a.pv=function(b,c){if(9==c.keyCode&&!b.dispatchEvent({type:"beforetab",shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.ctrlKey})||C&&c.metaKey&&(37==c.keyCode||39==c.keyCode))return c.preventDefault(),m;var d;if(!(d=c.charCode))d=mv(c)?j:!(!C||c.ctrlKey||c.metaKey||C&&!c.charCode);b.Ew=d;b.Ew&&b.Hh();return j},a.qv={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},a.rv={65:j,86:j,88:j},a.sv={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};t=iv.prototype;
t.Xn=function(b,c){for(var d=this.tj[b],e=A.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];if((h.isEnabled(this)||Xu[b])&&h[Wu[b]].apply(h,e))return j}return m};t.fO=function(b,c){for(var d=this.tj[b],e=A.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];(h.isEnabled(this)||Xu[b])&&h[Wu[b]].apply(h,e)}};t.bt=function(b,c,d){for(var e=this.tj[b],g=A.slice(arguments,1),h=0;h<e.length;++h){var l=e[h];if(l.isEnabled(this)||Xu[b])g[0]=l[Wu[b]].apply(l,g)}return g[0]};
a.tv=function(b,c,d){var e={},b=b.bt(8,c||"",e);Tf(d,e);d.innerHTML=b};t.ef=function(b){(C||pv(this,b))&&!this.Xn(1,b)&&Io&&uv(this,b)};t.JM=function(b){if(C){if(!pv(this,b))return}else this.Ew=j,this.Hh();!this.Xn(2,b)&&!Io&&uv(this,b)};t.KM=function(b){!C&&(this.Ew||mv(b))&&this.Fn();this.Xn(3,b);vv(this,"selectionchange")||(qv[b.keyCode]||(b.ctrlKey||b.metaKey)&&rv[b.keyCode])&&this.cH.start()};
a.uv=function(b,c){if(!c.altKey){var d=jb?c.metaKey:c.ctrlKey;if(d||sv[c.keyCode]){var e=c.charCode||c.keyCode;17!=e&&b.Xn(5,c,String.fromCharCode(e).toLowerCase(),d)&&c.preventDefault()}}};t.execCommand=function(b,c){for(var d=arguments,e,g=this.tj[6],h=0;h<g.length;++h){var l=g[h];if(l.isEnabled(this)&&l.Ce(b)){e=l.execCommand.apply(l,d);break}}return e};
t.queryCommandValue=function(b){var c=this.Vd()&&this.jf;if(na(b))return this.$s(b,c);for(var d={},e=0;e<b.length;e++)d[b[e]]=this.$s(b[e],c);return d};t.$s=function(b,c){for(var d=this.tj[7],e=0;e<d.length;++e){var g=d[e];if(g.isEnabled(this)&&g.Ce(b)&&(c||g.Xp()))return g.queryCommandValue(b)}return c?k:m};t.ED=function(b,c){if(!vv(this,cv)){var d=c.Ub;try{if(d.originalTarget.prefix||"scrollbar"==d.originalTarget.nodeName)return}catch(e){return}d.prevValue!=d.newValue&&b.call(this,d)}};
t.Tw=function(b){vv(this,cv)||(b=b.oD?b.Ub:b,b.target.firebugIgnore||(this.xx=this.hs=j,this.me.start()))};t.yr=function(){B&&this.execCommand("clearlorem",j);C&&this.Hv();this.Xe()};a.wv=function(b){var c;return b.nc()&&(c=b.gb)?(b=c.Oa())&&b.frameElement:k},a.xv=function(b){return(b=b.gb&&b.gb.Oa())&&ro(b)},a.Zu=function(b,c,d){if(!vv(b,"selectionchange")){var e=xv(b),e=e&&e.Bb();b.jf=!!e&&rc(b.h(),e);b.dispatchEvent("cvc");b.dispatchEvent({type:"selectionchange",HX:c&&c.type});b.Xn(4,c,d)}};
t.cN=function(){var b=this.bH;this.bH=k;Zu(this,i,b)};t.Hh=function(){vv(this,"beforechange")||this.dispatchEvent("beforechange")};a.Yu=function(b,c,d){c&&(b.me&&Yr(b.me),b.jk[cv]=1);d&&(yv(b),b.jk[dv]=1)},a.zv=function(b,c,d){!c&&b.me&&Yr(b.me);b.jk[cv]=0;b.jk[dv]=0;c&&b.Fn();d&&b.EC()},a.vv=function(b,c){return!!b.jk[c]||b.Qq[c]&&500>=za()-b.Qq[c]};t.Xe=function(b){zv(this,j,b)};t.Fn=function(){vv(this,cv)||(this.me&&this.me.stop(),this.xx=this.hs=j,vv(this,dv)||this.Sq.start())};
t.EC=function(){vv(this,dv)||(this.Sq.stop(),this.hs=m,this.dispatchEvent(dv))};a.yv=function(b){b.me&&Yr(b.me);Yr(b.Sq)};t.Hv=function(){this.DC();this.FC()};t.DC=function(){vv(this,"beforefocus")||(this.execCommand("clearlorem",j),this.dispatchEvent("beforefocus"))};t.FC=function(){if(!vv(this,"focus")){jv=this.id;this.jf=j;this.dispatchEvent("focus");if(C){var b=this.h(),c=xv(this);if(c){var d=Cn(c);0==Dn(c)&&(!d||d==b||"BODY"==d.tagName)&&Ms(b)}}!zo&&this.nc()&&this.gb.Oa().parent.getSelection().removeAllRanges()}};
t.Vq=function(){vv(this,"blur")||(jv==this.id&&(jv=k),this.jf=m,this.dispatchEvent("blur"))};a.Av=function(b){Hc(b.target,"A")&&b.preventDefault()};t.kj=function(b){jv=this.id;if(B){var c=b.target;c&&("A"==c.tagName&&b.ctrlKey)&&this.Wl.Oa().open(c.href)}this.au=j};t.Lw=function(){this.au=m};t.KD=function(b){if(!this.aI||this.au)this.au=m,Zu(this,b),B&&(this.bH=b.target,this.cH.start())};t.QM=function(b){Zu(this,b)};
t.pl=function(){if(this.queryCommandValue("usinglorem"))return" ";if(!this.Vd()){var b=this.Hc;b||this.Kb.log(ae,"Couldn't get the field element to read the contents",i);return b.innerHTML}var c=this.h(),b=c.cloneNode(m),c=c.innerHTML;B&&c.match(/^\s*<script/i)&&(c=" "+c);b.innerHTML=c;this.fO(11,b);return this.bt(10,b.innerHTML)};
t.Dd=function(b,c,d,e){if(1==this.Hj)this.Kb.log(be,"Can't set html while loading Trogedit",i);else{e&&this.execCommand("clearlorem");c&&b&&(c="<p>"+c+"</p>");d&&Yu(this,m,j);b=c;if(c=this.h()){if(this.nc()&&D)for(var g=c.ownerDocument.getElementsByTagName("HEAD"),h=g.length-1;1<=h;--h)g[h].parentNode.removeChild(g[h])}else c=this.Hc;c&&tv(this,b,c);e&&this.execCommand("updatelorem");this.Vd()&&(d?(C&&Yr(this.me),zv(this)):this.Xe())}};
t.kA=function(){var b=this.gb.Ca();b.designMode="on";Eo&&b.execCommand("styleWithCSS",m,m)};t.zE=function(){this.Vk&&Bv(this)&&st(this.Vk,this.h())};t.Vd=function(){return 2==this.Hj};t.focus=function(){if(!Os&&this.nc())this.gb.Oa().focus();else{if(qb)var b=this.Hk.pageXOffset,c=this.Hk.pageYOffset;this.h().focus();qb&&this.Hk.scrollTo(b,c)}};t.Pf=function(){(wo||D)&&Cv(this);this.focus()};a.Cv=function(b){var c=b.h();if(c){var d=vs(c);c==d?to(c,0).select():Ur(d,j);Zu(b)}};
t.Ee=function(b){this.Hj=1;var c=this.Hc;this.nodeName=c.nodeName;this.WX=c.className;this.cssText=c.style.cssText;c.className+=" editable";this.Wx(b)};t.Wx=function(b){var c=this.Hc;if(c){var c=c.innerHTML,d={},c=this.bt(8,c,d),e=this.Wl.v("IFRAME",this.wD());if(Bv(this)){var g=v(this.mE,this,e,c,d);this.kl=O(e,"load",g,j);b&&(e.src=b)}this.vB(e);Bv(this)||this.mE(e,c,d)}};
t.zr=function(){B&&Ps(this.gb.Oa());jv!=this.id&&this.execCommand("updatelorem");if((Lg||Mg)&&this.nc()&&this.lH()){var b=this.gb.Oa();this.Sm=v(b.focus,b);b.addEventListener("keydown",this.Sm,m);b.addEventListener("touchend",this.Sm,m)}qb&&this.nc()?(this.Tu=v(this.Hv,this),this.Su=v(this.Vq,this),b=this.gb.Oa(),b.addEventListener("focus",this.Tu,m),b.addEventListener("blur",this.Su,m)):(Ho?(this.addListener("focus",this.FC),this.addListener(hd,this.DC)):this.addListener("focus",this.Hv),this.addListener("blur",
this.Vq,C));if(C)this.yz();else{this.addListener(["beforecut","beforepaste","drop","dragend"],this.Hh);var c=this.Xe,d;d=d||0;this.addListener(["cut","paste"],function(){return c.apply(this,Array.prototype.slice.call(arguments,0,d))});this.addListener("drop",this.yr)}this.addListener(D?"dragend":"dragdrop",this.yr);this.addListener("keydown",this.ef);this.addListener("keypress",this.JM);this.addListener("keyup",this.KM);this.cH=new Mj(this.cN,250,this);Fo&&this.addListener("click",Av);this.addListener("mousedown",
this.kj);this.aI?(this.gc.e(this.gb.Ca(),"mouseup",this.KD),this.addListener("dragstart",this.Lw)):this.addListener("mouseup",this.KD);this.addListener("mouseover",this.QM);this.zE();zv(this);this.Kb.info("Dispatching load "+this.id);this.dispatchEvent("load");for(var e in this.nd)this.nd[e].enable(this)};a.Bv=function(b){if(!ka(b.Ax)&&(b.Ax=m,B&&b.nc())){for(var c=b.Wl.Oa();c!=c.parent;)try{c=c.parent}catch(d){break}c=c.location;b.Ax="https:"==c.protocol&&-1==c.search.indexOf("nocheckhttps")}return b.Ax};
t.vB=function(b){var c=this.Hc;b.className=c.className;b.id=c.id;lc(b,c)};t.tw=function(b){var c=Jc(Rb(this.Hc));return new $u(this.id,c,m,m,b)};t.nI=function(b,c,d){d=this.tw(d);Bv(this)?(b=(b.contentDocument||b.contentWindow.document).body,Os&&(b.contentEditable=j),b.className="editable",b.setAttribute("g_editable",j),b.hideFocus=j,b.id=d.ZC,Tf(b,d.Zv),b.innerHTML=c):bv(d,c,new av(this.h(),this.Vk),b)};
t.mE=function(b,c,d){this.kl&&(yd(this.kl),this.kl=k);b.aW="true";this.nI(b,c,d);nv(this,(b.contentDocument||b.contentWindow.document).body);!Os&&this.nc()&&this.kA();this.zr()};t.wD=function(){var b="padding:0;"+this.Hc.style.cssText;Fa(b,";")||(b+=";");b+="background-color:white;";B&&(b+="overflow:visible;");return{frameBorder:0,style:b}};a.Dv=function(b,c){iv.call(this,b,c)},a.Ev=void 0;z(Dv,iv);t=Dv.prototype;t.Kb=ke("goog.editor.SeamlessField");t.HE=m;t.kO=m;t.Zn=p("HE");t.OD=function(){vv(this,cv)||Fv(this)};
t.Lz=function(){if(this.gp?0:this.gp=j){var b=m,c=wv(this);if(c){var d,e=wv(this),g=e.contentDocument.body;d=g.parentNode;0===parseInt(tt(e,"height"),10)&&Tf(e,"height","1px");if(Jc(Rb(g)))e=d.offsetHeight;else if(e=d.scrollHeight,d.clientHeight!=d.offsetHeight){d=e;if(!(e=Ev))e=document.createElement("div"),e.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px",g=document.createElement("div"),lg(g,"200px","200px"),e.appendChild(g),document.body.appendChild(e),g=e.offsetWidth-
e.clientWidth,M(e),e=Ev=g;e=d+e}d=e;this.XO&&(d=Math.max(d,this.XO));parseInt(tt(c,"height"),10)!=d&&(c.style.height=d+"px",b=j)}this.gp=m;b&&this.dispatchEvent("ifrsz")}};
a.Fv=function(b){if(b.gp?0:b.gp=j){var c=wv(b),d=b.h(),e=m;if(c&&d){var g,h=c.parentNode,l=h.offsetWidth;parseInt(tt(c,"width"),10)!=l&&(g=wg(d),c.style.width=l+"px",d.style.width=l-g.left-g.right+"px",e=j);h=h.offsetHeight;b.Zn()&&parseInt(tt(c,"height"),10)!=h&&(g||(g=wg(d)),c.style.height=h+"px",d.style.height=h-g.top-g.bottom+"px",e=j)}b.gp=m;e&&b.dispatchEvent("ifrsz")}},a.Gv=function(b){b.h()&&(Fv(b),b.Zn()||b.Lz())};t.cx="";a.Hv=m;t=Dv.prototype;t.nc=function(){return!Os};
t.yz=function(){Dv.n.yz.call(this);if(this.nc()){var b=wv(this).ownerDocument;this.gc.e(b,ov,this.OD,j);this.EO=vd(this.gb.Oa(),"load",this.Lz,j,this);this.gc.e(b,"DOMAttrModified",v(this.ED,this,this.OD),j)}};t.Fn=function(){vv(this,cv)||(Dv.n.Fn.call(this),this.nc()&&this.Lz())};
t.Vq=function(){if(!vv(this,"blur")&&(Dv.n.Vq.call(this),!Os&&!zo)){var b=this.gb.Oa(),c=m;yd(this.$E);this.$E=vd(b.document.body,"dragover",function(){c=j});fa.setTimeout(v(function(){if(!c&&this.gb){var b=xv(this),e=this.gb.Oa();Ps(e);b&&(b.collapse(j),b.select())}},this),0)}};t.kA=function(){Dv.n.kA.call(this);var b=this.gb.Ca();b.execCommand("enableInlineTableEditing",m,"false");b.execCommand("enableObjectResizing",m,"false")};
t.zE=function(){!this.nc()&&!Hv&&(this.Vk&&st(this.Vk,this.h()),Hv=j)};t.Wx=function(b){if(this.nc())Dv.n.Wx.call(this,b);else if(b=this.Hc)nv(this,b),b.contentEditable=j,tv(this,b.innerHTML,b),this.zr()};t.zr=function(){if(this.nc()){var b=this;fa.setTimeout(function(){Gv(b)},0)}Dv.n.zr.call(this)};t.wD=function(){return{frameBorder:0,style:"padding:0;"}};
t.vB=function(b){if(!this.kO){var c=this.Hc;c&&(this.HE="auto"==Xf(c,"overflowY"))}var c=this.Hc,d=Rb(c),e=c.style.width,g=c.style.height;Tf(c,"visibility","hidden");var d=d.v("DIV",{style:"height:0;clear:both",innerHTML:"&nbsp;"}),h=d.cloneNode(j);c.insertBefore(d,c.firstChild);c.appendChild(h);var h=rt(c),d=h.width,h=h.height,l="";this.Zn()&&(l="&nbsp;",Tf(c,"position","relative"),Tf(c,"overflow","visible"),Tf(b,"position","absolute"),Tf(b,"top","0"),Tf(b,"left","0"));lg(c,d,h);Jc(Rb(c))&&(this.GX=
c.style.lineHeight,Tf(c,"lineHeight","0"));c.innerHTML=l;lg(b,d,h);lg(c,e,g);Tf(c,"visibility","");c.appendChild(b);Bv(this)||(c=b.contentWindow.document,Jc(Rb(b.ownerDocument))&&(c.open(),c.write("<!DOCTYPE HTML><html></html>"),c.close()))};t.tw=function(b){var c=this.Hc;if(c)return new $u(this.id,Jc(Rb(c)),j,this.Zn(),b);f(Error("no field"))};
t.nI=function(b,c,d){Tf(b,"visibility","hidden");var d=this.tw(d),e=this.Hc,g=this.Vk;if(!this.cx){var h=this.Hc;if(h){var l=h.ownerDocument,n=ua(l);if(!Su[n]){for(var q=ua(l),r=[],l=Hu(l.styleSheets),w=0,x;x=l[w];w++)if((x=Gu(x))&&x.length)for(var G=0,I=x.length;G<I;G++){var R=new Ju,Z;Z=R;var ta=x[G],Lb=ta.style;if(Lb){var La=i,Sa=i;Lb&&(La=ta.selectorText)&&(Sa=Lb.cssText)?B&&(Sa+="/* */"):ta.cssText&&(Sa=/([^\{]+)\{/,La=Sa.exec(ta.cssText)[1],Sa=ta.cssText.replace(Sa,"").replace(/\}[^\}]*$/g,
""));if(La){ta=Z;ta.dh=[];La=La.split(/,\s*/gm);for(Lb=0;Lb<La.length;Lb++){var we=La[Lb];0<we.length&&ta.dh.push(new Nu(we))}Z.mn=Sa;Z=j}else Z=m}else Z=m;Z&&r.push(R)}Su[q]=r}q=Su[n];n=[];for(r=0;r<q.length;r++)n.push(q[r].clone());l=new Ru(h);w=new Mu("body");for(q=0;q<n.length;q++){x=n[q].dh;r=x.length;for(G=0;G<r;G++){I=x[G];R=I;Z=l.uid;if(R.Iu[Z])Z=R.Iu[Z];else{for(var Sa=0,Lb=La=ta=k,we=l.IF,wE=we.length,ck=0;ck<=R.ei.length;ck++){for(La=R.ei[ck];Sa<wE;){var oy=we[Sa];if(La&&Pu(La,oy)){ta=
{OC:Sa,dH:ck};Sa++;break}else Lb&&Pu(Lb,oy)&&(ta={OC:Sa,dH:ck-1});Sa++}Lb=La}Z=R.Iu[Z]=ta}Z&&(R=Z.dH,I=I.ei,Sa=I.length-1,Z.OC==l.IF.length-1||R<Sa?(I=I.concat(),I.splice(0,R+1,w),R=new Nu,R.ei=I,x.push(R)):0<R&&R==Sa&&(R=new Nu,R.ei=[w,I[Sa]],x.push(R)))}}l=new Ju;h=h.currentStyle||Qb(h).defaultView.getComputedStyle(h,"")||{};q=new Nu;q.ei=[new Mu("html")];l.dh=[q];w={};for(q=0;r=Tu[q];q++)w[r]=h[db(r)];Ku(l,w);n.push(l);l=new Ju;w=new Nu;w.ei=[new Mu("body")];x={position:"relative",top:"0",left:"0",
right:"auto",display:"block",visibility:"visible"};for(q=0;r=Uu[q];q++)x[r]=h[db(r)];Ku(l,x,j);l.dh=[w];n.push(l);h=[];r=n.length;for(q=0;q<r;q++){x=n[q];l=h;G=x.dh.length;w=m;for(I=0;I<G;I++){R=x.dh[I].ei;Z=R.length;for(Sa=0;Sa<Z;Sa++)l.push(R[Sa].xE," ");I<G-1&&l.push(",");C&&!E("1.9a")&&(w=w||Iu.test(R[Z-1].xE))}x=x.mn;w&&(x=x.replace(Lu,"$1 color: $2 ! important; "));l.push("{",x,"}\n")}this.cx=h.join("")}}e=new av(e,g+this.cx);d.rq&&(g=wg(e.AT),(g.top||g.left||g.right||g.bottom)&&Tf(b,"margin",
-g.top+"px "+-g.right+"px "+-g.bottom+"px "+-g.left+"px"));bv(d,c,e,b);Gv(this);Tf(b,"visibility","visible")};t.gv=function(){yd(this.$E);yd(this.EO);Dv.n.gv.call(this)};a.Iv={};Iv._default_={xw:function(b){return $.get("/node/CommentV2",{params:{comment_id:b}})},ql:wt,rl:wt,add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},remove:function(b){return $.post("/node/CommentV2",{method:"remove_comment",params:{comment_id:b}})},Qx:function(b,c){return $.post("/node/CommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})}};
Iv.answer={ql:function(b,c){return $.get("/node/AnswerCommentBoxV2",{params:{answer_id:b,load_all:c}})},rl:function(b){return $.get("/node/AnswerCommentListV2",{params:{answer_id:b}})},add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},NJ:function(b,c){return $.post("/node/AnswerCommentV2",{method:"author_remove_comment",params:{comment_id:b,is_block:c}})}};
Iv.question={ql:function(b){return $.get("/node/QuestionCommentBoxV2",{params:{question_id:b}})},rl:function(b){return $.get("/node/QuestionCommentListV2",{params:{question_id:b}})},add:function(b){return $.post("/node/QuestionCommentAddV2",{method:"add_comment",params:b})}};
Iv.favlist={ql:function(b){return $.get("/node/FavlistCommentBoxV2",{params:{favlist_id:b}})},rl:function(b){return $.get("/node/FavlistCommentListV2",{params:{favlist_id:b}})},add:function(b){return $.post("/node/FavlistCommentAddV2",{method:"add_comment",params:b})}};
Iv.post={xw:function(b){return $.get("/node/PostCommentV2",{params:{comment_id:b}})},ql:function(b,c){return $.get("/node/PostCommentBoxV2",{params:{post_id:b,load_all:c}})},rl:function(b){return $.get("/node/PostCommentListV2",{params:{post_id:b}})},add:function(b){return $.post("/node/PostCommentV2",{method:"add_comment",params:b})},Qx:function(b,c){return $.post("/node/PostCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/PostCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};
Iv.roundtable={xw:function(b){return $.get("/roundtable/comments/"+b)},ql:function(b,c){return $.get("/node/RoundtableCommentBoxV2",{params:{roundtable_id:b,load_all:c}})},rl:function(b){return $.get("/roundtable/comments",{roundtable_id:b})},add:function(b){return $.post("/node/RoundtableCommentV2",{method:"add_comment",params:b})},Qx:function(b,c){return $.post("/node/RoundtableCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/RoundtableCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};a.Kv=function(b,c){var d=b.split("!");this.type=d[0]+"!";this.namespace=d[1];this.wc=new Jv(c)};z(Kv,fd);a.Jv=function(b){this.category=b.category;this.action=b.action;this.label=b.label;this.value=b.value};Jv.prototype.fill=function(b,c){this[b]=this[b].replace("?",c);return this};a.Lv=function(){N.call(this)};z(Lv,eu);a.Mv=function(b,c,d){$.post(b,c).done(function(b){if(b.r)U(b.msg);else{var c=b.msg;(c=c&&c.redirect)?window.location.href=c:(U("操作成功！"),d&&d(b))}})},a.Nv=void 0,a.Ov=Jr($.getJSON);Nv=function(b,c){return Ov(Ga("/manage/%s/options?action=%s",b,c))};t=Lv.prototype;t.NA={remove:"删除",lock:"锁定",unlock:"解除锁定",collapse:"折叠",uncollapse:"解除折叠",mute:"隔离",unmute:"解除隔离"};t.yD=function(b){return Nv(b,this.ol())};
t.Ok=function(b,c){var d=Lv.n.Ok.call(this,b,c);d.oc.set("ok",this.NA[this.ol()]);return d};t.ol=function(){return $(this.Wu).data("op").split("-")[0]};t.rD=function(b){return Ga("确定要%s该%s？",this.NA[this.ol()],this.YA[b]||"条目")};t.gH=function(b){$(".footnote",this.sw().h()).text(b)};t.ND=function(b){b&&(b.trackable?(b=$.extend({action:"get_member_info",reason:b.value},this.vL),$.post("/manage",b).then(function(b){return Ga("用户已被警告 %s 次，禁言 %s 次",b.warn_num,b.ban_num)}).then(v(this.gH,this))):this.gH(""))};
Lv.prototype.submit=function(){var b=$(this.Wu).data(),c=b.action,b=b.content,d=$($("form",this.pn.h())[0]).serialize();b&&(d+="&"+b);Mv(c,d,this.Qk)};Lv.prototype.w=function(){this.Qk=this.Wu=k;Lv.n.w.call(this)};Lv.prototype.open=function(b,c,d){this.Wu=b;this.Qk=d||ea.AX;Lv.n.open.call(this,c.type,c.id,"")};a.Pv=function(b){T.call(this);H.extend(this.F={},this.defaults,b||{});this.Dk=new Nd;this.Af=k};z(Pv,T);t=Pv.prototype;t.defaults={trigger:{A:"data-editable"},gJ:"hc-actionbar",vO:"checked",jS:100,wN:100};
t.z=function(){Pv.n.z.call(this);this.Pm=L("div");document.body.appendChild(this.Pm);var b=this.F,c=new Jq(b.trigger,m,k,this.g);c.Bt=b.jS;c.Lr=b.wN;c.eh(this.Pm);O(c,"trigger",function(b){c.Lc(new qq(b.anchor,1))});O(c,"beforeshow",function(b){this.Af=b.target.anchor;this.X()},m,this);c.className=b.gJ;this.BN=c};t.vw=p("BN");
a.Qv=function(b,c){var d=b.F.vO,e=nc(b.Pm),g=A.find(e,function(b){return b.getAttribute("data-action")===c});if(!g||F.has(g,d))return m;A.forEach(e,function(b){F.remove(b,d)});F.add(g,d);return j};t.cK=function(b,c,d){c=L("div",{title:b.R,"data-action":b.name,className:"button "+b.name+(0===c?" first":c===d.length-1?" last":"")},[L("i","icon icon-actionbar-"+b.name)]);sg(c,j);this.m().e(c,"click",function(){Qv(this,b.name)&&b.Pk(this.Af)});return c};
t.X=function(){this.Pm.innerHTML="";gc(this.Pm,A.map(H.Ma(this.Dk.Rt()),this.cK,this))};a.Rv=function(b){T.call(this);H.extend(this.F={},this.defaults,b||{})};z(Rv,T);Rv.prototype.defaults={dE:{},KJ:j};
Rv.prototype.z=function(){Rv.n.z.call(this);var b=this,c=this.g;if(this.F.KJ){var d=new Pv({});d.Dk.set("link",{name:"link",R:"链接",Pk:function(b){wc(b,b.href)}||ha});d.Dk.set("text",{name:"text",R:"文本",Pk:function(b){wc(b,b.getAttribute("data-title"))}||ha});d.o(c);var e=d.vw();Rr(e,new Of(2,0,0,0));e.Fl=new Of(2,0,0,0)||k;var g=d.m();g.e(e,"beforeshow",function(b){var b=b.target.anchor,c=Ec(b);c===b.href?Qv(d,"link"):(c!==b.getAttribute("data-title")&&b.setAttribute("data-title",c),Qv(d,"text"))}).e(e,
"beforehide",function(b){if((b=b.target)&&c.contains(b)&&Sv(b))return m});var h;g.e(e,"show",function(b){h=b.target.anchor;F.add(h,"hover")}).e(e,"hide",function(){h&&(F.remove(h,"hover"),h=k)});this.Vp=d}this.m().e(c,"paste",function(){setTimeout(function(){var c=b.F,d=b.g,e=yc(d,function(b){return 3===b.nodeType&&!Tv(b,d,function(b){return Sv(b)||"CODE"===b.nodeName||"PRE"===b.nodeName})}),g,h=ro(),x=h&&Bn(h);A.forEach(e,function(b){var c=b.nodeValue,d=c.replace(Uv,function(b){Ea(b,"http")||(b=
"http://"+b);return b.link(b)});d!==c&&(c=ec(d),x===b&&(g=c.lastChild),lc(c,b))});g&&Ur(g);var G=c.dE,c=A.filter(d.getElementsByTagName("A"),function(b){var c=b.getAttribute("href");if(c=!(!c||"#"===c))if(c=!b.getAttribute("data-editable"))if(c=A.contains(Vv,b.protocol))c=Ec(b),Ea(b.href,c)?b=i:(b.setAttribute("data-editable",j),b.setAttribute("data-title",c),b=j),c=!b;return c}),c=A.map(c,function(b){return Wv(b.href).done(function(c){var e=G;if(c&&d.contains(b)){var e=e||{},g=function(b,c,d){var e=
ro();if(e){var g=e.U(),h=e.sa(),l=e.fa(),n=e.Ia();rc(c,g)&&(g=b,h=0);rc(c,l)&&(l=b,n=0);d(function(){g===b&&l===b?Ur(b):bo(g,h,l,n).select()})}else d(ha)},h={link:function(b,c){b.setAttribute("data-editable",j);c.title===b.href?b.setAttribute("data-title",b.hostname.split(".").slice(/(.com|.edu|.gov|.net|.org)$/.test(b.hostname)?-2:-3).join(".").replace(/^www\./,"")+" 的页面"):(b.setAttribute("data-title",c.title),g(b,b,function(d){wc(b,c.title);d()}))},image:function(b,c){var d=document.createElement("img");
d.src=c.src;d.setAttribute("data-rawwidth",c.width);d.setAttribute("data-rawheight",c.height);g(d,b,function(c){lc(d,b);c()})}};(e=e[c.type]||h[c.type])&&e(b,c)}})});c.length&&(b.dispatchEvent("willScrape"),$.when.apply($,c).always(function(){b.dispatchEvent("didScrape")}))})}).e(c,"keydown",this.rN)};
Rv.prototype.rN=function(b){var c=rh(b.keyCode),d=8===b.keyCode;if(!(b.ctrlKey||(b.altKey||b.metaKey)||!c&&!d)){var c=ro(),e=c.U(),g=c.fa(),h=this.g,l,n=Tv(e,h,Sv)||g!==e&&(l||(l=Tv(g,h,Sv)));if(n){var q=Ec(n),r=c.sa(),w=c.Ia();if(n.getAttribute("data-editable")&&q===n.href){var x=m;l=l||Tv(g,h,Sv)||n;var h=n.contains(e),G=l.contains(g);if(d)h&&(e=n,r=0,x=j),G&&(g=l,w=Mr(l),x=j),x&&bo(e,r,g,w).select();else if(h&&G&&l===n){if(!c.isCollapsed()||!(0===r||q.length===r))b.preventDefault(),Ur(n)}else h&&
(e=n.nextSibling,r=0,x=j),G&&(g=l.previousSibling,w=Mr(g),x=j),x&&bo(e,r,g,w).select()}}}};a.Uv=/\b(?:(?:https?):\/\/|www\.)(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[\-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/ig,a.Vv=["http:","https:"],a.Tv=function(b,c,d){for(;b&&b!==c;){if(d(b))return b;b=b.parentNode}},a.Sv=function(b){return"A"===b.nodeName},a.Wv=Jr(function(b){return $.post("/scraper",{url:b})});a.Xv=function(b,c,d){T.call(this);this.id=b;this.type=c;this.field=k;this.vd=this.Wg=m;this.$d="写下你的评论…";this.placeholder='<p style="color:#999">'+this.$d+"</p>";this.Kl="";this.ea=-1;this.gF=$.Deferred().resolve();this.Sy=this.ws=k;this.TB="zm-comment-box";this.ph=k;(b=Iv[c])||f(Error("API not found"));this.Ii=$.extend({},Iv._default_,b);this.dn="";H.extend(this.F={},this.defaults,d||{})};z(Xv,T);
a.Yv=function(b,c){return Hm(b,function(){return{na:{question:"question_comment_"+c,answer:"question_answer_comment_"+c}[this.type]||j,cd:j}},p("dn"))};t=Xv.prototype;t.defaults={dF:m,autofocus:j,Lv:"empty",kf:"zm-item-comment"};t.$=function(b){Xv.n.$.call(this,b);Zv(this);$v(this);this.vd=j;A.forEach(aw(this),this.Ls,this)};a.bw=function(b,c,d){var e=K(b.TB,c);d&&(b.ph=d);e?b.o(e):(b.Wg=j,b.X(c))};t.IJ="zm-comment-bubble";t.sB="."+Xv.prototype.IJ;t.fu=function(b){return $(b,this.g)};
t.v=function(){this.g=L("div",{"class":this.TB,style:"display:none"});this.Ze()};t.Oi=s('<i class="icon icon-spike zm-comment-bubble"></i><div class="zm-comment-spinner">正在加载，请稍等 <i class="spinner-lightgray"></i></div>');t.w=function(){Xv.n.w.call(this);this.field=this.XB=this.cn=this.kB=this.ph=this.Sy=this.eF=k};
a.cw=function(b){var c=b.dl,d=c.h();if(c.pl()!==b.placeholder){c.Dd(m,b.placeholder);var e=["click","focus","keydown"],g=function(){c.Dd(m,this.Kl||"");this.field.lastChild?Ur(this.field.lastChild):c.Pf();wd(d,e,g,m,this)};O(d,e,g,m,b);var h;window.getSelection?(h=window.getSelection(),h.anchorNode&&rc(b.field,h.anchorNode)&&h.removeAllRanges()):document.selection&&b.field.blur()}};t.$r=function(b){(b=b.h&&b.h())&&(new Rv({dE:{image:ha}})).o(b)};
t.Zr=function(b,c){if(b.h){var d=(new Rl).add("type",this.type+"_comment").add("resource_id",this.id),e=b.h();this.uX=d=new ip(e,{Gm:{source:"/people/autocomplete?"+d.toString()},Rj:K("zu-main")||document.body});new ep(e,{dz:kp});pa(c)&&c(d)}};
t.oS=Yv(function(b){var c=K("zm-comment-content-wrap",b),d=K("zm-comment-form",b),e=b.getAttribute("data-id"),g=this,h;if(d){h=K("zm-comment-editable",d);if(qg(d)){if(ps(d))return Q(d,m)}else Q(d,j);dw(h)}else{(b=K("zm-comment-reply-hack"))?(b=ec(Qr(b)),F.zu(b,"zm-comment-reply-hack","zm-comment-reply-hacked"),jc(b,c)):(b="",S.na()&&(b='<img class="avatar" src="'+S.SL()+'">'),b=ec('<div class="zm-comment-form expanded"><div class="zm-comment-editable-wrap">'+b+'<div class="zm-comment-editable" aria-label="写下你的回复"></div></div><div class="zm-command zg-clear"><a href="javascript:;" class="zm-comment-submit zg-right zg-btn-blue">评论</a><a href="javascript:;" class="zm-comment-close zm-command-cancel">取消</a></div></div>'),
c.appendChild(b));d=b;h=K("zm-comment-editable",d);var l=new Dv(h);l.Dd(m,"");l.Ee();this.Zr(l,function(){dw(h)});this.$r(l);c=K("zm-comment-close",d);b=K("zm-comment-submit",d);b.name="";var n=function(){var b=Ma(l.pl()),c=Ma(Ec(h));b&&c?ew(g,{content:b,xR:e},function(b){b.r||(Q(d,m),l.Dd(m,""),(b=A.Yd(aw(g)))&&Cs(b,{offsetTop:100,pB:j}))}):(U("请填写内容"),h.focus())};O(c,"click",function(){Q(d,m)});O(b,"click",n);O(h,"keydown",function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))n(),b.preventDefault()})}Cs(d,
100)},"reply");a.dw=function(b){b.focus();b=En(b);b.collapse();b.select()},a.$v=function(b){var c=location.hash.slice(1).split("-"),d="comment"===c[0]&&c[1];d&&(b=A.find(aw(b),function(b){return b.getAttribute("data-id")===d}),Ok(b),Cs(b))},a.aw=function(b){return $(b.cn).children(".zm-item-comment").get()};t.At=function(b){F.enable(this.XB,"expanded",b)};t.ri=function(b,c){this.dispatchEvent(new Kv("click!comment",{category:"?",action:this.type+"_comments",label:"?_"+b,value:oa(c)?c:this.Sa()}))};
t.ij=function(){this.vd?fw(this):this.Wg=j};t.NP=function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))this.Yp(),$(this.field).blur(),b.preventDefault();27===b.keyCode&&gw(this)};
t.ua=function(b){var c=Uk(this.g,b.target,"BUTTON")||Uk(this.g,b.target);if(c&&c.name){var d=Hc(c,k,this.F.kf);b.preventDefault();switch(c.name){case "reply_comment":this.oS(d);break;case "cancelanon":b=$(this.g).parents(".feed-item-hook").data("qid");Zr(0,k,b);break;case "delcomment":this.wr(c);break;case "like_comment":this.MM(c);break;case "author_delcomment":var e=this,g=Hc(c,k,this.F.kf),h=g.getAttribute("data-id"),b=$(".zm-item-link-avatar",g).prop("href");$.get(b+"/block",function(b){var c=
Bi("删除评论","你确定要删除这条评论吗？"+('<p style="margin-top: 0.2em;color:#999;'+(b.r||b.msg?"display:none":"")+'"><label><input type="checkbox">同时将此人屏蔽</label></p>'),function(b){if(b){var b=$(":checkbox",c.h()).prop("checked"),d=xa(M,g);e.Ii.NJ(h,Number(b)).done(v(function(){pa(d)&&d();this.ea-=1;hw(this)},e))}},e)});break;case "admin_delcomment":var l=Hc(c,k,this.F.kf);(new Lv).open(c,{id:l.getAttribute("data-id"),type:"comment"},v(function(){M(l);this.ea-=1;hw(this)},this));break;case "closeform":gw(this);
break;case "addnew":this.Yp();break;case "load-more":this.ri("comments_all"),this.eF(c)}}};
t.eF=function(b){this.ws&&"pending"===this.ws.state()||(b&&F.add(b,"loading"),this.ws=this.Sy||this.fF(),this.ws.done(v(function(c){c=$(c).filter(".zm-item-comment").get();if(c.length){var d=aw(this);d.length&&(c=A.filter(c,function(b){return!A.find(d,function(c){return c.getAttribute("data-id")===b.getAttribute("data-id")})}),c=A.concat(d,c).sort(function(b,c){return b.getAttribute("data-id")-c.getAttribute("data-id")}),A.forEach(c,this.Ls,this),b&&M(b));gc(this.cn,c)}},this)))};
t.MM=Yv(function(b){var c=$(b),d=Hc(b,k,this.F.kf),b=$(".like-num",d),e=d.getAttribute("data-id");(d=!c.hasClass("liked"))&&this.ri("like_comment");this.Ii.Qx(e,d);var e=$("em",b),g=+e.text()+(d?1:-1);b.toggleClass("liked",d).toggleClass("nil",0>=g).attr("data-tip","s$r$"+g+" 人觉得这个很赞");e.text(g);c.toggleClass("liked",d);Gk(c[0],d?"取消赞":"赞")},"like");a.gw=function(b){0<b.Sa()?(b.Kl=b.bb(),b.At(m),cw(b)):b.ph?b.collapse():b.At();b.Hf()};t.expand=function(){this.Ka(j)};t.collapse=function(){this.Ka(m)};
t.tc=p("vd");t.Ka=function(b){if(b!==this.vd){b&&(this.fu(this.sB).hide(),this.Ze());this.vd=b;this.dispatchEvent(b?"beforeexpand":"beforecollapse");Q(this.g,this.vd);var c=v(function(){b&&iw(this);this.dispatchEvent(b?"expand":"collapse");this.ml&&!b&&(ap(this.ml),Cs(this.ml.g))},this),d;b&&this.Wg?(d=fw(this))&&d.done(c):setTimeout(c);this.ph&&(b?(this.FQ=Ec(this.ph),Gk(this.ph,"收起评论")):Gk(this.ph,0>this.ea?this.FQ:this.ea?this.ea+" 条评论":"添加评论"))}};t.xf=function(){this.Ka(!this.vd)};
a.iw=function(b){if(b.ph){var c=$(b.ph);b.fu(b.sB).show().css("left",c.position().left+c.width()/2)}},a.fw=function(b){if("pending"!==b.gF.state()){b.hb();b.g.innerHTML=b.Oi();b.expand();var c=b.Ii.ql(b.id,b.F.dF).done(v(b.qR,b));return b.gF=c}};t.fF=function(){return this.Ii.rl(this.id)};t.tt=ca("dn");
a.jw=function(b,c,d){var c=$(c),e=$(d);d?($(".zm-command, .zm-comment-info",b.g).hide(),$(b.field).hide().after(e).after(c)):c.insertAfter(b.field);b=v(Yv(ha,"box"),b);c.on("click",b);e.on("click",b)};t.qR=function(b){b=ec(Ma(b));Q(b,this.vd);A.forEach($("."+this.F.kf,b).get(),this.Ls,this);this.Wg=m;this.hb();lc(b,this.g);this.g=b;Zv(this)};
a.Zv=function(b){H.forEach({kB:".load-more",cn:".zm-comment-list",XB:".zm-comment-form",field:".zm-comment-editable"},function(b,c){this[c]=$(b,this.g)[0]},b);b.field&&b.field.setAttribute("aria-label",b.$d);if(Qg){var c=b.field;c.setAttribute("contentEditable",j);var d=b.dl={h:function(){return c},pl:function(){return c.innerHTML},Dd:function(b,d){c.innerHTML=d},Pf:function(){Ms(c)}};b.Zr(d);b.$r(d)}else{var e=L("textarea",{placeholder:b.$d,"class":"zm-comment-textarea"});lc(e,b.field);new Pm(e,
22);b.field=e;b.dl={h:function(){return e},pl:function(){return e.value},Dd:function(){e.value="";e.style.height=Zf(22,j)},Pf:function(){e.focus()}}}b.m().e(b.field,["change","keyup"],function(b){27!==b.keyCode&&(this.Kl=Ns(this.field)?"":this.bb())});S.na()?S.Fi||jw(b,'<div class="active-mask-tip-comment">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>'):jw(b,'<div class="signin-mask-tip-comment"></div>',k);cw(b);
b.m().e(b.g,"click",b.ua).e(b.field,"keydown",b.NP).e(Ki,"anon_change",b.ij).e(b.dl.h(),["click","focus"],xa(b.At,j)).e(b.dl.h(),"focus",xa(b.ri,"add_comment_start"));b.ea=Number(b.g.getAttribute("data-count"));$(b.g).on("focusin focusout","."+b.F.kf,function(b){$(this).toggleClass("focusin","focusin"===b.type)});!rb&&b.kB&&(b.Sy=$.Deferred(function(b){setTimeout(b.resolve,2E3)}).promise().then($.proxy(b.fF,b)));hw(b);iw(b)},a.hw=function(b){var c=b.F,d=!b.Sa();F.enable(b.g,c.Lv,d);d&&b.field&&c.autofocus&&
b.field.focus();b.dispatchEvent("change")};t.bb=function(){var b=Ma(this.dl.pl());return b===this.placeholder?"":b};t.Yp=function(){var b=this.bb(),c=Ma(Ec(this.field));b&&"TEXTAREA"===this.field.tagName&&c||b?ew(this,b):(U("请填写内容"),this.field.focus())};t.Sa=p("ea");
a.ew=function(b,c,d){if(!(b.$l&&"pending"===b.$l.state())){var e;qa(c)&&(e=c.xR,c=c.content);var c=Oa(c),g=new Nd;g.set(b.type+"_id",b.id);g.set("content",c);e&&g.set("reply",e);c=b.Ii.add(g.Rt());c.done($.proxy(b.bM,b)).done(d);b.$l=c;b.Kl=b.bb();b.ri("add_comment_submit")}};t.bM=function(b){if(b.r)return U(b.msg);this.Ii.xw(b.msg).done($.proxy(this.rR,this));this.dl.Dd("");cw(this);this.At(m)};
t.Ls=function(b){if(oh("auth_f_manage")&&!("favlist"===this.type||$(".del, .op.remove",b).length)){var c=b.getAttribute("data-id");$("<a>",{href:"#",name:"admin_delcomment","class":"del zm-comment-op-link op needsfocus",html:'<i class="zg-icon zg-icon-comment-del"></i>删除',"data-op":"remove-comment","data-action":"/manage?"+$.param({comment_id:c,action:"remove_comment2"})}).appendTo($(".zm-comment-ft, .actions",b))}this.vj(b)};
t.vj=function(b){var c=$("a[name=report]",b);c.length&&(b=b.getAttribute("data-id"),b=new gu("comment",b,{post:"article_comment_report",question:"question_comment_report",answer:"question_answer_comment_report"}[this.type]),ju(b,c[0]),Qc(b,this))};t.rR=function(b){this.Kl="";b=ec(b);this.cn.appendChild(b);this.Ls(b);this.ea+=1;hw(this)};
t.wr=function(b){var c=Hc(b,k,this.F.kf),d=c.getAttribute("data-id");Bi("删除评论","你确定要删除这条评论吗？",function(b){if(b){var g=xa(M,c);this.Ii.remove(d).done(v(function(){pa(g)&&g();this.ea-=1;hw(this)},this))}},this)};t.Ze=function(){$(window).on("beforeunload.CommentForm",v(function(){if(this.Kl)return"你的评论还未保存，确认离开该页面吗？"},this))};t.Hf=function(){$(window).off("beforeunload.CommentForm")};
a.kw=function(b){if(!b.ml&&!bh.uc){var c=Hc(b.g,k,"zm-item-meta");if(c){var d=K("zm-meta-panel",c);d&&(b.ml=new cp(k,c),b.ml.lh="comment",b.ml.o(d))}}};a.lw=function(b){T.call(this);this.entryType=b};z(lw,T);a.mw=function(b,c){return Hm(b,c,function(){return this.zn()})};t=lw.prototype;t.Xv="zm-item-expanded";t.As="zm-item-meta";t.Dj=k;
t.z=function(){lw.n.z.call(this);var b=$(this.g),c={};$("meta[itemprop]",b).each(function(){var b=$(this);c[b.attr("itemprop")]=b.attr("content")});this.pb=c[this.entryType+"-id"];this.Lh=c[this.entryType+"-url-token"];this.cr=c;this.Qm();this.je();var b=$('.js-report, a[name="report"]',this.h()),d=this.entryType,e=this.pb;b.each(function(b,c){var l=$(c),n=new gu(d,e);l.hasClass("goog-menuitem")?l.click(function(){n.mH()}):(ju(n,c),Qc(n,this))})};
t.zn=function(){var b=this.entryType+"-"+this.pb;return $('a[name="'+b+'"]',this.g).length&&"#"+b};
t.Qm=function(b){var c={'a[name="expand"]':function(b){this.Ka(j);this.ao&&(b.currentTarget.name="toggleExpanded")},'a[name="collapse"]':function(){this.Ka(m)},'a[name="toggleExpanded"]':this.xf,'a[name="ignore"]':this.Ar,".js-close":this.SD,".js-collect":this.jj,".js-hiderelated":this.RD,".js-share":this.sc,".js-toggle-commentbox":this.XD,".js-unhide":this.aE,'a[name="dislike"]':this.DD};H.extend(c,b||{});H.forEach(c,function(b,c){if(pa(b))$(this.g).on("click",c,$.proxy(b,this))},this);var d=$(".zm-meta-panel",
this.g);H.forEach({'a[name="toggle-comment"]':function(b){this.XD(b);d.toggleClass("focusin",this.oa.tc())},'a[name="share"]':this.sc},function(b,c){d.on("click",c,$.proxy(b,this))},this)};t.XD=function(b){this.up();this.oa.tc()&&(b=parseInt(Ec(b.currentTarget),10)||0,this.oa.ri("view_comments",b))};t.Zx=function(){Cu(this.entryType,this.Lh,"read")};t.Jj=function(){Cu(this.entryType,this.Lh,"touch")};t.tc=function(){return F.has(this.g,this.Xv)};t.xf=function(){this.Ka(!this.tc())};
t.Ka=function(b){if(b===this.tc())return m;b&&rt(this.g).height<Xb().height&&1<$("a.collapse",this.g).length&&$("a.collapse",this.g).eq(0).remove();F.enable(this.g,this.Xv,b);this.dispatchEvent(b?"expand":"collapse");return j};t.wQ=function(){window.open(K(this.Dj,this.g).href)};t.SD=function(){$(this.g).fadeOut(150,function(){$(this).remove()})};t.jj=ha;t.Ar=ha;t.aE=ha;t.RD=ha;t.sc=mw(function(){new yu(arguments,"tb-webshare-sina")},{na:"question_answer_share"});
t.DD=function(){var b=$(this.g),c=$(".feed-item-inner",b),d=$(".undo-dislike-options",b),e={block_id:b.data("block"),offset:b.data("offset")};d.off().one("click",".revert",function(){c.slideDown();d.slideUp();$.post("/topstory/item/uninterest/revert",e)}).one("click",".close",function(){b.slideUp(function(){b.remove()})});$.post("/topstory/item/uninterest",e).done(function(){c.slideUp();d.slideDown()})};
t.up=function(){if(!this.oa){var b=$(".toggle-comment",this.g)[0];this.oa=new Xv(this.pb,this.entryType);this.H(this.oa);bw(this.oa,K(this.As,this.g),b);kw(this.oa);this.oa.tt(this.zn())}this.oa.xf()};t.Pw=function(){this.oa?this.oa.field.focus():this.up()};t.je=function(){this.eg=Ek.lI(this.g);Dk(this.eg.register("shift+o",this.wQ,this),{group:"操作",name:"新窗口打开条目"});var b=$('a[name="dislike"], a[name="ignore"]',this.g);b.length&&Dk(this.eg.register("i g",function(){b.click()}),{group:"操作",name:"不感兴趣"})};a.ow=function(b,c){this.oo=this.td=1;this.Xg=c||4;this.items=b||[];this.MB=[];nw(this)};
ow.prototype={Bd:function(b){if(b)this.MB.push(b);else{var c={current:this.td,Kn:this.Kn(),Hr:this.Hr()};A.forEach(this.MB,function(b){setTimeout(function(){b.call(k,c)})})}},remove:function(b){b=this.items.indexOf(b);-1!==b&&(this.items.splice(b,1),nw(this),this.Bd());return b},Kn:function(){return this.td<this.oo},Hr:function(){return 1!==this.td},next:function(){this.Kn()&&(this.td+=1,this.Bd())},prev:function(){this.Hr()&&(this.td-=1,this.Bd())},random:function(b){if(this.oo>=2*this.Xg){for(var c=
[],d=1;d<this.oo+1;d++)c.push(d);0!==b&&A.remove(c,this.td);0!==this.items.length%this.Xg&&A.remove(c,this.oo);this.td=c[Math.floor(Math.random()*c.length)]}else b===this.Xg&&this.items.reverse(),this.td=1;this.Bd();return this.items.length>this.Xg}};a.pw=function(b,c,d){c=(c-1)*b.Xg;return b.items.slice(c,c+d)},a.nw=function(b){b.oo=Math.ceil(b.items.length/b.Xg)};a.qw=function(b){lw.call(this,b)};z(qw,lw);
qw.prototype.z=function(){qw.n.z.call(this);var b=$(this.h()),c=$(".js-list",b);$(".js-hidden-list",b);var d=$(".pager",b),e=$.makeArray($("<div>").html($(".js-hidden-list").html()).children().add(c.children())),g=this.KX=new ow(e,4);g.Bd(function(b){d.find(".next").toggleClass("disabled",!b.Kn);d.find(".prev").toggleClass("disabled",!b.Hr)});$(".pager",b).on("click",".next:not(.disabled)",function(){g.next();c.html(pw(g,g.td,g.Xg))}).on("click",".prev:not(.disabled)",function(){g.prev();c.html(pw(g,
g.td,g.Xg))});b.on("click","[data-follow]",function(b){var c=$(b.target).closest(".item"),d;var e=c[0],b=pw(g,g.td+1,1)[0];g.Kn()&&b?(e=g.remove(e),g.remove(b),g.items.splice(e,0,b),d=b):d=i;d&&c.fadeOut(function(){c.replaceWith(d)})})};qw.prototype.DD=function(){var b=this,c=$(this.g);$.post("/actioncard/uninterest",{type:"suggest_topics"},function(){c.slideUp(function(){b.G();c.remove()})})};a.rw=function(b){lw.call(this,b)};z(rw,lw);rw.prototype.Dj="question_link";rw.prototype.Ar=function(){var b=this.cr["question-id"];this.dispatchEvent({type:"ignore",key:"question-id",value:b});$.post("/question/uninterest",{qid:b})};a.sw=function(){lw.call(this,"question")};z(sw,rw);sw.prototype.z=function(){sw.n.z.call(this);Ht(this.g,function(){Cu("question",this.Lh,"touch")},this)};sw.prototype.sc=function(){sw.n.sc.call(this,"分享问题","question",this.Lh,{qid:this.pb})};
sw.prototype.je=function(){sw.n.je.call(this);Dk(Dk(Dk(this.eg.register("c",this.up,this),{group:"操作",name:"打开评论"}).register("f x",this.sc,this),{group:"操作",name:"分享"}).register("shift+c",this.Pw,this),{group:"操作",name:"定位到评论框"})};a.tw=function(){lw.call(this,"answer")};z(tw,rw);a.uw=function(b){return K("zm-item-answer",b)||K("entry-body",b)};t=tw.prototype;t.z=function(){tw.n.z.call(this);this.qB=uw(this.g);this.ao=this.qB.getAttribute("data-isowner");this.nx();this.Hl()};t.sc=ha;
t.Ka=function(b){tw.n.Ka.call(this,b)&&(b||(bt(this.sg.h()),vw(this,m)),b&&this.Hl(),this.sg.xz(b),this.sg.It.Ka(b))};t.nx=function(){var b=K("zm-item-answer-author-wrap",this.g);b&&(b=K("zm-list-avatar",b),lk.add(b))};t.Hl=function(){this.sg=new ww(this.cr["question-id"],{mb:this.cr["question-url-token"]},this.pb);var b=K("zm-item-meta",this.g);this.sg.Gc=b;this.H(this.sg);this.sg.o(this.qB);b=this.sg.It;this.m().e(b,"expand",function(){this.Ka(j)});this.Hl=ha};
t.je=function(){tw.n.je.call(this);Dk(this.eg.register("o",this.xf,this),{group:"操作",name:"显示全部/收起"})};t.Qm=function(){tw.n.Qm.call(this,{"a[name=expandQuestionDetail]":function(){vw(this,j)}})};a.vw=function(b,c){$(".feed-question-detail-item",b.g).toggleClass("question-detail-expanded",c)};a.xw=function(){lw.call(this,"column")};z(xw,lw);xw.prototype.z=function(){xw.n.z.call(this);var b=K("column",this.g);Ht(b,this.Jj,this)};xw.prototype.Jj=function(){Cu("column",this.Lh,"touch")};a.yw=function(b,c){return $.post("/node/ColumnPostVoteBarV2",{method:c,params:{post_id:b}})},a.zw=function(b,c){return $.get(c?"/node/ColumnPostFullVoteInfoV2":"/node/ColumnPostVoteInfoV2",{params:{post_id:b}})};a.Aw=function(b,c,d){T.call(this);this.pb=b;this.entryType=c||"answer";this.ud=k;this.F=$.extend({},this.defaults,d||{})};z(Aw,T);a.Bw={he:1,qg:-1,RA:0};Aw.prototype.defaults={kT:"up",kL:"down",LK:"count",Xs:"pressed"};H.extend(Aw.prototype,Bw);t=Aw.prototype;t.W=Bw.RA;
t.o=function(b){Aw.n.o.call(this,b);var c=this.F,b=this.J=$(b);this.nu=$("."+c.kT,b);this.iu=$("."+c.kL,b);this.zA=$("."+c.LK,b);c=this.nu.hasClass(this.F.Xs);b=this.iu.hasClass(this.F.Xs);c?this.W=Bw.he:b&&(this.W=Bw.qg);Cw(this);this.nu.click($.proxy(this.Tt,this));this.iu.click($.proxy(this.St,this));return this};t.Td=p("W");
t.Zb=Hm(function(b){if(b!==this.W&&H.vg(Bw,b)){this.dispatchEvent({type:"action",data:{state:b}});this.ud&&"pending"===this.ud.state()&&this.ud.abort();var c=this.W,d=+this.zA.text(),e=0;b===Bw.he?e=1:c===Bw.he&&(e=-1);this.zA.text(d+e);this.W=b;Cw(this);b={};b[Bw.he]="vote_up";b[Bw.qg]="vote_down";b[Bw.RA]="vote_neutral";this.ud=("post"===this.entryType?yw:kt)(this.pb,b[this.W]);this.ud.done(v(function(b){b.r||this.Bd()},this))}},function(b){var c={};c[Bw.he]="question_answer_vote_up";c[Bw.qg]="question_answer_vote_down";
return{na:c[b],cd:j}});t.bT=function(b){b===Bw.he?Yk("vote","voteup","side_vote"):b===Bw.qg&&Yk("vote","votedown","side_vote")};t.Tt=function(){this.Zb(this.W===Bw.qg?Bw.he:this.W^Bw.he)};t.St=function(){this.Zb(this.W===Bw.he?Bw.qg:this.W^Bw.qg)};
a.Cw=function(b){var c=b.W,d=b.F,e=c===Bw.he,c=c===Bw.qg,g=e?"取消赞同":"赞同",h=c?"取消反对":"反对，不会显示你的姓名";b.nu.toggleClass(d.Xs,e).find(".label").text(g).end().attr("aria-pressed",e).attr("title",g);b.iu.toggleClass(d.Xs,c).find(".label").text(h).end().attr("aria-pressed",c).attr("title",h)};t.Bd=function(){this.dispatchEvent("change")};a.Dw=function(b){T.call(this);this.Gp="votebar-mobile";this.Fv="votebar-mobile-dialog";this.xA=b;this.gI=L("span","_votebar-holder")};z(Dw,T);Dw.prototype.$=function(b){Dw.n.$.call(this,b);this.m().e(b,"click",this.zQ)};Dw.prototype.eL=function(){var b=this.xA;lc(b.h(),this.gI);F.remove(b.h(),this.Gp)};Dw.prototype.AO='<div class="text zg-clear"><label class="zg-left">赞同</label><label class="zg-right">反对</label></div>';
Dw.prototype.zQ=function(){this.ob&&this.ob.G();var b=new wi(k,m);b.Ih=j;b.lm(j);b.LL=j;var c=this.xA;lc(this.gI,c.h());F.add(c.h(),this.Gp);this.m().e(c,"action",function(){this.ob&&setTimeout(v(function(){this.ob.D(m)},this),150)});ne(this.m(),b,"hide",this.eL);c=b.V();c.appendChild(this.xA.h());c.appendChild(ec(this.AO));F.add(b.h(),this.Fv);b.D(j);this.ob=b;Qc(this,b)};a.Ew=function(){lw.call(this,"post")};z(Ew,lw);t=Ew.prototype;t.Dj="post-link";
t.z=function(){Ew.n.z.call(this);var b=this.It=new It;this.H(b);Qc(this,b);this.m().e(b,"expand",function(){this.Ka(j)});b.o(this.g);b.gd()&&ne(this.m(),b,"expand",this.Zx);Ht(this.g,this.Jj,this);if(b=K("zm-votebar",this.g))this.ub=new Aw(this.pb,this.entryType),Qc(this,this.ub),this.ub.o(b),(b=K("votenum-mobile",this.g))&&(new Dw(this.ub)).o(b);if(b=K("zm-item-vote-info",this.g)){var c=this.iY=new Fw(this.pb,this.entryType);Qc(this,c);c.o(b);this.ub&&this.m().e(this.ub,"change",function(){c.gi()}).e(c,
"change",function(){var b=K("zm-item-vote-count",this.g),e=$(".zm-votebar .count",this.g)[0];b&&Gk(b,c.Sa());e&&Gk(e,c.Sa())})}};t.sc=function(){Ew.n.sc.call(this,"分享文章","post",this.pb,{post_id:this.pb})};t.Ka=function(b){Ew.n.Ka.call(this,b)&&(b||bt($(".entry-body",this.g)[0]),this.It.Ka(b),this.xz(b))};t.xz=function(b){var c=this.Tn();c&&$o(c,b)};
t.Tn=function(){if(this.Hp)return this.Hp;var b=!rb,c=K("zm-editable-content",this.g),d=this.ub&&this.ub.h();b&&(d&&$(d).is(":visible")&&c&&230<$(c).height())&&(b=this.Hp=new cp(k,c),this.H(b),b.lh="votebar",b.Jy=50,b.o(d))};t.Ar=function(){$(".feed-hide-options",this.g).show().siblings().hide();$.post(Et("/post/uninterest"),{id:this.pb})};t.aE=function(){$(".feed-hide-options",this.g).hide().siblings().show();$.post(Et("/post/undo_uninterest"),{id:this.pb})};
t.RD=function(b){var b=$(b.currentTarget),c=b.data();Bi(b.attr("title"),Et("确定%s吗？",b.text()),function(b){b&&(this.SD(),$.post(Et("/%s/uninterest",c.type),{id:c.id}))},this)};
t.je=function(){Ew.n.je.call(this);Dk(this.eg.register("v",function(){this.ub&&this.ub.Tt()},this),{group:"操作",name:"赞同"});Dk(this.eg.register("d",function(){this.ub&&this.ub.St()},this),{group:"操作",name:"反对"});Dk(Dk(Dk(Dk(this.eg.register("o",this.xf,this),{group:"操作",name:"显示全部/收起"}).register("c",this.up,this),{group:"操作",name:"打开评论"}).register("f x",this.sc,this),{group:"操作",name:"分享"}).register("shift+c",this.Pw,this),{group:"操作",name:"定位到评论框"})};a.Gw=function(){lw.call(this,"roundtable")};z(Gw,lw);t=Gw.prototype;t.z=function(){Gw.n.z.call(this);this.Sn()};t.Dj="roundtable_link";t.Ar=function(){$.post("/roundtable/"+this.Lh,{action:"mute"});this.dispatchEvent({type:"ignore",key:"roundtable-id",value:this.pb})};t.Sn=function(){Ht(this.g,this.Jj,this)};t.Jj=function(){Cu("roundtable",this.Lh,"touch")};a.Hw=function(b){var c=b.getAttribute("data-type");return(c={ac:qw,p:Ew,a:tw,q:sw,r:Gw,c:xw}[c])?new c:uw(b)?new tw:new T};a.Iw=function(b,c,d){mu.call(this,b,c,d)};z(Iw,mu);Iw.prototype.Nj=function(b){var c=Hw(b);this.H(c);c.o(b);c instanceof tw&&c.Ka(m)};a.Jw=function(){N.call(this);this.ca=k;this.ka=0;this.Rx=[];this.ss=[];this.fA="最多输入 20 字";this.Dv="最多输入 256 字"};z(Jw,Im);ia(Jw);t=Jw.prototype;
t.v=function(){this.jL=j;this.g=L("div",k,[this.DO=L("div",k,[this.Ng=L("div","zm-favo-list-content"),this.fB=L("div","zh-favo-add-new-wrap zm-command",this.xS=L("a",{"class":"zm-favo-dialog-create zg-left",href:"javascript:;"},"+ 创建收藏夹"),this.hv=L("a",{href:"javascript:;","class":"zg-btn-blue"},"关闭")),this.yu=L("div","zh-favo-add-new-wrap zm-command",this.wK=L("a",{href:"javascript:;","class":""},"取消"),this.yS=L("a",{"class":"zm-favo-dialog-create zg-btn-blue",href:"javascript:;"},"创建收藏夹"))]),this.lw=
L("div",{style:"display:none"},[L("div",k,["标题",this.eA=L("span",{"class":"zh-favo-add-title-error"},"请填写标题")]),L("div","zg-section",this.Ej=L("input",{"class":"zg-form-text-input",style:"width:97%;font-size:13px"})),L("div",k,"描述（可选）"),L("div","zg-section zg-editor-simple-wrap zg-form-text-input",this.Ll=L("textarea",{"class":"zg-editor-input",style:"height:66px"})),this.aR=L("label",k,[this.pO=L("input",{type:"radio",checked:"checked",value:"public",name:"mode"}),L("strong",k," 公开 "),L("span","zg-gray-normal",
"公开后不能设置为私密")]),this.yO=L("br"),this.XQ=L("label",k,[this.oO=L("input",{type:"radio",value:"private",name:"mode"}),L("strong",k," 私密 "),L("span","zg-gray-normal","只有你可以查看这个收藏夹")]),L("div","zm-command",[this.Rz=L("a",{href:"javascript:;","class":"zg-mr10"},"取消"),this.Cq=L("a",{href:"javascript:;","class":"zg-mr10"},"完成"),this.dB=L("a",{"class":"zg-btn-blue"},"确认创建")])])]);Q(this.eA,m);Q(this.yu,m);(new dn(this.fA)).o(this.Ej);(new dn(this.Dv)).o(this.Ll);A.forEach(this.Rx,function(b){Kw(this,b)},this);
this.Rx.length||(this.Ng.innerHTML='<div id="zh-fav-list-item-place-holder" class="zg-r5px zm-fav-list-item-place-holder">你可以创建多个收藏夹，将答案分类收藏</div> ',Q(this.yu,j),Q(this.fB,m));Lw(this);this.ca.V().innerHTML="";this.ca.V().appendChild(this.g);this.ca.Y()};
a.Lw=function(b,c,d){b.ca||(b.ca=new wi(k,m),fi(b.ca,k),b.ca.Va(c||""),d&&(b.ca.V().innerHTML=d),b.m().e(b.ca,"afterhide",function(){this.Hf()}))},a.Kw=function(b,c,d){var e=J("zh-fav-list-item-place-holder");e&&Q(e,m);b.Ty=c[5]?"":L("span","zm-fav-list-item-lock",[L("i","icon icon-lock")]);e=L("span","zm-favo-list-item-title");wc(e,c[1]);e=L("a",{"class":"zg-r5px zm-favo-list-item-link",href:"javascript:;"},[b.Ty,e,L("span",{className:"meta zg-gray",innerHTML:'<span class="num">'+c[3]+'</span> 条答案 <span class="zg-bull">•</span> '+
c[4]+" 人关注"})]);b.Ty&&b.Ty.setAttribute("data-tip","s$t$私密收藏夹");e.setAttribute("data-lid",c[0]);A.contains(b.ss,c[0])&&F.add(e,"zm-favo-list-item-link-active");c=K("zm-favo-list-item-link",b.Ng);d&&c?ic(e,c):b.Ng.appendChild(e)};
t.nb=function(){this.m().e(this.Rz,"click",function(){this.ka?Mw(this,0):Nw(this)}).e(this.xS,"click",function(){W.ga({type:"ga_click_add_collection"});Mw(this,1)}).e(this.hv,"click",function(){Nw(this)}).e(this.yS,"click",function(){W.ga({type:"ga_click_add_collection"});Mw(this,1)}).e(this.wK,"click",function(){Nw(this)}).e(this.Cq,"click",function(){Nw(this)}).e(this.dB,"click",this.Ug).e(this.Ng,"click",this.cQ).e(this.Ej,"change",function(){Q(this.eA,m)})};
t.cQ=function(b){var c=Hc(b.target,"A");if(c&&!this.locked){var b=c.getAttribute("data-lid"),d=m;F.has(c,"zm-favo-list-item-link-active")?(d=j,this.nC=b):this.jC=b;c=new Vk;c.add("answer_id",this.ka);c.add("favlist_id",b);this.oz=new V(j);this.locked=j;ne(this.m(),this.oz,"complete",this.uJ);this.oz.ajax(d?"/collection/remove":"/collection/add",c.hd())}};
t.uJ=function(){this.locked=m;this.hv.innerHTML="关闭";var b=Ie(this.oz);b&&!b.r?(b=Ub("zm-favo-list-item-link",this.Ng),A.forEach(b,function(b){var d=b.getAttribute("data-lid"),e=K("num",b),g=parseInt(e.innerHTML,10);d===this.nC?(e.innerHTML=g-1+"",F.remove(b,"zm-favo-list-item-link-active")):d===this.jC&&(e.innerHTML=g+1+"",F.add(b,"zm-favo-list-item-link-active"))},this),this.jC=this.nC=k,Yk("Favorite","add_favorite")):U("添加失败: "+b.msg)};
a.Ow=function(b,c){if(b.ka!==c&&b.Ng){var d=Ub("zm-favo-list-item-link",b.Ng);A.forEach(d,function(b){F.remove(b,"zm-favo-list-item-link-active")},b)}b.ka=c};t.Oj=function(){this.nb();this.hv.innerHTML="关闭";this.ka?(Q(this.Cq,m),Mw(this,0)):(Mw(this,1),Q(this.Rz,m),this.Cq.innerHTML="取消")};t.show=function(b){b?(Pw(this),this.ca.D(j),this.Oj()):(Lw(this,"添加到收藏夹",'<div style="text-align: center; color: #999;">收藏夹加载中<i class="spinner-gray"></i></div>'),this.ca.D(j),this.rr())};
a.Rw=function(b,c,d,e){var g=J("zh-fav-head-title"),h=J("zh-fav-head-description-source"),c=c||(g?Ec(g):""),d=d||(h?Ec(h):"");b.mC=e||ih;Pw(b);b.nb();Mw(b,1);Q(b.Rz,m);b.Cq.innerHTML="取消";b.dB.innerHTML="保存";b.ca.Va("编辑收藏夹");b.Ej.value=Ya(c);b.Ll.value=Ya(d);b.mC[1]?(Q(b.aR,m),Q(b.XQ,m),Q(b.yO,m)):b.oO.setAttribute("checked",j);b.QN=Qw(b);b.ca.D(j);b.fs=j};t.rr=function(){this.ka&&$.get("/collections/json",{answer_id:this.ka}).done(v(this.TP,this))};
a.Pw=function(b){if(b.jL){var c=Ub("zm-favo-list-item-link",b.Ng);A.forEach(c,function(b){var c=b.getAttribute("data-lid");F.remove(b,"zm-favo-list-item-link-active");A.contains(this.ss,+c)&&F.add(b,"zm-favo-list-item-link-active")},b)}else b.v()};t.TP=function(b){b&&!b.r&&(this.Rx=b.msg[0],this.ss=b.msg[1],Pw(this),this.Oj())};
a.Mw=function(b,c){var d=!!c;b.ca.Va(0===c?"添加到收藏夹":"创建新收藏夹");Q(b.DO,!d);Q(b.lw,d);new mm(b.Ej,b.fA);new mm(b.Ll,b.Dv);if(1===c)$(b.lw).on("change.FavoDiag","input, textarea, select",function(){b.Ze()});else $(b.lw).off("change.FavoDiag"),b.Hf()},a.Qw=function(b){var c=new Vk,d=Jk(b.Ej.value),e=Va(b.Ll.value===b.Dv?"":b.Ll.value);e||(e=-1);c.add("title",d);c.add("description",e);c.add("is_public",b.pO.checked?1:0);return c};
t.Ug=function(){var b=Jk(this.Ej.value);if(!b||b===this.fA)Q(this.eA,j);else{b=Qw(this);this.ka&&b.add("answer_id",this.ka);if(this.fs){if(this.QN.hd()===b.hd()){Nw(this);return}b.add("favlist_id",this.mC[0])}this.xhr=new V(j);ne(this.m(),this.xhr,"complete",this.mJ);this.xhr.ajax(this.fs?"/collection/update":"/collection/create",b.hd())}};
t.mJ=function(){var b=Ie(this.xhr);b&&!b.r?this.fs?(Nw(this),U("编辑成功"),setTimeout(function(){window.location.reload()},1E3),this.fs=m):this.ka?(Q(this.yu,m),Q(this.fB,j),Mw(this,0),this.ss.push(b.msg[0]),Kw(this,b.msg,j),this.Ej.value="",this.Ll.value=""):(Nw(this),U("创建成功"),setTimeout(function(){window.location.href="/collections/mine"},1E3)):U(b.msg)};t.Q=function(){return this.ca.Q()};
a.Nw=function(b){b.ca.D(m);b.dispatchEvent(Sw);W.ga({type:"ga_click_collect_answer",data:{count:$(".zm-favo-list-item-link-active",b.Ng).length}})},a.Sw="close";Jw.prototype.Ze=function(){$(window).on("beforeunload.FavoDiag",v(s("你对收藏夹的修改还未保存，确认离开该页面吗？"),this))};Jw.prototype.Hf=function(){$(window).off("beforeunload.FavoDiag")};a.Tw=function(b){var c=b.type;if(!ka(c))return k;switch(c.toLowerCase()){case "checkbox":case "radio":return b.checked?b.value:k;case "select-one":return c=b.selectedIndex,0<=c?b.options[c].value:k;case "select-multiple":for(var c=[],d,e=0;d=b.options[e];e++)d.selected&&c.push(d.value);return c.length?c:k;default:return ka(b.value)?b.value:k}},a.Uw=function(b,c){var d=b.elements[c];if(d.type)return Tw(d);for(var e=0;e<d.length;e++){var g=Tw(d[e]);if(g)return g}return k};a.Vw=function(b){N.call(this);this.g=b;b=qa(this.g)&&1==this.g.nodeType?this.g:this.g?this.g.body:k;this.rO=!!b&&eg(b);this.aF=O(this.g,C?"DOMMouseScroll":"mousewheel",this)};z(Vw,Fd);
Vw.prototype.handleEvent=function(b){var c=0,d=0,e=0,b=b.Ub;if("mousewheel"==b.type){d=1;if(B||D&&(kb||E("532.0")))d=40;e=Ww(-b.wheelDelta,d);ka(b.wheelDeltaX)?(c=Ww(-b.wheelDeltaX,d),d=Ww(-b.wheelDeltaY,d)):d=e}else e=b.detail,100<e?e=3:-100>e&&(e=-3),ka(b.axis)&&b.axis===b.HORIZONTAL_AXIS?c=e:d=e;oa(this.oF)&&(c=vt(c,-this.oF,this.oF));oa(this.pF)&&(d=vt(d,-this.pF,this.pF));this.rO&&(c=-c);c=new Xw(e,b,c,d);this.dispatchEvent(c)};a.Ww=function(b,c){return D&&(jb||lb)&&0!=b%c?b:b/c};
Vw.prototype.w=function(){Vw.n.w.call(this);yd(this.aF);delete this.aF};a.Xw=function(b,c,d,e){c&&this.B(c,i);this.type="mousewheel";this.detail=b;this.Si=d;this.Ti=e};z(Xw,jd);a.Yw=function(){N.call(this)};z(Yw,Fd);t=Yw.prototype;t.ce=0;t.so=0;t.po=100;t.jl=0;t.ik=1;t.FE=m;t.Ds=m;t.Aa=function(b){b=Zw(this,b);this.ce!=b&&(this.ce=b+this.jl>this.po?this.po-this.jl:b<this.so?this.so:b,!this.FE&&!this.Ds&&this.dispatchEvent("change"))};t.S=function(){return Zw(this,this.ce)};t.Xo=function(b){b=Zw(this,b);this.jl!=b&&(this.jl=0>b?0:this.ce+b>this.po?this.po-this.ce:b,!this.FE&&!this.Ds&&this.dispatchEvent("change"))};
t.Qh=function(){return this.ik==k?this.jl:Math.round(this.jl/this.ik)*this.ik};t.Dc=function(){return Zw(this,this.so)};t.Sc=function(){return Zw(this,this.po)};t.Cw=p("ik");a.Zw=function(b,c){return b.ik==k?c:b.so+Math.round((c-b.so)/b.ik)*b.ik};a.$w=function(b){T.call(this,b);this.hB=k;this.Ra=new Yw;O(this.Ra,"change",this.QD,m,this)};z($w,T);a.ax=Ed("dragvaluestart"),a.bx=Ed("dragvalueend"),a.cx=Ed("dragextentstart"),a.dx=Ed("dragextentend"),a.ex=Ed("dragstart"),a.fx=Ed("dragend");t=$w.prototype;t.wb="horizontal";t.cs=m;t.bP=m;t.Cf=10;t.ro=0;t.JE=j;t.fc=j;t.Pd=m;t.v=function(){$w.n.v.call(this);var b=this.K().v("div",this.M(this.wb));this.$(b)};
t.$=function(b){$w.n.$.call(this,b);F.add(b,this.M(this.wb));var b=this.h(),c=Tb(k,"goog-slider-thumb",b)[0];c||(c=this.K().v("div","goog-slider-thumb"),Lc(c,Uc.Pp),b.appendChild(c));this.Wa=this.wd=c;Lc(this.h(),Uc.UI);gx(this)};t.z=function(){$w.n.z.call(this);this.be=new vh(this.Wa);this.Nf=new vh(this.wd);this.be.Jf(this.Pd);this.Nf.Jf(this.Pd);this.be.Av=this.Nf.Av=ha;this.lb=new fj(this.h());hx(this,j);this.h().tabIndex=0;ix(this)};
a.hx=function(b,c){c?(b.m().e(b.be,"beforedrag",b.tr).e(b.Nf,"beforedrag",b.tr).e(b.be,["start","end"],b.Er).e(b.Nf,["start","end"],b.Er).e(b.lb,"key",b.ef).e(b.h(),"mousedown",b.kj),b.JE&&jx(b,j)):(b.m().Fa(b.be,"beforedrag",b.tr).Fa(b.Nf,"beforedrag",b.tr).Fa(b.be,["start","end"],b.Er).Fa(b.Nf,["start","end"],b.Er).Fa(b.lb,"key",b.ef).Fa(b.h(),"mousedown",b.kj),b.JE&&jx(b,m))};t.hb=function(){$w.n.hb.call(this);Rc(this.be,this.Nf,this.lb,this.Kj)};
t.tr=function(b){var c=b.Xq==this.be?this.Wa:this.wd,d;"vertical"==this.wb?(d=this.h().clientHeight-c.offsetHeight,d=(d-b.top)/d*(this.Sc()-this.Dc())+this.Dc()):d=b.left/(this.h().clientWidth-c.offsetWidth)*(this.Sc()-this.Dc())+this.Dc();d=b.Xq==this.be?Math.min(Math.max(d,this.Dc()),this.S()+this.Qh()):Math.min(Math.max(d,this.S()),this.Sc());kx(this,c,d)};
t.Er=function(b){var c="start"==b.type;F.enable(this.h(),"goog-slider-dragging",c);F.enable(b.target.handle,"goog-slider-thumb-dragging",c);b=b.Xq==this.be;c?(this.dispatchEvent(ex),this.dispatchEvent(b?ax:cx)):(this.dispatchEvent(fx),this.dispatchEvent(b?bx:dx))};
t.ef=function(b){var c=j;switch(b.keyCode){case 36:lx(this,this.Dc());break;case 35:lx(this,this.Sc());break;case 33:mx(this,this.Cf);break;case 34:mx(this,-this.Cf);break;case 37:var d=this.Pd&&this.zd()?1:-1;mx(this,b.shiftKey?d*this.Cf:d*this.Ap);break;case 40:mx(this,b.shiftKey?-this.Cf:-this.Ap);break;case 39:d=this.Pd&&this.zd()?-1:1;mx(this,b.shiftKey?d*this.Cf:d*this.Ap);break;case 38:mx(this,b.shiftKey?this.Cf:this.Ap);break;default:c=m}c&&b.preventDefault()};
t.kj=function(b){this.h().focus&&this.h().focus();var c=b.target;!rc(this.Wa,c)&&!rc(this.wd,c)&&(this.bP?lx(this,nx(this,b)):(this.Vz(b),this.Ne=ox(this,nx(this,b)),this.qE="vertical"==this.wb?this.ms<this.Ne.offsetTop:this.ms>px(this,this.Ne)+this.Ne.offsetWidth,b=Qb(this.h()),this.m().e(b,"mouseup",this.Sz,j).e(this.h(),"mousemove",this.Vz),this.Wh||(this.Wh=new Hd(200),this.m().e(this.Wh,Id,this.WD)),this.WD(),this.Wh.start()))};t.LD=function(b){mx(this,(0<b.detail?-1:1)*this.Ap);b.preventDefault()};
t.WD=function(){var b;if("vertical"==this.wb){var c=this.ms,d=this.Ne.offsetTop;this.qE?c<d&&(b=qx(this,this.Ne)+this.Cf):c>d+this.Ne.offsetHeight&&(b=qx(this,this.Ne)-this.Cf)}else c=this.ms,d=px(this,this.Ne),this.qE?c>d+this.Ne.offsetWidth&&(b=qx(this,this.Ne)+this.Cf):c<d&&(b=qx(this,this.Ne)-this.Cf);ka(b)&&kx(this,this.Ne,b)};t.Sz=function(){this.Wh&&this.Wh.stop();var b=Qb(this.h());this.m().Fa(b,"mouseup",this.Sz,j).Fa(this.h(),"mousemove",this.Vz)};
a.rx=function(b,c){var d=jg(c,b.h());return"vertical"==b.wb?d.y:b.Pd&&b.zd()?b.h().clientWidth-d.x:d.x};t.Vz=function(b){this.ms=rx(this,b)};
a.nx=function(b,c){var d=b.Dc(),e=b.Sc();if("vertical"==b.wb){var g=b.Wa.offsetHeight,h=b.h().clientHeight-g,g=rx(b,c)-g/2;return(e-d)*(h-g)/h+d}g=b.Wa.offsetWidth;h=b.h().clientWidth-g;g=rx(b,c)-g/2;return(e-d)*g/h+d},a.qx=function(b,c){if(c==b.Wa)return b.Ra.S();if(c==b.wd)return b.Ra.S()+b.Ra.Qh();f(Error("Illegal thumb element. Neither minThumb nor maxThumb"))},a.mx=function(b,c){var d=qx(b,b.Wa)+c,e=qx(b,b.wd)+c,d=vt(d,b.Dc(),b.Sc()-b.ro),e=vt(e,b.Dc()+b.ro,b.Sc());sx(b,d,e-d)},a.kx=function(b,
c,d){var e=k;c==b.wd&&(d<=b.Ra.Sc()&&d>=b.Ra.S()+b.ro)&&(e=d-b.Ra.S());var g=e||b.Ra.Qh();c==b.Wa&&(d>=b.Dc()&&d<=b.Ra.S()+g-b.ro)&&(c=g-(d-b.Ra.S()),Zw(b.Ra,d)+Zw(b.Ra,c)==Zw(b.Ra,d+c)&&(sx(b,d,c),e=k));e!=k&&b.Ra.Xo(e)},a.sx=function(b,c,d){b.Dc()<=c&&(c<=b.Sc()-d&&b.ro<=d&&d<=b.Sc()-c)&&!(c==b.S()&&d==b.Qh())&&(b.Ra.Ds=j,b.Ra.Xo(0),b.Ra.Aa(c),b.Ra.Xo(d),b.Ra.Ds=m,b.QD())};t.Dc=function(){return this.Ra.Dc()};t.Sc=function(){return this.Ra.Sc()};
a.ox=function(b,c){return c<=b.Ra.S()+b.Ra.Qh()/2?b.Wa:b.wd};t.QD=function(){ix(this);gx(this);this.dispatchEvent("change")};
a.ix=function(b){if(b.Wa&&!b.cs){var c=tx(b,qx(b,b.Wa)),d=tx(b,qx(b,b.wd));if("vertical"==b.wb)b.Wa.style.top=c.y+"px",b.wd.style.top=d.y+"px",b.Lb&&(c=ux(d.y,c.y,b.Wa.offsetHeight),b.Lb.style.top=c.offset+"px",b.Lb.style.height=c.size+"px");else{var e=b.Pd&&b.zd()?"right":"left";b.Wa.style[e]=c.x+"px";b.wd.style[e]=d.x+"px";b.Lb&&(c=ux(c.x,d.x,b.Wa.offsetWidth),b.Lb.style[e]=c.offset+"px",b.Lb.style.width=c.size+"px")}}},a.ux=function(b,c,d){var e=Math.ceil(d/2);return{offset:b+e,size:Math.max(c-
b+d-2*e,0)}},a.tx=function(b,c){var d=new Kb;if(b.Wa){var e=b.Dc(),g=b.Sc(),g=c==e&&e==g?0:(c-e)/(g-e);"vertical"==b.wb?(e=b.h().clientHeight-b.Wa.offsetHeight,g=Math.round(g*e),d.x=px(b,b.Wa),d.y=e-g):(e=Math.round(g*(b.h().clientWidth-b.Wa.offsetWidth)),d.x=e,d.y=b.Wa.offsetTop)}return d},a.lx=function(b,c){c=vt(c,b.Dc(),b.Sc());b.cs&&b.Mq.stop(j);var d=new jq,e,g=ox(b,c),h=b.S(),l=b.Qh(),n=qx(b,g),q=tx(b,n);e=b.Cw();Math.abs(c-n)<e&&(c=vt(n+(c>n?e:-e),b.Dc(),b.Sc()));kx(b,g,c);n=tx(b,qx(b,g));
e="vertical"==b.wb?[px(b,g),n.y]:[n.x,g.offsetTop];q=new ot(g,[q.x,q.y],e,100);q.Jf(b.Pd);d.add(q);if(b.Lb){var q=tx(b,h),r=tx(b,h+l),l=q;e=r;g==b.Wa?l=n:e=n;"vertical"==b.wb?(g=ux(r.y,q.y,b.Wa.offsetHeight),l=ux(e.y,l.y,b.Wa.offsetHeight),n=new ot(b.Lb,[px(b,b.Lb),g.offset],[px(b,b.Lb),l.offset],100),g=new mt(b.Lb,g.size,l.size,100)):(g=ux(q.x,r.x,b.Wa.offsetWidth),l=ux(l.x,e.x,b.Wa.offsetWidth),n=new ot(b.Lb,[g.offset,b.Lb.offsetTop],[l.offset,b.Lb.offsetTop],100),g=new nt(b.Lb,g.size,l.size,100));
n.Jf(b.Pd);g.Jf(b.Pd);d.add(n);d.add(g)}b.hB&&(h=b.hB.wW(h,c,100),A.forEach(h,function(b){d.add(b)}));b.Mq=d;b.m().e(d,"end",b.tL);b.cs=j;d.play(m)};t.tL=function(){this.cs=m};t.$o=function(b){if(this.wb!=b){var c=this.M(this.wb),d=this.M(b);this.wb=b;this.h()&&(F.xH(this.h(),c,d),b=this.Pd&&this.zd()?"right":"left",this.Wa.style[b]=this.Wa.style.top="",this.wd.style[b]=this.wd.style.top="",this.Lb&&(this.Lb.style[b]=this.Lb.style.top="",this.Lb.style.width=this.Lb.style.height=""),ix(this))}};
t.w=function(){$w.n.w.call(this);this.Wh&&this.Wh.G();delete this.Wh;this.Mq&&this.Mq.G();delete this.Mq;delete this.Wa;delete this.wd;this.Lb&&delete this.Lb;this.Ra.G();delete this.Ra;this.lb&&(this.lb.G(),delete this.lb);this.Kj&&(this.Kj.G(),delete this.Kj);this.be&&(this.be.G(),delete this.be);this.Nf&&(this.Nf.G(),delete this.Nf)};t.Ap=1;t.Cw=function(){return this.Ra.Cw()};t.S=function(){return this.Ra.S()};t.Aa=function(b){kx(this,this.Wa,b)};t.Qh=function(){return this.Ra.Qh()};
t.Xo=function(b){kx(this,this.wd,this.Ra.S()+b)};t.D=function(b){Q(this.h(),b);b&&ix(this)};a.gx=function(b){var c=b.h();if(c){var d=b.Dc();Mc(c,Tc.bJ,d);d=b.Sc();Mc(c,Tc.aJ,d);b=b.S();Mc(c,Tc.cJ,b)}},a.jx=function(b,c){c?(b.Kj||(b.Kj=new Vw(b.h())),b.m().e(b.Kj,"mousewheel",b.LD)):b.m().Fa(b.Kj,"mousewheel",b.LD)};t.Za=function(b){if(this.fc!=b&&this.dispatchEvent(b?"enable":"disable"))this.fc=b,hx(this,b),b||this.Sz(),F.enable(this.h(),"goog-slider-disabled",!b)};t.isEnabled=p("fc");
a.px=function(b,c){return b.Pd?uh(c):c.offsetLeft};a.vx=function(b){$w.call(this,b);this.Ra.Xo(0)};z(vx,$w);vx.prototype.M=function(b){return"vertical"==b?"goog-slider-vertical":"goog-slider-horizontal"};a.wx=function(b){this.options=$.extend({},this.defaults,b)};z(wx,T);t=wx.prototype;t.defaults={ZB:310,$B:310,mg:250,ng:250,TO:2,opacity:0.25,jY:"#eee"};t.$=function(b){wx.n.$.call(this,b);this.src=this.g.src;this.options.src=this.src;this.options.Cm=(this.options.ZB-this.options.mg)/2;this.options.Bm=(this.options.$B-this.options.ng)/2;this.Jq()};
t.Jq=function(){var b=this.options;this.yA=$($k('            <div class="avatar-editor-container" style="width:<%=containerWidth%>px">              <div class="avatar-editor-container-inner" style="height:<%=containerHeight%>px;">                <div class="avatar-editor-window" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;margin:<%=windowMarginTop%>px <%=windowMarginLeft%>px;">                  <div class="avatar-editor-window-shadow" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;"></div>                  <div class="avatar-editor-window-inner" style="width:<%=containerWidth%>px; height:<%=containerHeight%>px;margin:-<%=windowMarginTop%>px 0 0 -<%=windowMarginLeft%>px;">                    <img class="inner" title="拖动相片"/>                  </div>                </div>                <img class="outer" style="opacity:<%=opacity%>;"/>              </div>              <div class="goog-slider-wrap">                  <i class="zg-icon image-minus"></i>                  <i class="zg-icon image-plus"></i>                  <div class="goog-slider">                      <div class="line"></div>                      <div class="goog-slider-thumb"></div>                  </div>              </div>            </div>',{containerWidth:b.$B,
containerHeight:b.ZB,windowHeight:b.mg,windowWidth:b.ng,windowMarginTop:b.Cm,windowMarginLeft:b.Bm,src:b.src,opacity:b.opacity}));this.Tb=this.yA[0];this.yA.insertBefore(this.g);Q(this.g,m);this.JK=K("avatar-editor-container-inner",this.Tb);this.Qr=K("outer",this.Tb);this.ix=K("inner",this.Tb);this.Dm=$(this.Qr);this.ju=$(this.ix);this.oE=0;this.Dm.load(v(this.RH,this));this.ju.load(v(this.RH,this));this.ix.src=this.Qr.src=this.options.src;this.rS=K("goog-slider",this.Tb)};
t.z=function(){this.Mz=new vx;this.Mz.o(this.rS);this.m().e(this.JK,["mousedown","touchstart"],function(b){var c=new vh(this.Tb);c.addEventListener("drag",v(function(b){var c=this.zoom;this.De={Ip:this.options.ng/c,Cn:this.options.mg/c,x:(this.options.Bm-(this.wE.left+(b.clientX-this.Dt)))/c,y:(this.options.Cm-(this.wE.top+(b.clientY-this.Et)))/c};xx(this)},this));c.addEventListener("end",v(function(){c.G()},this));c.zm(b);this.zm(b)});this.m().e(this.Tb,["touchmove"],function(b){b.stopPropagation();
b.preventDefault()});this.m().e(this.Mz,"change",function(){var b=this.Mz.S(),c=this.qI;yx(this,(this.ET-c)*b/100+c)})};a.yx=function(b,c){b.pX=b.zoom;b.zoom=c;zx(b,b.De.Ip/2+b.De.x,b.De.Cn/2+b.De.y)},a.zx=function(b,c,d){var e=b.zoom;b.De={Ip:b.options.ng/e,Cn:b.options.mg/e,x:c-b.options.ng/e/2,y:d-b.options.mg/e/2};xx(b)};t.RH=function(){this.PN||(this.ix.complete&&this.Qr.complete?this.B():(this.oE++,2<=this.oE&&this.B()))};
t.B=function(){this.Pr=this.Dm.width();this.Or=this.Dm.height();var b=this.options.ng/this.Pr,c=this.options.mg/this.Or;this.qI=b=c>b?c:b;this.ET=this.qI*this.options.TO;this.De={Cn:this.options.ng/b,Ip:this.options.mg/b,x:0,y:0};yx(this,b);zx(this,this.Pr/2,this.Or/2);this.PN=j};t.zm=function(b){this.Dt=b.clientX;this.Et=b.clientY;this.wE=this.ju.position();this.IX=this.Dm.position()};
a.xx=function(b){var c=b.zoom,d=vt(b.options.Bm-b.De.x*c,b.options.ng+b.options.Bm-b.Pr*c,b.options.Bm),e=vt(b.options.Cm-b.De.y*c,b.options.mg+b.options.Cm-b.Or*c,b.options.Cm),g={width:c*b.Pr,height:c*b.Or,left:d,top:e};b.Dm.css(g);b.ju.css(g);b.De.x=(b.options.Bm-d)/c;b.De.y=(b.options.Cm-e)/c};t.support=function(){return"getContext"in document.createElement("canvas")};a.Bx=function(b,c,d){T.call(this);this.iq=b||Ax;this.SC=c;this.UG=d||"l"};z(Bx,T);a.Ax=1;t=Bx.prototype;t.$=function(b){this.g=b;this.v()};
t.v=function(){this.qA="http://upload."+bh.fm+"/upload_avatar";this.yk=$($k('            <form target="av_up_frame" style="display:none;" method="post" enctype="multipart/form-data" action="<%=uploadAction%>">                <label for="avt_file"></label>                <input type="file" accept="image/*" name="picture" id="avt_file" />                <input type="hidden" name="handle_mode" value="upload" />                <input type="hidden" name="type" value="<%=type%>" />                <input type="hidden" name="dest_id" value="<%=dest_id%>" />                <input type="hidden" name="return_size" value="<%=return_size%>" />            </form>',{uploadAction:this.qA,
type:this.iq,dest_id:this.iq===Ax?S[3]:this.SC,return_size:this.UG}));this.tI=$('<iframe id="av_up_frame" name="av_up_frame" style="position: absolute; height: 0px; width: 0px; left: -9000px;"></iframe>');this.tI.appendTo(document.body);this.input=this.yk.find("input[type=file]")[0];B?(this.yk.find("label").html($(this.g).html()),this.g.innerHTML="",$(this.g).append(this.yk),this.yk.addClass("avatar-editor-form-ie")):(this.yk.insertAfter(this.g),$(this.g).click($.proxy(function(){this.input.click()},
this)));this.m().e(this.input,"change",this.Bd).e(this.input,"click",function(b){this.dispatchEvent("beforeopen")===m&&b.preventDefault()});this.m().e(W,"iframe_data",function(b){(b=b.Ic)&&!b.r?"upload"===b.handle_mode?(this.Gl=b.url,this.hx=b.id,Cx()||this.Eo()):"resize"===b.handle_mode&&($(this.g).find("form").remove(),this.gC(b)):U(b.msg)})};a.Cx=function(){return!!window.FileReader};
t.Bd=function(b){this.Gl=this.hx=this.qj="";if(this.xa)this.xa.Y();else{this.xa=new wi(k,m);this.xa.Va("修改图片");var c=ji.yI,d=ji.dJ,e=new bi;e.set(c,"取消",m,j).set(d,"确定",j);fi(this.xa,e);this.m().e(this.xa,gi,function(b){if(b.key===d){if(Cx()){var c=this.sv,b=$("<canvas></canvas>");b.attr("width",c.options.ng);b.attr("height",c.options.mg);var e=b[0];$(document.body).append(e);var n=b[0].getContext("2d"),q=c.De;n.drawImage(c.Qr,q.x,q.y,q.Ip,q.Cn,0,0,c.options.ng,c.options.mg);c=e.toDataURL("image/png");
b.remove();b=c}else b=this.sv.De;if((this.qj=b)&&(Cx()||this.hx))if(this.dispatchEvent("beforepost"),b={type:this.iq,dest_id:this.iq===Ax?S[3]:this.SC,return_size:this.UG},Cx()){var r=new FormData;r.append("handle_mode","upload");r.append("picture",Dx(this.qj.replace(/data\:image\/\w{3,4};base64,/,"")),this.file.name);$.each(b,function(b,c){r.append(b,c)});$.ajax({url:this.qA,data:r,method:"post",processData:m,contentType:m,success:$.proxy(this.gC,this),dataType:"json",xhrFields:{withCredentials:j},
crossDomain:j})}else{var b=$.extend(b,{handle_mode:"resize",x:Math.round(this.qj.x),y:Math.round(this.qj.y),height:Math.round(this.qj.Cn),width:Math.round(this.qj.Ip),hashval:this.hx}),w='<form target="av_up_frame" style="display:none;" method="post" action="'+this.qA+'">';$.each(b,function(b,c){w+='<input type="hidden" name="'+b+'" value="'+c+'" />'});w+="</form>";b=$(w);b.appendTo(this.g);b[0].submit()}this.xa.D(m);return m}})}e=this.xa.V();c=$("<div class='new-avatar-editor-loading'><div><span></span></div><div>正在上传...</div></div>");
e=$(e);e.html("");e.append(c);this.xa.D(j);F.add(this.xa.g,"avatar-edit-dialog");b=this.input=b.target;Cx()?b.files&&b.files[0]&&(this.file=b=b.files[0],c=new window.FileReader,c.onload=v(function(b){this.Gl=b.target.result;this.Eo()},this),c.readAsDataURL(b)):this.yk[0].submit();b=this.input.cloneNode();lc(b,this.input);this.input=b;this.m().e(this.input,"change",this.Bd)};t.Eo=function(){var b=this.xa.V();this.gx=new Image;this.gx.src=this.Gl;b=$(b);b.html("");b.append(this.gx);this.sv=new wx;this.sv.o(this.gx)};
t.gC=function(b){b&&!b.r?this.data=b:U(b.msg);this.dispatchEvent({type:"success",src:this.data});this.xa.D(m)};t.getData=function(){return this.data||k};a.Dx=function(b){var c,d;d="image/png";c=c||512;for(var b=atob(b),e=[],g=0;g<b.length;g+=c){for(var h=b.slice(g,g+c),l=Array(h.length),n=0;n<h.length;n++)l[n]=h.charCodeAt(n);h=new Uint8Array(l);e.push(h)}return new Blob(e,{type:d})};a.Ex=function(){T.call(this)};z(Ex,T);Ex.prototype.$=function(b){Ex.n.$.call(this,b);this.m().e(W,"sina_callback",this.Js);this.m().e(W,"qqconn_callback",this.Js);this.m().e(J("zh-setting-page-bind-sina-unbindbtn"),"click",this.fG);this.m().e(J("zh-setting-page-bind-qqconn-unbindbtn"),"click",this.fG)};
Ex.prototype.Js=function(b){if("sina_callback"===b.type){var c=ph.name=b.Ic.name,b=ph.id=b.Ic.id;J("zh-setting-page-bind-sinaname").innerHTML='<a href="http://weibo.com/'+b+'" target="_blank">@'+c+"</a>";Fx(j)}else"qqconn_callback"===b.type&&(J("zh-setting-page-bind-qqconnname").innerHTML=b.Ic.name,Gx(j))};
Ex.prototype.fG=function(b){var c=b.target.getAttribute("data-weibotype");if(window.confirm("你确定要解除与"+{sina:"新浪微博",qqconn:" QQ "}[c]+"的绑定吗？")){var d=new V(j);ne(this.m(),d,"success",function(){var b=Ie(d);b&&!b.r?"sina"===c?Fx():"qqconn"===c&&Gx():U(b.msg)});d.ajax("/oauth/unbind/"+c)}};
a.Fx=function(b){Q(J("zh-setting-page-bind-sina-binded-wrap"),!!b);Q(J("zh-setting-page-bind-sina-tobind-wrap"),!b)},a.Gx=function(b){Q(J("zh-setting-page-bind-qqconn-binded-wrap"),!!b);Q(J("zh-setting-page-bind-qqconn-tobind-wrap"),!b)};a.Hx=function(b){T.call(this);this.KQ=b};z(Hx,T);t=Hx.prototype;t.$=function(b){Hx.n.$.call(this,b);this.ge=$("input",b);this.rd=$(".zm-profile-details-items",this.g);this.Tp=[];var c=this;c.Tp=this.ge.map(function(){var b=new Ix("/topic/autocomplete",this,c.KQ||$(this).parents(".topic-input-wrap")[0]);b.Mm=m;var e=v(c.filter,c);b.filter=e;return b});this.em()};
t.z=function(){this.m().e(K("add",this.g),"click",this.add);var b=this;this.ge.each(function(){b.m().e(this,"keydown",function(b){this.keydown(b)})});A.forEach(this.Tp,function(c){b.m().e(c.L,ol,b.select)});this.rd.on("click","[name='del']",$.proxy(this.remove,this));this.em()};t.em=function(){if(!bh.uc){var b=this;this.If&&this.If.G();var c=new xs;c.Yq="profile-edit-item-moving";ys(c,this.rd[0],0);c.B();this.If=c;$('a, input, [role="button"]',this.rd).each(function(){b.m().e(this,"mousedown",function(b){b.stopPropagation()})})}};
t.keydown=function(b){13===b.keyCode&&setTimeout(v(function(){Jx(this)&&this.add();this.ge[0].value&&(this.ge[1]&&!this.ge[1].value)&&this.ge[1].focus()},this));return j};a.Jx=function(b){return A.every(b.ge,function(b){return!!b.value})},a.Kx=function(b){A.forEach(b.ge,function(b){b.value=""});b.ge[0].focus()};t.select=function(){Jx(this)&&this.add()};
t.add=function(){var b=Ma(this.ge[0].value),c={title:b,member_url_token:hh["1"]};if(this.ge[1]){var d=Ma(this.ge[1].value);if(!b&&!d)return;c.sub_title=d}Es("ProfileEditItemV2",c,this.lP,this)};t.lP=function(b){var b=$(b),c;if(b.data("title")){if(c=this.rd.find("[data-title='"+b.data("title")+"']")[0]){Ok(c);Kx(this);return}}else if(b.data("sub-title")&&(c=this.rd.find("[data-sub-title='"+b.data("sub-title")+"']")[0])){Ok(c);Kx(this);return}this.rd.append(b);this.em();Kx(this);this.dispatchEvent("add")};
t.remove=function(b){$(b.target).parents("li").remove();this.dispatchEvent("remove")};Hx.prototype.filter=function(b){return A.filter(b,function(b){return!this.rd.find("[data-title='"+b+"']")[0]},this)};a.Ix=function(b,c,d,e,g){this.Fe=b=new bm(b,!g);d=new fm(d);e=new Bl(k,k,!!e,300);rl.call(this,b,d,e);e.Z=this;e.Ik(c);(e=c.getAttribute("placeholder"))&&new mm(c,e)};z(Ix,lm);
Ix.prototype.dm=function(b,c){b=b[0].slice(1);b=A.filter(b,function(b){return 3<b.length});b=A.map(b,function(b){return b[1]});this.filter&&(b=this.filter(b));Ix.n.dm.call(this,b,c)};a.Lx=function(){T.call(this)};z(Lx,T);t=Lx.prototype;
t.$=function(b){Lx.n.$.call(this,b);if(b=K("profile-edit-avatar-btn")){var c=this.Nu=new Bx(Ax);c.o(b);this.m().e(this.Nu,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.m().e(this.Nu,"success",function(){$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:c.getData().id}}},function(b){b&&b.r?($(".avatar-edit-preview-loading").remove(),U("更新失败")):($(".avatar-edit-preview-loading").remove(),
$("img.zm-avatar-editor-preview").attr("src",c.getData().url))})})}this.T=[];var d=this;$(".editable-group",this.g).each(function(){var b=new Hx;d.T.push(b);b.o(this)});b=J("zm-profile-edit-submit");this.m().e(b,"click",this.zy);(new Ex).o(this.g);$(this.g).on("change","input, textarea, select",function(){d.Ze()})};
t.z=function(){Lx.n.z.call(this);var b=J("zm-profile-progress-anim"),c=new Mx;c.addEventListener("update",function(){var d=100*c.S()|0;10>d&&(d=10);b.style.width=b.innerHTML=d+"%"});A.forEach(this.T,function(b,d){c.watch({name:"name"+d,target:b,Mh:["add","remove"],Ch:function(){return!!b.rd.children().length}})},this);var d=this.g,e=J("zm-profile-edit-male"),g=J("zm-profile-edit-female"),h=J("zm-profile-edit-description"),l=$(".business-selection select")[0],n=J("zm-profile-edit-expert-disable");
c.watch({name:"expert_progress",target:J("zm-profile-edit-expert-enable"),Mh:["change"],Ch:function(){return k!==Uw(d,"enable_expert")}}).watch({name:"expert_progress",target:n,Mh:["change"],Ch:function(){return k!==Uw(d,"enable_expert")}}).watch({name:"gender_progress",target:e,Mh:["change"],Ch:function(){return k!==Uw(d,"gender")}}).watch({name:"gender_progress",target:g,Mh:["change"],Ch:function(){return k!==Uw(d,"gender")}}).watch({name:"desc_progress",target:h,Mh:["blur"],Ch:function(){return!!Ma(h.value)}}).watch({name:"business_progress",
target:h,Mh:["blur"],Ch:function(){return!!Ma(h.value)}}).watch({name:"headline_progress",target:l,Mh:["blur"],Ch:function(){return!!Ma(l.value)}})};t.Ze=function(){$(window).on("beforeunload.profileedit",v(s("你的更改还未保存，确认离开该页面吗？"),this))};t.Hf=function(){$(window).off("beforeunload.profileedit")};
t.zy=function(){function b(b){U(la(b)?b[0][1]:b)}var c=$("#zm-profile-edit-male").is(":checked")?1:0,d=$("#zm-profile-edit-headline").val(),e=$("#zm-profile-edit-description").val(),g=$(".business-selection select").val(),h=[];$("#zm-profile-edit-loc-container").children().each(function(){h.push($(this).data("title"))});var l=[];$("#zm-profile-edit-co-container").children().each(function(){var b=$(this);l.push([b.data("title"),b.data("sub-title")||""])});var n=[];$("#zm-profile-edit-edu-container").children().each(function(){var b=
$(this);n.push([b.data("title"),b.data("sub-title")||""])});var q=$("#zm-profile-edit-weibo-enable").is(":checked")?1:0,r=$("#zm-profile-edit-expert-enable").is(":checked")?1:0,c=H.filter({gender:c,headline:d,description:e,location:h,business:g,employment:l,education:n,enable_weibo:q,enable_expert:r},as),w=v(function(){this.Hf();window.location.href="/people/"+S[1]+"/about"},this),d=new V(j);d.addEventListener("complete",function(){var c;try{c=Ie(this)}catch(d){}c&&!c.r&&pa(w)?w.call(this,c):pa(b)&&
b.call(this,c.msg)});d.ajax("/people/edit","data="+encodeURIComponent(Yc(c)))};a.Mx=function(){this.My={}};z(Mx,Fd);Mx.prototype.update=function(b,c){this.My[b]=c;this.dispatchEvent({type:"update"});return this};Mx.prototype.watch=function(b){var c=v(function(){this.update(b.name,b.Ch())},this);O(b.target,b.Mh,c);c();return this};Mx.prototype.S=function(){var b=H.Ma(this.My);return b.length&&A.filter(b,Boolean).length/b.length};a.Nx=function(){this.Yi="editing";T.call(this)};z(Nx,T);Nx.prototype.$=function(b){Nx.n.$.call(this,b);this.J=$(b);this.J.on("click",'a[href^="javascript"]',$.proxy(this.ua,this));this.J.on("click",'a[href^="javascript"], input',m);this.J.on("click",".item",$.proxy(this.yQ,this))};a.Ox=function(b,c,d){if(!bh.uc||navigator.userAgent.match(/iPad/i)!=k)b=$(".item",b.J).index(c),c.siblings().eq(b-b%2).height(d?"auto":c.height())};
Nx.prototype.yQ=function(b){var c=$(b.currentTarget),d=c.data("href"),c=d&&!c.hasClass(this.Yi),b=b.metaKey||b.ctrlKey;c&&(b?window.open(d):location.href=d)};
Nx.prototype.ua=function(b){var c=$(b.currentTarget),d=c.closest(".item"),b=c.attr("name");if("edit"===b)c.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.Yi).closest(".skilled-topics").addClass(this.Yi),Ox(this,d);else if("cancel"===b)c.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.Yi).closest(".skilled-topics").removeClass(this.Yi),Ox(this,d,j);else if("save"===b){var e=
new V(j);this.m().e(e,"success",function(){var b=Ie(e);b.r?U(b.msg):(c.closest(".description-edit").hide().siblings(".description").show().children(".des").text(b.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("修改").closest(".item").removeClass(this.Yi).closest(".skilled-topics").removeClass(this.Yi),Ox(this,d,j))});e.ajax("/topic/bio/update","tid="+c.closest(".item").data("id")+"&bio="+c.parent().siblings("input").val(),"POST")}};a.Px=function(){T.call(this)};z(Px,T);
Px.prototype.$=function(b){Px.n.$.call(this);if(b&&(this.J=$(b),$(".editable-group",this.J).each(function(){(new Qx).o(this)}),(b=J("profile-header-description-input"))&&new Pm(b),(b=K("zm-profile-header-avatar-container"))&&F.has(b,"self"))){var c=new Bx(Ax);c.o(b);this.m().e(c,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.m().e(c,"success",function(){$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:c.getData().id}}},
function(b){b&&b.r?($(".avatar-edit-preview-loading").remove(),U("更新失败")):($(".avatar-edit-preview-loading").remove(),K("zm-avatar-editor-preview").src=c.getData().url)})})}};a.Qx=function(){T.call(this)};z(Qx,T);Qx.prototype.$=function(b){Qx.n.$.call(this);this.J=$(b);this.ee=$(".info-wrap",this.J);this.Hd=$(".edit-wrap",this.J);this.HT=$(".title",this.ee);this.GT=$("input",this.Hd)};
Qx.prototype.z=function(){Qx.n.z.call(this);this.J.on("click","[name='edit']",$.proxy(function(){this.J.addClass("editing");var b=this.Hd.find("input").get(0);b?b.focus():(b=this.Hd.find("textarea").get(0))&&b.focus()},this));var b=this;this.Tp=[];$("input[type=text]",this.J).each(function(){var c=new Ix("/topic/autocomplete",this,$(this).parents(".topic-input-wrap")[0]);b.Tp.push(c)});this.Hd.on("keydown","input",function(b){13===b.keyCode&&setTimeout(function(){var c=$(b.target),g=c.parents(".edit-wrap").children().index(c.parent()),
h=c.parents(".edit-wrap").find("input, select").get(g+1),g=c.parents(".edit-wrap").find("input, select").get(g-1);c.val()&&(h?h.focus():g&&!$(g).val()&&g.focus())})});this.Hd.on("click","[name='cancel'], [name='save']",$.proxy(function(b){b=b.target.name;"cancel"===b?this.cancel():"save"===b&&this.save()},this));var c=$(".fold-wrap");c.click(function(b){"fold"===b.target.name?c.addClass("fold"):"unfold"===b.target.name&&c.removeClass("fold")})};
Qx.prototype.save=function(){var b=this,c=this.J.data("name");if("location"===c){var c=this.Hd.find("input.location"),d=this.Hd.find("select"),e=this.Hd.find("input.male").is(":checked")?1:0;$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{location:[c.val()],business:d.val(),gender:e}}},function(c){c&&c.r?U(c.msg):(c=c.msg,c.location[0].html||(c.location[0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写居住地</a>"),c.business.html||(c.business.html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写行业</a>"),
b.ee.find("span.location").attr("title",c.location[0].text).html(c.location[0].html),b.ee.find("span.business").attr("title",c.business.text).html(c.business.html),c=1===parseInt(c.gender,10)?"male":"female",b.ee.find("span.gender i").removeClass("icon-profile-female icon-profile-male").addClass("icon-profile-"+c),b.cancel())})}else"employment"===c?(d=this.Hd.find("input.employment"),c=this.Hd.find("input.position"),d=d.val(),c=c.val(),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{employment:[[d,
c]]}}},function(c){c&&c.r?U(c.msg):(c=c.msg,!c.employment[0][0].text&&!c.employment[0][1].text?b.J.addClass("empty"):b.J.removeClass("empty"),c.employment[0][0].html||(c.employment[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写公司信息</a>"),c.employment[0][1].html||(c.employment[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写职位</a>"),b.ee.find(".employment").attr("title",c.employment[0][0].text).html(c.employment[0][0].html),b.ee.find(".position").attr("title",
c.employment[0][1].text).html(c.employment[0][1].html),b.cancel())})):"education"===c?(d=[this.Hd.find("input.education"),this.Hd.find("input.education-extra")],c=d[0].val(),d=d[1].val(),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{education:[[c,d]]}}},function(c){c&&c.r?U(c.msg):(c=c.msg,!c.education[0][0].text&&!c.education[0][1].text?b.J.addClass("empty"):b.J.removeClass("empty"),c.education[0][0].html||(c.education[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写学校信息</a>"),
c.education[0][1].html||(c.education[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写专业</a>"),b.ee.find(".education").attr("title",c.education[0][0].text).html(c.education[0][0].html),b.ee.find(".education-extra").attr("title",c.education[0][1].text).html(c.education[0][1].html),b.cancel())})):"description"===c&&(c=this.Hd.find("textarea.description"),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{description:c.val()}}},function(c){c&&c.r?U(c.msg):(c=c.msg,
c.description.text?b.J.removeClass("empty"):(c.description.fold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",c.description.unfold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",b.J.addClass("empty")),b.ee.find(".fold-item .content").empty().html(c.description.fold_html),b.ee.find(".unfold-item .content").html(c.description.unfold_html),c.description.shortened?b.ee.removeClass("disable-fold"):b.ee.addClass("disable-fold"),
b.cancel())}))};Qx.prototype.cancel=function(){this.J.removeClass("editing")};a.Rx=function(){N.call(this);this.Tf="zm-item";this.kW="zm-item-top-btn";this.MR=j};z(Rx,Im);t=Rx.prototype;t.B=function(b){this.Tb=b;this.m().e(b,"click",this.ua);this.refresh()};t.li=ca("Tf");
t.ua=function(b){if(b.target){var c=Uk(this.Tb,b.target);c&&(this.type=c.getAttribute("data-type"),this.id=c.getAttribute("data-id"),this.action=c.name,this.item=Hc(b.target,k,this.Tf),this.type&&(this.id&&this.action&&this.item)&&(this.pI||(this.pI=j,this.xhr=new V(j),this.m().e(this.xhr,"complete",this.Sg),this.xhr.ajax("/people/"+("top"===this.action?"pin":"unpin")+"_"+this.type,this.type+"_id="+this.id,"POST")),this.iW=c))}};
t.Sg=function(){if("cancel-top"===this.action)Hk(this.item,j);else if("top"===this.action){var b=Ub(this.Tf,this.Tb);this.MX=dg(this.item).y;b&&2<=b.length&&ic(M(this.item),K(this.Tf,this.Tb));this.scroll();Ok(this.item);Q(K("zm-item-top-btn-top",this.item),m);Q(K("zm-item-top-btn-cancel",this.item),j);this.refresh()}this.pI=m};t.scroll=function(){if(this.MR){var b=K("zm-profile-section-wrap"),c=Kc(Rb((fa||window).document)).y;b&&0>dg(b).y-c&&b.scrollIntoView()}};
t.refresh=function(){var b=Ub(this.Tf,this.Tb);b&&0<b.length&&A.forEach(b,function(b,d){if(0!==d){var e=K("zm-item-top-btn-top",b);e&&Q(e,j)}},this)};a.Sx=function(b,c){b.m().e(c,"next",b.refresh)};a.Tx=function(){this.iw=["zg-btn-follow","zg-btn-unfollow"];this.jw="people"};z(Tx,T);Tx.prototype.z=function(){this.m().e(this.g,"click",this.ua)};Tx.prototype.ua=function(b){var c=Uk(this.g,b.target);this.$m&&this.$m(c);c&&(c.name&&"focus"===c.name)&&Np(c,this.jw,function(){c.getAttribute("data-followme")&&(F.has(c,"zg-btn-follow")?c.setAttribute("data-tip","s$b$对方已关注你"):c.setAttribute("data-tip","s$b$已互相关注"))},this.iw,{OW:"question"===this.jw?"关注问题":k})};Tx.prototype.fH=ca("$m");a.Vx=function(b,c,d,e){N.call(this);this.Md=b;this.Jh=c;this.Qg=d;this.GC=e||Ux;b.maxLength=d;this.wj=new su(b);O(this.wj,"input",this.yo,m,this);this.Mi()};z(Vx,Fd);a.Ux=0;Vx.prototype.yo=function(){this.Mi()};Vx.prototype.Mi=function(){var b=this.Md.value.length;if(b>this.Qg){var c=this.Md.scrollTop,d=this.Md.scrollLeft;this.Md.value=this.Md.value.substring(0,this.Qg);b=this.Qg;this.Md.scrollTop=c;this.Md.scrollLeft=d}this.Jh&&wc(this.Jh,1==this.GC?b:this.Qg-b)};
Vx.prototype.w=function(){Vx.n.w.call(this);delete this.Md;this.wj.G();this.wj=k};a.Wx=function(b){N.call(this);this.ca=k;this.ha=b;this.mt=0;this.AG=""},a.Xx=void 0;z(Wx,Im);t=Wx.prototype;t.B=function(){this.as||(this.as=j,this.v(),this.nb())};t.nb=function(){B||(new dn("搜索问题")).o(this.Kc);this.T=new nn("/redirect-question/autocomplete",this.Kc,k,k,J("zh-question-redirect-diag-content"),m);this.T.Mm=m;this.T.gh(j);this.m().e(this.T,rl.th.Di,el);this.m().e(this.T,"select",this.eQ).e(this.bK,"click",function(){this.ca.D(m)})};
t.eQ=function(){var b=this.T.fj();if("search_link"===b[0])window.open("/search?q="+encodeURIComponent(b[1])+"&type=question");else{this.Kc.value="";var c=b[3],b=b[1];this.ca.D(m);this.Kc.value="";this.xhr=new V(j);ne(this.m(),this.xhr,"complete",this.vJ);this.xhr.ajax("/question/redirect","qid="+this.ha+"&rqid="+c);this.mt=c;this.AG=b}};t.vJ=function(){var b=Ie(this.xhr);b&&(b.r?U(b.msg):this.Ei?(this.Ei.innerHTML="已经重定向",this.Ei.setAttribute("data-disabled",1)):this.dispatchEvent("change"))};
t.v=function(){this.g=L("div",{id:"zh-question-redirect-diag"},["将问题跳转至",L("div",{id:"zh-question-redirect-diag-content"},this.Kc=L("input",{type:"text","class":"zg-form-text-input"})),L("div","zm-command",this.bK=L("a",{href:"javascript:;","class":"zm-command-cancel",name:"cancel"},"放弃操作"))]);this.ca=new wi(k,m);this.ca.Va("问题重定向");fi(this.ca,k);this.ca.V().appendChild(this.g)};t.show=function(){this.B();this.ca.D(j)};a.Yx={},a.Yx=function(){N.call(this)};z(Yx,Im);Yx.qu=[["需要详细阐述","答案过于简短或表述不清晰，请完善答案。"],["答非所问","没有正面或直接回答问题，请修改答案。"],["应作为问题的评论","该内容是对问题本身的评论而不是回答，请改为发布到评论。"],["应作为答案的评论","该内容是对另外一个答案的评论或回应，而不是回答问题，请改为发布到评论。"],["内容重复","与已有答案重复，请修改答案。"],["内容已过期","答案的时效性已过，请更新答案。"],["需要注明关联利益","有广告、推销嫌疑，请注明作者与利益方的关系。"]];Yx.xj=k;Yx.N=function(){Yx.xj||(Yx.xj=new Yx,Yx.xj.B());return Yx.xj};t=Yx.prototype;
t.B=function(){if(!this.g){this.v();this.nb();var b=new sq(this.g);Qh(b);b.gE=j;b.lm(j);b.D(m);tq(b,0);Rr(b,new Of(13,0,0,-22));this.Qy=b}};t.nb=function(){this.m().e(this.g,"click",this.bQ)};t.bQ=function(b){"A"===b.target.tagName&&(b=b.target.getAttribute("data-index"),this.SK.NW(b),this.Qy.D(m))};
t.v=function(){var b=L("div",{id:"zh-answer-flag-popup","class":"zg-r5px zu-hovercard-wrap"},[L("div","zg-r5px zu-hovercard-inner",[L("div",{id:"zh-answer-flag-popup-header"},[L("a",{"class":"zg-right",href:"http://www.zhihu.com/question/19867017",target:"_blank"},"这是什么？"),"选择一个理由："]),this.iG=L("div",{id:"zh-answer-flog-options-wrap"})]),L("div","zu-hovercard-spin-top")]);A.forEach(Yx.qu,function(b,d){var e=L("a",{href:"javascript:;","class":"zm-menu-item-link"},b[0]);e.setAttribute("data-index",
d);this.iG.appendChild(e)},this);document.body.appendChild(b);this.g=b};t.show=function(b,c){this.Qy.Lc(new qq(b,1));var d=c.UW(),e=Ub("zm-menu-item-link",this.iG);A.forEach(e,function(b,c){Q(b,!A.contains(d,c))},this);this.Qy.D(j);this.SK=c};a.Zx=function(){N.call(this)},a.$x=void 0;z(Zx,Im);
Zx.prototype.B=function(){this.v();this.m().e(this.ll,"change",function(){var b=this.ll.value;this.Wy.value="no"===b?"":Yx.qu[+b][1]}).e(this.bn,"click",function(b){"cancel"===b.target.name?this.ca.D(m):this.Wy.value&&"no"!==this.ll.value&&(this.ew=new V(j),this.m().e(this.ew,"complete",function(){var b=Ie(this.ew);b&&!b.r?(this.Ei.innerHTML="已经标记",this.ca.D(m)):U(b.msg)}),b=Jk(this.Wy.value),this.ew.ajax("/answer/flag","answer_id="+this.fJ+"&flag="+this.ll.value+"&reason="+encodeURIComponent(b)))})};
Zx.prototype.v=function(){this.g=L("div",k,[L("div","zg-section",[L("div",k,"标记："),this.ll=L("select")]),L("div",k,[L("div",k,"原因"),this.Wy=L("textarea",{style:"width:96%;border:solid 1px #666;height:66px;padding:5px"})]),this.bn=L("div","zm-command",[L("a",{"class":"zg-mr10",href:"javascript:void(0);",name:"cancel"},"取消"),L("a",{"class":"zg-btn-blue",href:"javascript:void(0);",name:"confirm"},"确定")])]);this.ll.appendChild(L("option",{value:"no"},"选择标记原因"));A.forEach(Yx.qu,function(b,c){this.ll.appendChild(L("option",
{value:c},b[0]))},this);this.ca=new wi(k,m);this.ca.Va("标记答案");fi(this.ca,k);this.ca.V().appendChild(this.g)};Zx.prototype.show=function(){this.ca.D(j)};a.ay=function(b){var c=b&&b.name;if(c)switch(c){case "adminflag":$x||($x=new Zx,$x.B());c=$x;c.Ei=b;c.fJ=b.id.split("-")[1];c.show();break;case "redirect":case "cancel_redirect":if(!b.getAttribute("data-disabled")){var d;Xx||(Xx=new Wx,Xx.B());d=Xx;d.Ei=b;d.ha=b.id.split("-")[1];"redirect"===c?d.show():(Ei("/question/unredirect",k,"POST","qid="+d.ha+"&rqid="+d.mt),d.Ei.innerHTML="重定向已撤销",d.Ei.setAttribute("data-disabled",1))}break;case "revert":var e=Bi("撤销",'<div class="zg-form-text-input"><textarea class="zg-editor-input content" title="请输入撤销原因" placeholder="请输入撤销原因"></textarea></div>',
function(c){if(c){var c=g.value,d=b.getAttribute("id").split("-")[1],c=(new Rl).add("revision",d).add("reason",c),n=new V(j);n.on("success",function(){var b=Ie(n);b.r?U(b.msg):(e.D(m),b.msg?window.location.href=b.msg:location.reload())});n.ajax("/revert",c.toString());return m}}),g=K("content",e.V());new mm(g);new Pm(g,48);new Vx(g,k,200)}},a.by=function(b){$(b).on("click",'a[name="revert"]',function(){ay(this)})};a.cy=function(){T.call(this)};z(cy,T);t=cy.prototype;t.B=function(){tr.H(this);this.o(document.body)};
t.z=function(){cy.n.z.call(this);var b=K("zm-profile-header-operation");b&&(new Tx).o(b);(b=K("zm-profile-header"))&&(new Px).o(b);(b=J("zh-profile-activity-wrap"))&&this.m().e(b,"click",function(b){if((b=b.target)&&"focus"===b.name){var c=b.getAttribute("data-type");Np(b,c,k,["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])}});(this.kw=b=J("zh-profile-page-force-to-rename"))&&this.m().e(b,"click",this.XS);if(this.lz=J("zh-profile-search-form")){(b=J("zh-profile-search-type"))&&this.m().e(b,
"click",this.aQ);this.ck=this.lz.getAttribute("data_type");this.m().e(this.lz,"submit",this.search);O(window,"popstate",function(b){var b=b.state,c;b&&b.Ys&&(c=J("zh-profile-search-query"),c.value=decodeURIComponent(b.Ys),dy(this,b.type),this.search(i,m),c.focus())},m,this);var b=(new vf(location)).hd().get("pq"),c=(new vf(location)).hd().get("type");c||(c="all");if(b&&c){var d=J("zh-profile-search-info");d&&Q(d,j);dy(this,c);J("zh-profile-search-query").value=b;this.search(i,i,m)}}if(b=J("zh-profile-activity-page-list"))c=
new Jt({ma:["expandLimit"],hh:j}),c.ma("locationSource",{url:"/people/"+hh[1]+"/activities",qs:10,param:function(b){return{start:A.Yd(b).getAttribute("data-time")}}}),c.ma("childConstructor",{factory:Hw}),this.H(c),c.o(b),this.m().e(c,"click!",function(b){"comment"===b.namespace&&b.wc.fill("category","profile").fill("label","profile_feed")});(b=K("zm-profile-fav-wrap"))&&this.m().e(b,"click",this.yL);(b=J("zm-profile-details-editform"))&&(new Lx).o(b);if(b=K("zm-profile-answer-sort"))this.wh=new Ut,
this.wh.Ga(this.FJ=new Rt("按时间排序")),this.wh.Ga(this.GJ=new Rt("按投票排序")),this.wh.Ga(this.EJ=new Rt("问"+S[0]+"的问题")),this.wh.X(b),this.wh.D(m),this.m().e(b,"click",function(b){this.wh.D(j);b.stopPropagation();ne(this.m(),document,"click",function(){this.wh.D(m)})}),this.m().e(this.wh,"action",this.dN);(b=J("zh-profile-edit-expert"))&&(new ey).o(b);var e=K("profile-expert-tip");e&&this.m().e(e,"click",function(b){var c=b.target;("enable"===c.name||"close"===c.name)&&$.post("/node/ProfileExpertTopicsV2",
{method:c.name},function(b){if(!b||!b.r)"enable"===c.name?location.href="/people/edit/expert":Hk(e,j)})});$(".zm-profile-section-wrap.skilled-topics").each(function(){(new Nx).o(this)});$(".zm-profile-module.skilled-topics").each(function(){(new Nx).o(this)});$(".zm-profile-module.active-topics").each(function(){(new Nx).o(this)});if(c=J("zh-profile-ask-list"))if(b=new Jt({ma:["autoload","locationSource"],hh:m}),this.H(b),b.o(c),c=K("zm-profile-section-list"))d=new Rx,d.li("zm-profile-section-item"),
Sx(d,b),d.B(c);if(c=$("#zh-profile-answer-list > .zh-general-list").get(0)||$("#zh-profile-answer-list").get(0))if(b=new Jt({hh:m}),this.H(b),b.ma("childConstructor",{Pi:tw}).ma("expandLimit"),b.o(c),this.m().e(b,"click!",function(b){"comment"===b.namespace&&b.wc.fill("category","profile").fill("label","profile_answers_list")}),c=K("zm-profile-section-list"))d=new Rx,Sx(d,b),d.B(c);if(b=$("#zh-profile-log-list").get(0))c=new Jt,c.ma("locationSource",{Rs:j}),this.H(c),c.o(b),by(b),$(b).on("click",
'a[name="report"]',function(){(new gu("activity",$(this).data("id"))).submit();return m});if(c=J("zh-profile-topic-list"))if(b=new Jt({ma:["autoload","locationSource"]}),this.H(b),this.m().e(b,"itemcreated",function(b){var b=b.item,c=b.getAttribute("data-tid").split("-")[1];if(S.Ge===hh[3]){var d=new qp(j,"/topic/bio/update","bio");d.Yt=j;d.params=["tid="+c];d.Hb='<a href="javascript:;" name="edit">添加你在该话题的经验</a>';d.o(b)}}),b.o(c),c=K("zm-profile-section-list"))d=new Rx,d.li("zm-profile-section-item"),
Sx(d,b),d.B(c);if(b=$("#zh-profile-column-list > .zh-general-list").get(0))c=new Jt({ma:["autoload","nodeSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-follows-list > .zh-general-list").get(0))c=new Jt({ma:["autoload","nodeSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-follows-list-old").get(0))c=new Jt({ma:["autoload","locationSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-fav-list > .zh-general-list").get(0))c=new Jt({ma:["autoload","nodeSource"],hh:m}),this.H(c),c.o(b);this.Qn();-1<location.search.indexOf("clean-followers-noti=1")&&
(new V(j)).ajax("/notification/clear","no_refresh_content=true&type=follow");$("#__signin").click(function(){Gm("privacy_sign_in_button","singin")})};t.XS=function(){Bi("确定","确定要强制此用户改名吗？",function(b){b&&(J("realname_form").submit(),this.kw.innerHTML="已发送",F.add(this.kw,"zg-gray"),Ad(this.kw))},this)};
t.Qn=function(){this.uj();var b=J("zm-profile-header-pm-btn");b&&O(b,"click",ut(function(b){b.preventDefault()},Hm(function(){var c=new Qq;c.show();Uq(c,hh[3],hh[0]);Tq(c,b.href);c.Wb.focus()},{na:"people_message_button",cd:j})));var c=J("zh-profile-cancel-block");c&&this.m().e(c,"click",this.MF);$("#zh-report-people, #profile-side-op a[name=report]").each(function(b,c){ju(new gu("member",hh[3]),c)});(c=J("zh-profile-search-query-mirro"))&&new mm(c,c.getAttribute("placeholder"))};
t.MF=function(){Bi("确定取消屏蔽？","取消屏蔽后，对方将可以关注你、向你发私信、评论你的回答、使用「@」提及你，邀请你回答问题。",function(b){b&&fy(this,m)},this)};t.Mk=function(){ne(this.m(),document,"click",function(){this.cb.D(m)})};t.uj=function(){var b=J("profile-side-op");b&&this.m().e(b,"click",this.mj)};t.dN=function(b){var c="";b.target===this.FJ?c="time":b.target===this.GJ?c="vote":b.target===this.EJ&&(c="ask");location.href="/people/"+S[1]+"/answers?sort="+c};
t.mj=function(b){b=b.target.name;"block"===b?Bi("确定要屏蔽该用户？","屏蔽用户后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你，邀请你回答问题，但仍然可以查看你的公开信息。",function(b){b&&fy(this,j)},this):"cancel-block"===b&&this.MF()};a.fy=function(b,c){var d=new V(j);ne(b.m(),d,"complete",function(){window.location.reload()});d.ajax("/people/"+hh[1]+"/block","action="+(c?"add":"cancel"))};
t.yL=function(b){if(b&&b.target&&(b=Uk(this.g,b.target))){var c=K("zm-profile-fav-item-title",b),d=K("zm-profile-fav-item-des",b);c&&d&&"fav-edit"===b.name&&(c=c.innerHTML,d=d.innerHTML||"",b=[Number(b.getAttribute("data-id")),Number(b.getAttribute("data-public"))],Rw(Jw.N(),c,d,b))}};t.aQ=function(b){if((b=b.target)&&b.name)dy(this,b.name),this.search()};
a.dy=function(b,c){var d=Ub("zm-profile-search-type-item");if(d)for(var e=0;e<d.length;e++)F.remove(d[e],"current"),d[e].name===c&&F.add(d[e],"current");b.ck=c};
t.search=function(b,c,d){this.Ie=J("zh-profile-search-query").value;this.im="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search";if(this.Ie){c===i&&(c=j);d===i&&(d=j);if(window.history.pushState){if(this.nz)return;b&&b.preventDefault();this.jm=new V(j);this.nz=j;this.m().e(this.jm,"complete",this.oI);c&&window.history.pushState({Ys:encodeURIComponent(this.Ie),type:this.ck},"","?pq="+encodeURIComponent(this.Ie)+"&type="+this.ck);this.jm.ajax(this.im,"type="+this.ck+"&pq="+encodeURIComponent(this.Ie),
"","POST")}else b||(d?(this.Ie=J("zh-profile-search-query").value,this.im="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search",window.location.href=this.im+"?type="+this.ck+"&pq="+encodeURIComponent(this.Ie)):(this.jm=new V(j),this.nz=j,this.m().e(this.jm,"success",this.oI),this.Ie=J("zh-profile-search-query").value,this.im="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search",this.jm.ajax(this.im,"type="+this.ck+"&pq="+encodeURIComponent(this.Ie),"","POST")));
(b=J("zh-profile-search-info"))&&Q(b,j)}else b&&b.preventDefault()};
t.oI=function(){this.nz=m;wc(J("zh-profile-search-word"),this.Ie);var b=Ie(this.jm);if(b&&!b.r){var c=J("zh-profile-search-list");if(c)if(0===b.msg[0])J("zh-profile-list-container").innerHTML='<div id="'+c.id+'"><div style="margin: 20px;color: #999;text-align: center;">抱歉，没有找到任何结果</div></div>';else{var d;d=""+('<div id="'+c.id+'">');d+=b.msg[1]+"</div>";J("zh-profile-list-container").innerHTML=d+'<a href="javascript:;" id="zh-load-more" class="zg-btn-white zu-button-more" style="">更多</a>';if((b=Ub("zm-item",
c))&&b.length)this.Me=b[b.length-1].id.split("-")[1];this.Qa=k;this.Qa=new Iw(J(c.id),k,j);this.Qa.B();this.Qa.Me=this.Me;this.Qa.url=this.im;this.Qa.params.pq=this.Ie;this.Qa.params.type=this.ck;J("zh-profile-search-query").focus()}}};a.ey=function(){T.call(this)};z(ey,T);
ey.prototype.$=function(b){this.g=b;this.Na=new Qs;this.Na.o(this.g);this.form=J("zm-profile-expert-editform");this.m().e(this.form,"submit",this.zy);this.m().e(this.Na,["add","remove","sort"],function(){this.Ze()});$(".enable").on("change","input",$.proxy(function(){this.Ze()},this));var c=J("zh-profile-expert-warning");c&&this.m().e(c,"click",function(b){"close"===b.target.name&&Hk(c)});$(".enable input[type='radio']").click(function(b){Q(J("zh-profile-expert-reopen-tip"),!Number($(b.target).val()))})};
ey.prototype.Ze=function(){$(window).on("beforeunload.profile",v(s("你的更改还未保存，确认离开该页面吗？"),this))};ey.prototype.Hf=function(){$(window).off("beforeunload.profile")};
ey.prototype.zy=function(b){b.preventDefault();A.map(this.Na.data,function(b){return b[3]});var b=$(this.form).serializeArray()[0].value,c=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get(),d=this;$.post("/node/ProfileEditExpertTopicsV2",{method:"save",params:{settings:{enable_expert:b,expert_topic:c}}},function(b){if(!b||!b.r)d.Hf(),window.location.href="/people/"+S[1]})};a.gy=function(){T.call(this)};z(gy,T);a.hy=function(b){var c=$.Deferred();Bi("取消屏蔽",b,function(b){b?c.resolve():c.reject()});return c.promise()};
gy.prototype.z=function(){gy.n.z.call(this);var b=J("zh-topic-block-editor");b&&(new Ss(jh)).o(b);var c=$(".blocked-users",this.h());if(c.length)$(".item",c).on("click",".js-unblock",function(b){var d=$(b.delegateTarget);hy("取消屏蔽之后，对方将可以：关注你、给你发私信、向你提问、评论你的答案、邀请你回答问题。").then(function(){return $.post("/settings/unblockuser",{uid:d.data("id")})}).then(function(){d.fadeOut(function(){d.remove()});c.children().length||window.location.reload()})});var d=$(".blocked-columns",this.h());if(d.length)$(".item",
d).on("click",".js-unblock",function(b){var c=$(b.delegateTarget);hy("取消屏蔽之后，你将可以看到来自该专栏的文章。").then(function(){return $.post("/settings/unblockcolumn",{id:c.data("id")})}).then(function(){c.fadeOut(function(){c.remove()});d.children().length||window.location.reload()})})};a.iy=function(){T.call(this);this.PW=[];this.OX="/profile/validate"};z(iy,T);
iy.prototype.B=function(){function b(b,c){var d={method:"save",params:{settings:b}};$.extend(d.params,qh.settings_unsubscribe_formdata);$.post("/node/NotiEmailSettingsV2",d,function(b){var d;b.r?d="error":(c&&c(),d="success");var e=$(".settings-msg-"+d);e.length?e.show():(e=$('<div class="settings-msg-'+d+'">'+b.msg+"</div>"),e.appendTo($("body")));e.delay(1E3).fadeOut()})}var c=this;$('.settings-receive input[type="radio"]').on("change",function(){if(this.checked){var c=$(this),d={type:c.closest(".settings-item").data("type"),
noti:c.val()};"no"===d.noti?b(d,function(){c.closest(".settings-receive").next(".settings-mail").addClass("disabled").find('input[type="checkbox"]').prop("disabled",j)}):b(d,function(){c.closest(".settings-receive").next(".settings-mail").removeClass("disabled").find('input[type="checkbox"]').prop("disabled",m)})}});$('.settings-mail input[type="checkbox"]').on("change",function(){var c={type:$(this).closest(".settings-item").data("type"),mail:this.checked};b(c)});$("#settings-fast-answer").on("change",
function(){var c={type:$(this).closest(".settings-item").data("type"),fast:this.checked};b(c)});$(".settings-msg-disappear").delay(3E3).fadeOut();var d=$(".js-ajax-form");d.submit(function(b){var c=$(b.target),b=c.attr("action")||location.href;$.post(b,c.serialize()).done(function(b){Br(H.Ma(b),5E3);c.hasClass("unsubscribe")&&(d.remove(),$(".settings-section").remove())});return m});$(".js-unsubscribe-other-reason").on("change",function(b){$(b.target).parent().siblings().find(".zg-form-text-input").toggle()});
var e=$(".feedback-form");e.submit(function(){var b=e.attr("action");$.post(b,e.serialize()).done(function(){e.before('<div style="font-size:13px;color:black;margin-bottom:20px">感谢您的反馈！</div><a href="/">&laquo; 返回知乎</a>');e.remove()});return m});$("#weibopageenable").on("change",function(b){$.post("/node/SettingsWeiboPageV2",{method:b.target.checked?"enable":"disable"}).done(function(b){b.r?U(b.msg):Br([m,"保存成功"])});return m});var g=$("#js-settings-account-form");if(g.length){var h=Fk(function(){new mm(J("password"))}),
l=$("#url_token"),n=$("#js-url-preview .token");l.on("input change keyup",function(){n.text($.trim(this.value))});var q=$("#email"),r=function(){$("#js-email-confirm").show();q.off("focus",r);h()};q.one("focus",r);$(function(){document.activeElement===q.get(0)&&r()});$(".resend-mail",g).click(function(){var b=$(this);Ki.dispatchEvent("/activation/resend-email");$.post("/settings/resend_reset_email",function(c){c.r?U(c.msg):b.replaceWith("已发送")});return m});$(".zg-form-text-input",g).each(function(){function b(){this.value!==
this.defaultValue&&(d.hide(),c.off("change input keyup",b))}var c=$(this),d=c.next(".validate-error");if(d.length)c.on("change input keyup",b)});var l=new fr,w=$(".rename-tab",g);l.o(w.get(0));var x=function(){$("input[placeholder]:visible",w).placeholder()};l.on("select",x);var G=$(".rename-button",g),g=function(){G.remove();w.show();x()};G.one("click",g);"#rename-section"===location.hash&&g()}g=$("#js-form-account-password");g.length&&($("input[placeholder]",g).each(function(){new mm(this)}),g.validate({messages:{np:{required:'<i class="icon icon-validate-error"></i>新密码未填写'},
op:{required:'<i class="icon icon-validate-error"></i>旧密码未填写'},rp:{required:'<i class="icon icon-validate-error"></i>确认密码未填写'}},errorClass:"validate-error"}));(g=J("zh-setting-page-black-list-wrap"))&&(new gy).o(g);(g=J("zh-setting-page-bind-wrap"))&&(new Ex).o(g);$(".zu-main-content-inner form").on("change","input, textarea, select",function(){c.sn("SettingsPage")}).on("submit",function(){c.al("SettingsPage")})};
iy.prototype.sn=function(){$(window).on("beforeunload.SettingsPage",v(s("你的修改还未保存，确认离开该页面吗？"),this))};iy.prototype.al=function(){$(window).off("beforeunload.SettingsPage")};a.jy=function(b,c,d,e,g){mu.call(this,b,c,g);this.gw=d||"people";this.GL=e||["zg-follow","zg-unfollow"]};z(jy,mu);jy.prototype.B=function(b){jy.n.B.call(this,b);this.nb(this.g)};jy.prototype.uA=ca("uA");jy.prototype.nb=function(b){if(this.uA){var c=new Tx,d=this.GL;c.jw=this.gw;c.iw=d||c.iw;this.$m&&c.fH(this.$m);c.o(b)}};jy.prototype.fH=ca("$m");a.ky=function(b,c,d,e){N.call(this);this.g=b;this.gw=c||"people";this.FL=d||["zg-btn-follow","zg-btn-unfollow"];this.text=e||["关注","取消关注"]};z(ky,Im);ky.prototype.B=function(){this.m().e(this.g,"click",this.zo)};ky.prototype.zo=function(b){b=Uk(this.g,b.target);"focus"===(b&&b.name)&&Np(b,this.gw,k,this.FL,{follow_text:this.text[0],unfollow_text:this.text[1]})};a.ly=function(b){N.call(this);this.url=b||"/topic"};z(ly,Im);t=ly.prototype;t.o=function(b){this.element=b;var c=$("<ul>");this.NH=$("<li>");c.append(this.NH);$(b).append(c);this.OH||(this.OH=j,this.jA=new V(j),ne(this.m(),this.jA,"success",this.DP),this.jA.ajax(this.url,k,"POST"))};t.DP=function(){var b=Ie(this.jA);b&&(b&&b.r?U(b.msg):(my(this,this.NH,b.msg),this.OH=m,this.z()))};t.z=function(){this.m().e(this.element,"click",this.zo)};
t.zo=function(b){var c=(b=b.target)?b.name:"";if(c)switch(c){case "load":case "loadmore":if(!this.mo){var c=b.getAttribute("data-token"),d=b.getAttribute("data-parent");this.mo=j;this.Ij=new V(j);ne(this.m(),this.Ij,"success",this.$p);this.pz=b.parentNode;this.pz.innerHTML='<span class="zg-gray">加载中...</a>';this.Ij.ajax(this.url+"?child="+c+"&parent="+d,k,"POST")}break;case "topic":window.location.href=b.href}};
a.my=function(b,c,d){var e=d[0],g="";"topic"!==e[0]&&e[3]&&(g='data-parent="'+e[3]+'"');c.html('<a href="'+("topic"===e[0]?"/topic/"+e[2]+"/organize/entire":"javascript:;")+'" data-token="'+e[2]+'" '+g+' name="'+e[0]+'">'+e[1]+"</a><ul class='zm-topic-organize-list'></ul>");"topic"!==d[0][0]&&c.addClass("zm-topic-organize-loadmore");c=$("ul",$(c));if(1<d.length){d=d[1];for(e=0;e<d.length;e++){var g=d[e],h=$("<li>").addClass("zm-topic-organize-item");c.append(h);my(b,h,g)}}};
t.$p=function(){var b=Ie(this.Ij);if(b)if(b&&b.r)U(b.msg);else if(b=b.msg,b[1]){$(this.pz).hide();for(var c=$(this.pz.parentNode),d=0;d<b[1].length;d++){var e=b[1][d],g=$("<li>").addClass("zm-topic-organize-item");"topic"!==e[0][0]&&g.addClass("zm-topic-organize-loadmore");c.append(g);my(this,g,e)}this.mo=m}};a.ny=function(b){var c={yp:m,PX:m};return function(d){if(d===m)return m;d={};H.extend(d,c,b||{});if(d.yp&&!S.Ir)return Ci("提示信息",'<a href="/question/23261456" target="_blank">如何参与知乎话题的公共编辑？</a>'),m;if(d.am&&!dh.oL)return Ci("提示信息",'<p>创建较久或已有较多讨论的问题限制公共编辑</p><p><a href="/question/24501563" target="_blank">如何参与问题公共编辑？</a></p>'),m}};a.py=function(b,c,d){qp.call(this,b,c,d)};z(py,qp);py.prototype.Ug=function(b){gh[0][0]===b?this.pi():py.n.Ug.apply(this,arguments)};py.prototype.jB=function(b){if(b=Ie(b.target))b.r?U(b.msg):b.msg&&(window.location.href=b.msg)};a.qy=function(){T.call(this);var b=gh;this.uf=b[0][3];this.hA=b[0];this.SX=b[1];this.jX=b[2];this.sX=b[3];this.oq=b[4];this.Bx=b[5];this.Vg="topic"};z(qy,T);t=qy.prototype;t.B=function(){tr.H(this);this.o(document.body)};
t.z=function(){function b(b){b&&b.msg&&U(b.msg)}qy.n.z.call(this);var c=J("zh-topic-side-head");if(c){var d=K("zu-entry-focus-button",c);(this.EL=d)&&this.m().e(d,"click",function(){Np(d,"topic","",["zg-btn-green","zg-btn-white"])});(this.Yf=J("zh-topic-operation-menu"))&&this.m().e(this.Yf,"click",this.Dz)}if(c=J("zh-current-topic-bio")){var e=new qp(j,"/topic/bio/update","bio");e.params=["tid="+this.uf];e.Hb='<a href="javascript:;" name="edit">你在 '+this.hA[0]+" 话题中的经验</a>";e.AC=j;e.o(c)}(c=J("zh-topic-top-answerer"))&&
(new ky(c,"people",["zg-follow","zg-unfollow"])).B();if(c=J("zh-topic-direct-question-list"))c=new jy(c,k,"question",k,j),c.li("question-item"),c.B();if(c=J("zh-topic-title"))this.$c=new py(m,"/topic/update","title"),this.$c.params=["tid="+this.uf],this.$c.addEventListener("beforeedit",ny({yp:j})),this.$c.o(c),$(c).on("click",".js-pin",function(){var b=$(this),c=b.attr("data-action");$.post(c,{tid:gh[0][3]}).done(function(c){c.r?U(c.msg):(c=b.hasClass("pin")?'<a href="javascript:;" data-action="/pin-topic/remove" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消常去话题</a>':
'<a href="javascript:;" data-action="/pin-topic/add" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>设为常去话题</a>',b.replaceWith(c))})});if(c=J("zh-topic-desc"))e=$(c).find(".zm-editable-content").data("editable-maxlength"),this.$k=new sp(j,"/topic/update","description",e),this.$k.Hb='<a href="javascript:;" name="edit">添加话题描述</a></div>',this.$k.params=["tid="+this.uf],this.$k.xq=m,this.$k.YH=m,this.$k.addEventListener("beforeedit",ny({yp:j})),this.$k.o(c);if(c=J("zh-topic-faq"))this.gr=
new sp(j,"/topic/"+encodeURIComponent(gh[0][1])+"/faq","content",400),this.gr.Hb='<div class="zm-topic-faq-container"><div class="zg-gray-normal">常见问题是该话题下经常会提到的问题的整理，以便后来者查阅（<a href="http://www.zhihu.com/question/20388061" class="zg-link-litblue">如何创建？</a>）</div><a href="javascript:;" name="edit" class="zg-link-litblue"><span class="zg-blue-edit"></span>为「'+gh[0][0]+"」添加常见问题</a></div>",this.gr.hY=function(b){return!b?"":b.replace(/(<\/?(?!ul|li|a|br)[^>\/]*)\/?>/gi,"")},this.gr.xq=m,this.gr.o(c);
if(mh)$("div.topic-avatar").addClass("disabled");else if(c=K("zm-entry-head-avatar-edit-button")){var g=new Bx(2,gh[0][3]);g.o(c);var h=K("zm-avatar-editor-preview");O(g,"beforepost",function(){$("<div class='avatar-edit-preview-loading topic'><span></span></div>").appendTo(h.parentNode)});O(g,"success",function(){$.post("/topic/"+gh[0][1]+"/avatar",{avatar_path:g.getData().id}).then(function(){h&&(h.src=g.getData().url)}).always(function(){$(".avatar-edit-preview-loading").remove()})});this.m().e(g,
"beforeopen",pf(ny({yp:j}),Hm(ha,j)))}if(c=J("zh-topic-feed-list"))e=new Jt,this.H(e),e.ma("locationSource",{qs:0,offset:function(b){return A.Yd(b).getAttribute("data-score")}}),e.ma("childConstructor",{factory:Hw}).ma("expandLimit"),e.o(c),this.m().e(e,"click!",function(b){"comment"===b.namespace&&b.wc.fill("category",this.Vg).fill("label","topic_activity")});if(c=J("zh-topic-top-page-list"))e=new Jt({hh:m}),this.H(e),e.ma("childConstructor",{factory:Hw}).ma("expandLimit"),e.o(c),this.m().e(e,"click!",
function(b){"comment"===b.namespace&&b.wc.fill("category",this.Vg).fill("label","topic_activity")});var l=this;l.Qa&&l.m().e(l.Qa,"afterload",function(b){W.ga({type:"ga_click_topic_more",data:b.data,target:l.Qa.Yb})});if(c=J("zh-topic-followers-list-wrap"))c=new jy(c,["/topic",encodeURI(this.hA[1]),"followers"].join("/"),k,["zg-btn-follow","zg-btn-unfollow"],j),c.li("zm-person-item"),c.B();if(J("zh-topic-organize-page-wrap")){if(c=J("zh-topic-organize-parent-editor"))S.Ir?(e=new ws(k,this.uf,j),e.Gs=
j,e.o(c),e.addEventListener("remove_tag",function(b){(b=b.data&&b.data.id)&&$("#wedge-"+b).remove()})):ry(c);if(c=J("zh-topic-organize-child-editor"))S.Ir?(e=new ws(k,this.uf,m),e.Gs=j,e.o(c),$("a.entire-link").insertAfter(e.qn).show()):ry(c);$("#zm-topic-manage-relation").on("change",'[type="checkbox"]',function(){var b=$(this).closest("li").attr("id").split("-")[1];$.post("/topic/update",{action:"set_topic_edge",parent_topic_id:b,topic_id:gh[0][3],edge:this.checked^0}).done(function(b){b&&b.msg&&
U(b.msg)})});this.Eu=J("zh-topic-alias-input");new mm(this.Eu,"输入话题别名");this.Fu=J("zh-topic-alias-list");this.m().e(J("zh-topic-alias-container"),"click",this.nQ);if(c=J("zh-topic-merge"))this.Na=new Ts,this.Na.o(c);(c=J("zh-topic-merge-btn"))&&this.m().e(c,"click",this.RP)}(c=J("zh-topic-organize-page-children"))&&(new ly("/topic/"+encodeURIComponent(gh[0][1])+"/organize/entire")).o(c);if(c=J("zh-topic-side-related-topics"))this.kR=c,this.$y=new V(m),this.m().e(this.$y,"complete",this.$P),this.$y.ajax("/topic/related?tid="+
this.uf);J("zh-topic-admin-page-wrap")&&(c=J("zh-topic-del-btn"))&&this.m().e(c,"click",this.zP);if(c=J("zh-topic-log-list"))(new jy(c,k,k,k,j)).B(),$(c).on("click",'a[name="revert"]',pf(function(b){b!==m&&ay(this)},ny({yp:j}))).on("click",'.zm-item-meta a[name="report"]',function(){(new gu("activity",$(this).data("id"))).submit();return m});(c=K("zm-topic-search-input-new"))&&new mm(c,"在话题中搜索");var n=$(c);bh.uc||n.focus(function(){n.addClass("stretch-to")}).blur(function(){n.removeClass("stretch-to")});
(c=K("zm-topic-ask-in-topic"))&&this.m().e(c,"click",this.Bz);(c=K("zm-topic-feed-container"))&&(new ky(c,"question",["zg-follow","zg-unfollow"])).B();(c=J("zh-topic-side-children-list"))&&(new ky(c,"topic",["zg-follow","zg-unfollow"])).B();(this.Vr=J("zh-topic-info-add"))&&this.m().e(this.Vr,"submit",this.MP);(this.rE=K("zm-topic-info-content-main",this.g))&&this.m().e(this.rE,"click",this.KP);$("#zh-topic-manage-info-form").on("change",'input[type="radio"]',function(){$.post("/topic/"+gh[0][1]+
"/information/manage",{info:$(this).val(),action:"change"}).done(b)});$("#zh-topic-manage-relation-form").on("change",'input[type="radio"]',function(){$.post("/topic/update",{action:"set_topic_weaknode",topic_id:gh[0][3],weak:$(this).val()}).done(b)});$("#zh-topic-manage-lock-form").on("change",'[type="checkbox"]',function(){$.post("/topic/lock",{url_token:gh[0][1],lock_type:this.name,lock_value:$(this).is(":checked")?1:0}).done(b)});(c=J("zh-topic-info-add"))&&A.forEach(nc(c),function(b){var c;b&&
(b.getAttribute&&(c=b.getAttribute("data-placeholder")))&&new mm(b,c)});$(".js-may-disable").click(Hm(ha,j))};t.RP=function(){this.Nq=this.Na.pC;if(!this.tF&&this.Nq){this.tF=j;this.by=new V(j);ne(this.m(),this.by,"success",this.qJ);this.by.ajax("/topic/"+encodeURIComponent(gh[0][1])+"/demand","action=merge&target_topic_id="+this.Nq[3]);var b=J("zh-topic-merged-msg");Q(J("zh-topic-merge"),m);Q(b,j);b=Tb("a",k,b)[0];b.href="/topic/"+this.Nq[1];b.innerHTML=this.Nq[0];this.Na&&(this.Na.fb.value="")}};
t.qJ=function(){var b=Ie(this.by);b&&b.r?U(b.msg):this.tF=m};t.zP=function(){this.xC||(this.xC=j,this.Cv=new V(j),ne(this.m(),this.Cv,"success",this.oJ),this.Cv.ajax("/topic/"+encodeURIComponent(gh[0][1])+"/demand","action=remove"))};t.oJ=function(){var b=Ie(this.Cv);b&&b.r?U(b.msg):(b=J("zh-topic-del-msg"),Q(J("zh-topic-del-btn"),m),Q(b,j),this.Na&&(this.Na.fb.value=""),this.xC=m)};
t.nQ=function(b){if((b=b.target)&&b.name)if("add"===b.name){if(b=this.Eu.value)this.Gu=new V(j),ne(this.m(),this.Gu,"complete",this.nJ),this.Gu.ajax(window.location.href,"action=add_alias&alias="+encodeURIComponent(b))}else"remove"===b.name?(this.az=new V(j),b=b.parentNode.getAttribute("data-token"),ne(this.m(),this.az,"complete",this.sJ),this.az.ajax(window.location.href,"action=remove_alias&alias_token="+b)):"remove-merged"===b.name&&(this.cz=new V(j),b=b.parentNode.getAttribute("data-token"),ne(this.m(),
this.cz,"complete",this.tJ),this.cz.ajax("/topic/"+encodeURIComponent(gh[0][1]+"/demand"),"action=remove&target_topic_id="+b))};t.tJ=function(){var b=Ie(this.cz);b&&b.r?U(b.msg):sy(this,b.msg)};t.sJ=function(){var b=Ie(this.az);b&&b.r?U(b.msg):sy(this,b.msg)};a.sy=function(b,c){var d=Tb("li",k,b.Fu);A.forEach(d,function(b){b.getAttribute("data-token")===c[1]&&Q(b,m)})};
t.nJ=function(){var b=Ie(this.Gu);if(b&&b.r)U(b.msg);else{var b=b.msg,c=L("li");c.setAttribute("data-token",b[1]);c.innerHTML=b[0]+' <a name="remove" href="javascript:;" class="zg-link-gray">移除</a>';this.Fu.appendChild(c);this.Eu.value="";Q(this.Fu.parentNode,j)}};a.ry=function(b){gc(b,ec('<a href="/question/23261456" class="zg-link-gray-normal"><i class="icon-info" style="vertical-align: -3px; margin-right: 6px"></i>如何参与知乎话题的公共编辑？</a>'))};
t.Dz=function(b){this.Ey?this.cb.Q()?this.cb.D(m):(this.cb.D(j),b.stopPropagation(),b.preventDefault(),this.Mk()):(b.stopPropagation(),b.preventDefault(),this.uj(),this.Mk());this.Ey=j};t.Mk=function(){ne(this.m(),document,"click",function(){this.cb.D(m)})};
t.uj=function(){var b=J("zh-topic-side-head"),c=this.Yf.getAttribute("data-auth");this.cb=new Ut;this.Zw=j;"f-topic-manage"===c&&this.cb.Ga(this.sQ=new Rt("管理话题"));this.cb.Ga(this.tQ=new Rt("组织话题"));this.cb.Ga(this.rQ=new Rt("话题日志"));this.Zw&&(this.cb.X(b),this.m().e(this.cb,"action",this.mj))};t.mj=function(b){var c="";b.target===this.sQ?c="admin":b.target===this.tQ?c="organize":b.target===this.rQ&&(c="log");window.location.href=["/topic",this.hA[1],c].join("/")};
t.$P=function(){var b=Ie(this.$y);if(b&&!b.r){var c=[];A.forEach(b,function(b){c.push(Ik(b,k,j))});this.kR.innerHTML=c.join("")+'<div class="zg-clear"></div>';b.length&&Q(J("zh-topic-side-related-topics-wrap"),j)}};
t.KP=function(b){var c=b.target;c&&c.name&&"remove"===c.name&&(this.IN=c,this.sE||(this.sE=j,this.kx=new V(j),this.m().e(this.kx,"success",this.LP),b="token="+this.IN.parentNode.getAttribute("data-token")+"&action=remove&element="+encodeURIComponent($(b.target).prev("[data-element]").text()),this.kx.ajax("/topic/"+gh[0][1]+"/information/manage",b,"POST")))};t.LP=function(){this.sE=m;var b=Ie(this.kx);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,K("zm-topic-info-content-main",this.g).innerHTML=$(b).html()))};
t.MP=function(b){b.preventDefault();this.uE||(this.uE=j,this.lx=new V(j),this.m().e(this.lx,"success",this.JP),b=nc(this.Vr),this.lx.ajax("/topic/"+gh[0][1]+"/information/manage","title="+b[0].value+"&content="+b[1].value+"&url="+b[2].value+"&action=add","POST"))};t.JP=function(){this.uE=m;var b=Ie(this.lx);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,K("zm-topic-info-content-main",this.g).innerHTML=$(b).html(),b=nc(this.Vr),A.forEach(b,function(b,d){3>d&&(b.value="")})))};
t.Bz=Hm(function(){if(!or()){var b=vp.N();b.show();var c=K("zm-topic-search-input-new");c.value&&yp(b,c.value);b.Na.data.length||b.Na.fk(gh[0])}},j);a.ty=function(b){T.call(this,b)};z(ty,T);ty.prototype.v=function(){this.g=this.K().v("FORM",{method:"POST",style:"display:none"})};ty.prototype.post=function(b,c,d){var e=this.h();e||(this.X(),e=this.h());e.action=c||"";e.target=d||"";var c=e,g,h=new Or;for(g in b)d=b[g],ma(d)?A.forEach(d,v(this.rB,this,h,g)):this.rB(h,g,d);c.innerHTML=h.toString();e.submit()};ty.prototype.rB=function(b,c,d){b.append('<input type="hidden" name="',Va(c),'" value="',Va(d),'">')};a.uy=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"day"})})},a.vy=function(b){return $.get("/node/ExploreHotFavlistsInnerV2",{params:JSON.stringify({offset:b})})},a.wy=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"month"})})};a.xy=function(){N.call(this)};z(xy,Im);xy.prototype.B=function(){var b=Vr(new vf(window.location.href),"group_id");b&&(this.Lj=new V(m),ne(this.m(),this.Lj,"success",this.Ly),b&&this.Lj.ajax("/noti7/read","group_id="+b,"POST"))};xy.prototype.Ly=function(){var b=Ie(this.Lj);if(b&&!b.r&&b.msg){var c=b.msg;if(c===j||"true"===c||"True"===c)return;this.gP=b.msg;this.dispatchEvent("change")}(b=nq)&&oq(b)};a.yy=function(){T.call(this);var b=ih||[0,0];this.ps=b[0];this.visible=!!b[1];this.Vg="collection"};z(yy,T);t=yy.prototype;t.B=function(){tr.H(this);this.o(document.body)};
t.z=function(){yy.n.z.call(this);var b=J("zh-list-side-head");if(b){var c=K("zu-entry-focus-button",b);(this.EL=c)&&this.m().e(c,"click",function(){Np(c,"favlist","",["zg-btn-green","zg-btn-white"])});(this.Yf=J("zh-list-operation-menu"))&&this.m().e(this.Yf,"click",this.Dz)}(b=J("zh-single-answer-author-info"))&&(new ky(b)).B();(b=J("zh-list-create-new-list"))&&this.m().e(b,"click",this.iS);(b=J("zh-fav-list-side-bar-creator"))&&(new ky(b)).B();(b=J("zh-fav-list-side-bar-report"))&&ju(new gu("favlist",
this.ps),b);(this.tk=J("zh-favlist-webshare-container"))&&this.m().e(this.tk,"click",this.Gz);if(this.Gc=J("zh-list-meta-wrap"))this.m().e(this.Gc,"click",this.Fo),this.pW=J("zh-list-comment-num"),Vr(new vf(location.href),"fc")&&zy(this);(b=J("zh-favlists-wrap"))&&(new jy(b,k,"favlist",k,j)).B();if(b=J("zh-list-answer-wrap")){$(b).on("click","a[name=unfavo]",$.proxy(this.oN,this));var d=new Jt({hh:m});this.H(d);d.ma("childConstructor",{Pi:tw}).ma("expandLimit");d.o(b);this.m().e(d,"click!",function(b){"comment"===
b.namespace&&b.wc.fill("category",this.Vg).fill("label","collection_answer")})}(b=J("zh-favlist-log-list-wrap"))&&(new jy(b,k,"favlist",k,j)).B();(b=J("zh-favlist-following-wrap"))&&(new jy(b,k,"favlist",k,j)).B();if(b=J("zh-favlist-followers-wrap"))b=new jy(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j),b.li("zm-profile-section-item"),b.uA(j),b.B();this.m().e(window,"hashchange",this.LX);this.qx();this.vo=new xy;this.vo.B()};
t.oN=function(b){var b=b.target,c=b.id.split("-"),d=c[1],c=c[2];(new V(j)).ajax("/collection/remove","answer_id="+d+"&favlist_id="+c);if(c=Hc(b,"div","zm-item"))b=Ub("zm-item-answer",c),1===b.length?M(c):(b=A.find(b,function(b){return b.getAttribute("data-aid")===d}))&&M(b.parentNode)};t.Gz=function(b){var b=Uk(this.tk,b.target),c=location.pathname.match(/^\/collection\/(\w+)/);b&&(b.name&&c)&&new yu(["分享收藏夹","collection",c[1],{fid:ih[0]}],"tb-webshare-"+b.name)};
t.iS=Hm(function(){Jw.N().show(j)},j);t.Dz=function(b){this.Ey?this.cb.Q()?this.cb.D(m):(this.cb.D(j),b.stopPropagation(),b.preventDefault(),this.Mk()):(b.stopPropagation(),b.preventDefault(),this.uj(),this.Mk());this.Ey=j};t.Mk=function(){ne(this.m(),document,"click",function(){this.cb.D(m)})};
t.uj=function(){var b=J("zh-list-side-head");this.cb=new Ut;this.Zw=j;this.visible||this.cb.Ga(this.vQ=new Rt("设置为公开"));this.cb.Ga(this.qQ=new Rt("删除此收藏夹"));this.Zw&&(this.cb.X(b),this.m().e(this.cb,"action",this.mj))};t.Fo=function(b){b=b.target;switch(b&&b.name){case "edit":Rw(Jw.N());break;case "addcomment":zy(this);this.oa.xf();this.oa.tc()&&this.oa.ri("view_comments",parseInt(Ec(b),10)||0);break;case "remove":Ay(this)}};
t.mj=function(b){b.target===this.vQ?Bi("确定设置收藏夹为公开？","收藏夹设置为公开后，将不能再设置为私密。",function(b){b&&(this.yX=!this.visible,this.WH=new V(j),this.m().e(this.WH,"complete",function(){window.location.reload()}),this.WH.ajax("/collection/update","favlist_id="+this.ps+"&is_public=1"))},this):b.target===this.qQ&&Ay(this)};a.Ay=function(b){Bi("删除收藏夹","你确定要删除这个收藏夹吗？",function(b){b&&(b=new Vk,b.add("favlist_id",this.ps),b.add("_xsrf",(new Kf(document)).get("_xsrf")),(new ty).post(Xr(b),"/collection/delete"))},b)};
t.qx=function(){var b=1,c=$("ul.hot-favlists"),d=k;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=vy(b).done(function(b){c.html(b)}))})};a.zy=function(b){b.oa||(b.oa=new Xv(b.ps,"favlist"),b.H(b.oa),b.m().e(b.oa,"click!",function(b){"comment"===b.namespace&&(b.wc.fill("category",this.Vg).fill("label","collection"),b.wc.action=b.wc.action.replace("favlist","collection"))}),bw(b.oa,b.Gc,$(".toggle-comment",b.Gc)[0]))};a.Cy=function(b){By||(this.un=b,this.rh=$(this.un.h()),setTimeout(v(this.gf,this)))},a.Dy=$("#is-topstory2").length?"topstory2":"homefeed",a.By=B&&!E(9),a.Ey={ac:"actioncard",q:"question",a:"answer",p:"article",c:"column",r:"roundtable"},a.Fy={question:"question",answer:"question",article:"column",column:"column",roundtable:"roundtable"},a.Gy={question:"question",answer:"question",article:"article",column:"column",roundtable:"roundtable"};
Cy.prototype.gf=function(){this.EA=$('meta[itemprop="ZReactor"]',this.rh);if(this.EA.length){var b=this,c=Ey[this.rh.data("type")];Ht(this.rh[0],function(){Hy(b,"display")},this.un);this.un.m().e(this.un,"expand",function(d){d.target instanceof lw&&Hy(b,"expand_"+c)}).e(this.un,"collapse",function(d){d.target instanceof lw&&Hy(b,"collapse_"+c)});this.rh.on("click",'a[name="nohelp"]',function(){var c=!!$(this).data("revert");Hy(b,c?"unhelpful":"revert_unhelpful");$(this).data("revert",!c)});$.each({".actioncard-body .more":"view_all",
".actioncard-body .next:not(.disabled)":"next_page",".actioncard-body .prev:not(.disabled)":"prev_page",".actioncard-body .items a":"open_topic",'.zg-follow[data-follow^="t:"], .zg-btn-follow[data-follow^="t:"]':"follow_topic",'.zg-unfollow[data-follow^="t:"], .zg-btn-unfollow[data-follow^="t:"]':"unfollow_topic",'a.zg-follow:not([data-follow^="t:"]):not([data-follow^="m:"])':"follow_"+Fy[c],'a.zg-unfollow:not([data-follow^="t:"]):not([data-follow^="m:"])':"unfollow_"+Fy[c],"a.toggle-comment":"expand_comments",
'a[name="addnew"]':"comment",".content h2 a":"open_"+Gy[c],"a.ignore:not(.close)":"uninterest","a.revert":"revert_uninterest","a.ignore.close":"confirm_uninterest","button.up.pressed":"vote_up_"+c,"button.down.pressed":"vote_down_"+c,"button.up:not(.pressed)":"revert_vote_up_"+c,"button.down:not(.pressed)":"revert_vote_down_"+c,'a[name="favo"]':"collect_answer",'a[name="thanks"]':"thanks",'a[name="share"]':"share",'a[name="report"], .js-report':"report","a.answer-date-link":"open_answer"},function(c,
e){b.rh.on("click",c,function(){Hy(b,e)})});this.NN()}};a.Iy=function(b){setTimeout(function(){$.ajax({type:"POST",url:"/zreactor/deliver",data:JSON.stringify(b),contentType:"application/json",processData:m})},50)},a.Hy=function(b,c){var d=$.extend({},Jy(b),{action_type:c});d.object_id&&("display"===c?b.SQ(d):Iy(d))},a.Ky=[],a.Ly=fl(550,function(){Ky.length&&(Iy(Ky),Ky=[])});Cy.prototype.SQ=function(b){Ky.push(b);Ly()};
a.Jy=function(b){var c=b.EA,d=$.extend({},c.data("meta"),{create:b.rh.find(".source .time").data("timestamp"),offset:$(".feed-item").index(b.rh)+1});return{mid:qh.ga_vars.user_hash,object_type:Ey[b.rh.data("type")],object_id:c.data("id"),object_meta:d,context:Dy,others:""}};
Cy.prototype.NN=Fk(function(){O(W,"click_feed_fresh",function(b){Iy({mid:qh.ga_vars.user_hash,object_type:"btn",object_id:2,object_meta:{load_items:b.data.count},action_type:"click",context:Dy,others:""})});O(W,"topstory_feed_more",function(){Iy({mid:qh.ga_vars.user_hash,object_type:"btn",object_id:1,object_meta:{next:$("#js-home-feed-list .feed-item").length+1},action_type:"click",context:Dy,others:""})})});a.Ny=function(b,c,d){mu.call(this,b,c,d);this.ly=m;this.Aj=!!$("#is-topstory2").length;this.GA=$("#zh-topstory2-nomore");this.AA=My(this);this.ku=$("#zh-topstory2-newblock");this.FA=$("#zh-topstory2-loading-newblock")};z(Ny,mu);a.Oy={ROUNDTABLE_ADD_RELATED:"roundtable",ARTICLE_VOTE_UP:"post_vote",ARTICLE_CREATE:"post_create",RECOMMENDED:"feed_recommended",QUESTION_FOLLOW:"feed_question_follow",QUESTION_CREATE:"feed_question",ANSWER_VOTE_UP:"feed_answer_vote",ANSWER_CREATE:"feed_answer_answer"};
t=Ny.prototype;t.z=function(){Ny.n.z.call(this);this.Aj&&(this.ku.click($.proxy(this.IO,this)),Py(this))};
a.Py=function(b){var c=Qy(b);c.each(function(d){var e=$(this),d=c.eq(d+1);if(d.length&&e.data("block")!==d.data("block"))return My(b).insertBefore(d),m})},a.Qy=function(b){return $(b.Cb()).filter("[data-block]")},a.My=function(b){var c;b.AA?(c=b.AA.detach(),!b.ly&&Ry(b)&&Ht(c[0],function(){Sy(this)},b)):c=$('<div class="feed-separator"><span>上次读到这里</span></div>');return c},a.Ry=function(b){var c=Qy(b).eq(0).data("block");return 0<$("."+b.Tf+"[data-block="+c+"]").length},a.Sy=function(b){b.dispatchEvent("shownewblockbtn");
b.ku.show()};
t.IO=function(){this.dispatchEvent("hidenewblockbtn");this.ku.hide();var b=Qy(this),c=$("html, body").animate({scrollTop:0},"slow").promise();1800<$.now()/1E3-parseInt(b.eq(0).data("block"),10)?window.location.reload():(this.Me="more",this.FA.show(),this.Gj(j,k,function(b){this.FA.hide();b&&b.msg.length?(this.Km(b.msg,"prepend"),160<Qy(this).length?window.location.reload():c.then($.proxy(function(){Py(this)},this))):(this.ly=j,c.then(function(){Bi({title:"提示信息",Ql:j,content:'<p>暂时没有更多动态</p><p><a href="/topics">关注更多话题，丰富动态中的内容</a></p>',Y:j,
Df:["确定"]})}))}))};t.Sg=function(b){b&&!b.r&&(b=b.msg,b.length?(Q(this.Yb,0<b.length),this.GA.hide(),this.Km(b),this.Aj&&Py(this),pu(this,m),ru(this)):(this.Ak.hide(),this.GA.show(),this.Aj&&(!this.ly&&Ry(this))&&Sy(this)))};t.nN=function(b){var c=b.currentTarget.g.getAttribute("data-feedtype"),c=Oy[c];"comment"===b.namespace&&c&&b.wc.fill("category","feed").fill("label",c)};t.Nj=function(b){var c=Hw(b);this.H(c);this.m().e(c,"click!",this.nN);c.o(b);new Cy(c);return c};
t.Gj=function(b,c,d){if(this.Aj&&"live"!==this.Me&&"more"!==this.Me){W.ga({type:"topstory_feed_more"});var e=Qy(this),e=e.eq(e.length-1),g=e.data("block");this.params.block_id=g;this.offset=e.data("offset")}Ny.n.Gj.call(this,b,c,d)};t.yG=function(b){if(this.Aj){var c={};"live"===b.start?(c.action="live",c.limit=b.offset):"more"===b.start?c.action="more":(c.action="next",c.block_id=b.block_id,c.offset=b.offset);b=c}return{params:b,method:"next"}};a.Ty=function(){this.interval=3E4};ia(Ty);a.Vy=function(b,c){if(!b.Zc||c)c&&clearInterval(b.Zc),b.Zc=setInterval(v(function(){Uy(this)},b),b.interval)},a.Uy=function(b,c){$(".feed-item-hook .time").each(function(){$(this).text(ct($(this).data("timestamp")))});c&&Vy(b,c)};a.Wy=function(){T.call(this);this.Ex={};this.Fs=[];this.jO="old"===$("#feed-ver").val();this.OE=!!$("#is-topstory").length;this.Aj=!!$("#is-topstory2").length;this.YC=this.jO?"zm-item":"feed-item-hook";window._gaq=window._gaq||[];this.OE?window._gaq.push(["_setCustomVar",5,"is_topstory",j,3]):window._gaq.push(["_setCustomVar",5,"is_topstory",m,3])};z(Wy,T);t=Wy.prototype;
t.z=function(){Wy.n.z.call(this);this.J=$(this.g);if(this.se=J("zh-main-feed-fresh-button"))this.zk=$(this.se),this.Aj?(this.m().e(this.se,"click",this.iR),this.m().e(W,"topstory2",this.ZD)):this.OE?(this.m().e(this.se,"click",this.hR),this.m().e(W,"topstory",this.ZD)):(this.m().e(this.se,"click",this.nS),this.m().e(W,"homefeed",this.TM));this.Qa=new Ny(this.g,k,j);this.getParent()&&this.getParent().H(this.Qa);var b="/node/"+$(this.g).data("init").nodename;this.Qa.url=b;this.Qa.li("feed-item-hook");
this.m().e(this.Qa,"itemcreated",function(b){Xy(this,b.data.wO)}).e(this.Qa,"afterload",function(b){W.ga({type:"ga_click_feed_more",data:b.data})}).e(this.Qa,"ignore",function(b){var c=b.key,g=b.value;H.forEach(this.Ex,function(b){b.cr[c]===g&&$(b.g).fadeOut(150)})}).e(this.Qa,"shownewblockbtn",function(){this.zk.addClass("force-hide")}).e(this.Qa,"hidenewblockbtn",function(){this.zk.removeClass("force-hide").hide();this.ih=0});this.Qa.B();this.J.on("click",".js-more-similar",function(){$(this).parent().slideUp("fast").nextUntil(":not(.hidden)").slideDown("fast")});
var c=this;this.J.on("click",".js-change-some",function(){Yk("feed","intrests-change");var b=$(this),e=$(this).parent().parent();$.post("/node/HomeExtraFeedList",{method:"next",params:{}}).done(function(g){!g.r&&g.msg&&(0<g.msg.length?(e.find(".feed-item-hook").remove(),e.append(g.msg).find(".feed-item-hook").each(function(){c.Qa.Nj(this)})):b.replaceWith('<span class="zg-right zg-gray">没有更多内容了</span>'))})})};
t.hR=function(){this.zk.text("加载中…");this.ih=0;var b=this;this.Qa.offset=0;this.Qa.Me=0;this.Qa.Gj(j,function(){Mh(b.Qa,function(b){$(b.h()).remove()})}).done(function(){b.zk.hide();ou(b.Qa)})};t.iR=function(){this.zk.text("加载中…");var b=this.ih;this.ih=0;var c=this;this.Qa.offset=b;this.Qa.Me="live";this.Qa.Gj(j,k,function(b){b&&b.msg.length&&(c.Qa.Km(b.msg,"prepend"),c.zk.hide())});W.ga({type:"click_feed_fresh",data:{count:b}})};
t.nS=function(){var b=K("zm-home-question-list-devider",this.g);b&&F.remove(b,"zm-home-question-list-devider");var b=this.Fs.length,c=$("."+this.YC,this.g)[0];c&&5<=b&&($(".feed-separator-hook",this.g).next(".feed-item-hook").css("border-top","1px solid #eee").end().remove(),$(c).css("border-top","none").before('<div class="feed-item-hook feed-separator-hook feed-separator"><span>上次你看到这里</span></div>'));A.forEach(this.Fs,function(b){var c=$("."+this.YC,this.g)[0];c?ic(b,c):this.g.appendChild(b)},
this);this.Fs=[];Q(this.se,m);c=Ty.N();Uy(c,j);W.ga({type:"ga_click_feed_fresh",data:{count:b}})};
t.TM=function(b){var c=Ma(b.Ic),b=this.Fs,d=b.length;if(c&&!(500<d)){var e=ec(c),c=this.Ex;if(!H.kr(c,function(b){return b.h().id===e.id})){var g=this.Qa.Nj(e);if(g.ka){if(H.kr(c,function(b){return b.ka===g.ka}))return}else if(g.ha){if(H.kr(c,function(b){return b.ha===g.ha}))return}else if(g.pb&&H.kr(c,function(b){return b.pb===g.pb}))return;Xy(this,g);b.push(e);d+=1;this.se&&(this.se.innerHTML=(99<d?"99+":d)+" 条新动态",Q(this.se,j))}}};
t.ZD=function(b){this.ih=this.ih||0;this.ih+=+b.Ic;this.se&&(this.se.innerHTML=(99<this.ih?"99+":this.ih)+" 条新动态",Q(this.se,j))};a.Xy=function(b,c){var d=Gh(Fh.N());b.Ex[d]=c;$(c.g).attr("data-fid",d)};a.Yy=function(){};z(Yy,T);t=Yy.prototype;t.z=function(){Yy.n.z.call(this);var b=J("zh-invite-select");b&&this.m().e(b,"change",this.xy);(b=K("zm-invite-list"))&&this.m().e(b,"click",this.ua);(this.dx=J("zh-invite-ignore-all-btn"))&&this.m().e(this.dx,"click",this.EN)};
t.ua=function(b){if((b=b.target)&&b.name){if("ignore"===b.name){this.cX=b;this.dX=j;F.add(b,"zg-btn-disabled");this.FN=new V(m);var c="qid="+b.getAttribute("data-qid")+"&uid="+S.Ge+"&op=pass";this.FN.ajax("/question/askpeople",c,"POST");(c=b.parentNode)&&Hk(c,j)}"recover"===b.name&&!this.IG&&(this.GG=b,this.IG=j,F.add(b,"zg-btn-disabled"),b.innerHTML="...",this.HG=new V(m),this.m().e(this.HG,"success",this.rJ),b="qid="+b.getAttribute("data-qid")+"&uid="+S.Ge+"&op=recover",this.HG.ajax("/question/askpeople",
b,"POST"))}};t.xy=function(b){var c=Vr(new vf(location.href),"filter_by");if((b=b.target)&&b.value)b=b.value,b!==c&&(window.location.href="/question/invited?filter_by="+b)};t.rJ=function(){this.IG=m;this.Zb(this.GG,"ignore");this.GG.name="ignore"};
t.Zb=function(b,c){var d=b.parentNode,e=K("zm-invite-item-info-label",d);"ignore"===c?(F.remove(b,"zg-btn-disabled"),F.remove(b,"recover"),F.add(b,"ignore"),F.add(d,"invite"),F.remove(d,"ignore"),e.innerHTML="新邀请",b.name="ignore",b.innerHTML="忽略"):(F.remove(b,"zg-btn-disabled"),F.remove(b,"ignore"),F.add(b,"recover"),F.remove(d,"invite"),F.remove(d,"draft"),F.add(d,"ignore"),e.innerHTML="已忽略",b.name="recover",b.innerHTML="恢复")};
t.EN=function(){this.ex||(this.ex=j,this.nE=new V(m),this.m().e(this.nE,"success",this.pJ),this.nE.ajax("/question/askpeople","uid="+S.Ge+"&op=ignore_all","POST"))};t.pJ=function(){this.ex=m;Q(this.dx);this.ex=m;A.forEach(Ub("zm-invite-item-control"),v(function(b){this.Zb(b,"recover")},this))};a.Zy=function(){T.call(this)};z(Zy,T);Zy.prototype.z=function(){Zy.n.z.call(this);this.ul();this.m().e(this.g,"click",this.ua)};Zy.prototype.ua=function(b){b=b.target;if(b.name)switch(b.name){case "fold":$(b).parent().hide().prev().animate({height:"show"},200);break;case "fold-follow":$(b).parent().hide().prev().show();break;case "unfold-item":$(b).parent(".author-list").hide().siblings(".hidden").show()}};
Zy.prototype.ul=function(){this.mo||(this.mo=j,this.Ij=new V(m),this.m().e(this.Ij,"success",this.uy),this.Ij.ajax("/noti7/calendar","","GET"))};Zy.prototype.uy=function(){this.mo=m;var b=He(this.Ij);if(b){var c=J("zh-noti7-list-inner");/category/.test(b)?(c.innerHTML=b,c&&(b=new mu(c,"/noti7/calendar",j),b.Km=function(b){var c=L("div","zm-item-more-wrap");c.innerHTML=b;ic(c,this.Yb)},b.Gr=function(b){this.Me=this.Yb.getAttribute("data-next");return!b||b.msg[0]&&b.msg[1]},b.B())):c.innerHTML='<div class="empty"><span class="zg-gray-normal">您收到的消息会显示在这里</span></div>'}};a.$y=function(){N.call(this);this.bx=[];this.uC=[]};z($y,Im);$y.prototype.B=function(){var b=J("home-suggest-block");b&&(this.g=b,b=J("home-suggest-close-button"),ne(this.m(),b,"click",function(){(new V(j)).ajax("/option","key=no_show_lookup&value=1");Q(this.g,m)}),b=J("home-suggest-refresh-button"),this.m().e(b,"click",this.ZP),this.us=J("home-suggest-list"),az(this))};$y.prototype.ZP=function(){bz(this);return j};
a.bz=function(b){for(var c=[],d=0;3>d;d++){var e=b.uC.shift();e&&c.push(e)}3===c.length?(b.us.innerHTML=c.join(""),c=Ub("suggest-item",b.us),A.forEach(c,function(b){this.bx.push(b.id.split("-")[1])},b)):az(b)},a.az=function(b){b.us.innerHTML='<img class="bubble-loading" src="http://static.zhihu.com/static/img/noti-loading.gif">';$.post("/lookup/suggest_member",{ids:b.bx.join(",")}).done(v(b.xP,b))};
$y.prototype.xP=function(b){b.r||((b=b.msg)&&la(b)&&b.length?(this.bx=[],this.uC=b,bz(this)):this.us.innerHTML="")};a.cz=function(){T.call(this)};z(cz,T);cz.prototype.B=function(){tr.H(this);this.o(document.body)};
cz.prototype.z=function(){cz.n.z.call(this);var b=J("js-home-feed-list");if(b){var c=new Wy;this.H(c);c.o(b)}(b=K("zm-invite-container"))&&(new Yy).o(b);J("home-settings-page-wrap")&&(b=J("zh-topic-block-editor"))&&(new Ss(jh)).o(b);(b=J("zh-noti7"))&&(new Zy).o(b);if(c=J("zm-home-sidebar-domain-entry-link"))b=!!c.getAttribute("data-expanded"),c=new Hj(c,J("zm-home-sidebar-domain-entry-nav"),b),b&&vd(c,"toggle",function(){Ei("/notifeature?feature=4",k,"GET");return j});$(".zm-side-pinned-topics").on("click",
".unpin",function(){var b=$(this).parent();$.post("/pin-topic/remove",{tid:$(this).attr("data-tid")}).done(function(c){c.r||b.fadeOut()})});if(b=$("#zh-virgin-answer-list > .zh-general-list").get(0))c=new Jt,this.H(c),c.ma("nodeSource").ma("childConstructor",{Pi:tw}),c.o(b),this.m().e(c,"click!",function(b){"comment"===b.namespace&&b.wc.fill("category","debuts").fill("label","debuts")});(new $y).B();var b=S[1],d=J("zu-welcome-once");d&&("welcome"===location.hash.slice(1)?(Q(d,j),Nf.set("reg_noti_",
b,86400)):b===Nf.get("reg_noti_")&&Q(d,j),O(K("x-m",d),"click",function(){location.hash="";M(d);Nf.remove("reg_noti_")}));var e=$(".user-guiding-box");if(0!==e.length){var b=$(".view-avatar",e),c=$(".view-headline",e),g=$(".view-email",e),h=[];c.length&&h.push(c);b.length&&h.push(b);g.length&&h.push(g);var l=function(){var b=h.shift();if(0===h.length)Pk()?Qk(e,"fadeOut",function(){e.remove()}):e.remove();else{var c=h[0];Pk()?Qk(b,"fadeOutRight10",function(){b.remove();c.show();Qk(c,"fadeInLeft10")}):
(b.remove(),c.show())}},n=this;$(".js-noavatar",e).on("click",function(){$.post("/node/HomeGuideV2",{method:"ignore",params:{ignored_entry:"avatar"}});l();dz("close_avatar")});$(".js-noheadline",e).on("click",function(){$.post("/node/HomeGuideV2",{method:"ignore",params:{ignored_entry:"headline"}});l();dz("close_headline")});var q=new Bx(Ax);q.o($(".js-uploadavatar",e));q.on("success",function(b){b.src&&($.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:q.getData().id}}},function(b){b&&
!b.r&&$(".avatar-edit-preview-loading").remove()}),$(".zu-top-nav-userinfo img.avatar").attr({src:b.src.url}),l(),dz("upload_avatar"))},m,this);var r=$("form",c);r.validate({submitHandler:function(b){$.post("/node/HomeGuideV2",{method:"add_headline",params:{headline:$('input[name="headline"]',b).val()}},function(b){b&&b.r?263===b.errcode?n.showErrors({headline:"介绍过长"}):n.showErrors({headline:"保存失败"}):(l(),dz("add_headline"))})},messages:{headline:{required:"不能为空",maxlength:"介绍过长"}},rules:{headline:{maxlength:40}},
errorPlacement:function(b){b.appendTo($(".button-wrapper",r))},focusCleanup:j,focusInvalid:m})}var w=$("#js-global-notify");if(w.length){var x=new Vo;x.o(w[0]);Tr(x);$(".zu-global-notify-close",w).click(function(){var b=$(this).data("id");$.post("/notice/read",{nid:b});x.G();w.remove()})}b=Ty.N();Vy(b);var G=$("#js-debuts-entry .tour");G.length&&$(".close-button",G).click(function(){var b=$(this).data("feature");$.get("/notifeature",{feature:b});G.fadeOut(100,function(){G.remove()})})};
a.dz=function(b){ym({t:"event",tid:"zhihu.web.register",action:b})};a.ez=function(){Uh.call(this,k,m);this.EB="zh-lightbox-showing";this.QS="zh-lightbox-thumb";this.gf()};z(ez,Uh);ia(ez);t=ez.prototype;t.gf=function(){this.m().e(document,"click",this.xr)};
t.xr=function(b){b=b.target;if("IMG"===b.tagName&&F.has(b,this.QS)){var c=b.getAttribute("data-original");if(c)if(rb)window.open(c);else if(!Hc(b,k,"editable")){this.Ea('<div class="zm-light-box-x1" id="zm-light-box-x1"><div class="zm-light-box-x2" id="zm-light-box-x2"><img src="'+c+'" class="zm-light-box-img-el" /><div class="zm-light-box-footer"><a class="zm-light-box-show-origin" href="'+c+'" target="_blank">查看原图</a></div></div></div>');this.D(j);F.add(this.h(),"zm-light-box-fullscreen-image");
var c=Xb(),d=J("zm-light-box-x1"),e=J("zm-light-box-x2"),g=b.getAttribute("data-rawheight"),h=b.getAttribute("data-rawwidth"),h=h?+h:0;(g?+g:0)>c.height-80?e.style.marginTop="40px":d.style.lineHeight=c.height+"px";e.style.width=h>c.width-80?c.width-80+"px":h+"px";W.ga({type:"ga_click_enlarge_image",target:b})}}};t.Y=ha;t.focus=ha;t.FM=function(){this.D(m);F.remove(document.body,this.EB)};t.di=function(){ez.n.di.call(this);F.add(document.body,this.EB);ne(this.m(),document,"click",this.FM)};
t.v=function(){ez.n.v.call(this);F.add(this.h(),"zm-light-box")};t.Xx=function(){this.Oc=this.K().v("div",this.zc+"-bg zm-light-box-background");Q(this.Oc,m)};ez.N();a.fz=function(b,c,d){Rt.call(this,b,c,d);this.oi(j)};z(fz,Rt);fz.prototype.Zd=function(){return this.dispatchEvent("action")};mj("goog-option",function(){return new fz(k)});a.gz=function(){};z(gz,Qm);ia(gz);gz.prototype.v=function(b){return b.K().v("div",this.M()+" goog-inline-block"," ")};gz.prototype.o=function(b,c){c=gz.n.o.call(this,b,c);F.add(c,"goog-inline-block");return c};gz.prototype.M=s("goog-toolbar-separator");a.hz=function(){};z(hz,Sm);ia(hz);hz.prototype.qc=function(){return Uc.YI};hz.prototype.An=function(b){return"HR"==b.tagName?new Rm(gz.N()):hz.n.An.call(this,b)};hz.prototype.M=s("goog-toolbar");hz.prototype.rw=function(){return Um};a.iz=function(){};z(iz,Wt);ia(iz);iz.prototype.M=s("goog-toolbar-button");a.jz=function(b,c,d){vj.call(this,b,c||iz.N(),d)};z(jz,vj);mj("goog-toolbar-button",function(){return new jz(k)});a.kz=function(){};z(kz,Yt);ia(kz);kz.prototype.createCaption=function(b,c){return kz.n.createCaption.call(this,lz(b,c),c)};a.lz=function(b,c){return c.v("div","goog-color-menu-button-indicator",b)};kz.prototype.Aa=function(b,c){b&&mz(this.V(b),c)};a.mz=function(b,c){if(b&&b.firstChild){var d;d=c&&(hs.test("#"==c.charAt(0)?c:"#"+c)||Fs(c).length||Hs&&Hs[c.toLowerCase()])?pt(c).Jr:k;b.firstChild.style.borderBottomColor=d||(B?"":"transparent")}};
kz.prototype.ze=function(b){this.Aa(b.h(),b.S());F.add(b.h(),"goog-color-menu-button");kz.n.ze.call(this,b)};a.nz=function(){};z(nz,$i);ia(nz);a.oz=0;t=nz.prototype;t.v=function(b){var c=this.cf(b);return b.K().v("div",c?c.join(" "):k,pz(this,b.bb(),b.xl(),b.K()))};a.pz=function(b,c,d,e){for(var g=[],h=0,l=0;h<d.height;h++){for(var n=[],q=0;q<d.width;q++){var r=c&&c[l++];n.push(qz(b,r,e))}g.push(e.v("tr",b.M()+"-row",n))}return b.qv(g,e)};t.qv=function(b,c){var d=c.v("table",this.M()+"-table",c.v("tbody",this.M()+"-body",b));d.cellSpacing=0;d.cellPadding=0;Lc(d,"grid");return d};
a.qz=function(b,c,d){b=d.v("td",{"class":b.M()+"-cell",id:b.M()+"-cell-"+oz++},c);Lc(b,"gridcell");return b};t.dc=s(m);t.o=s(k);
t.Ea=function(b,c){if(b){var d=Tb("tbody",this.M()+"-body",b)[0];if(d){var e=0;A.forEach(d.rows,function(b){A.forEach(b.cells,function(b){hc(b);if(c){var d=c[e++];d&&b.appendChild(d)}})});if(e<c.length){for(var g=[],h=Rb(b),l=d.rows[0].cells.length;e<c.length;){var n=c[e++];g.push(qz(this,n,h));g.length==l&&(n=h.v("tr",this.M()+"-row",g),d.appendChild(n),g.length=0)}if(0<g.length){for(;g.length<l;)g.push(qz(this,"",h));n=h.v("tr",this.M()+"-row",g);d.appendChild(n)}}}sg(b,j,C)}};
a.rz=function(b,c,d){for(c=c.h();d&&1==d.nodeType&&d!=c;){if("TD"==d.tagName&&F.has(d,b.M()+"-cell"))return d.firstChild;d=d.parentNode}return k},a.sz=function(b,c,d,e){d&&(d=d.parentNode,F.enable(d,b.M()+"-cell-hover",e),Mc(c.h().firstChild,"activedescendent",d.id))};t.M=s("goog-palette");a.uz=function(b){N.call(this);this.Ad=[];tz(this,b)};z(uz,Fd);t=uz.prototype;t.dg=k;t.of=k;t.tl=function(){return this.Ad.length};t.Rh=function(b){return this.Ad[b]||k};a.tz=function(b,c){c&&(A.forEach(c,function(b){this.km(b,m)},b),A.extend(b.Ad,c))};t.Ga=function(b){this.Gi(b,this.tl())};t.Gi=function(b,c){b&&(this.km(b,m),A.Un(this.Ad,b,c))};t.removeItem=function(b){b&&A.remove(this.Ad,b)&&b==this.dg&&(this.dg=k,this.dispatchEvent("select"))};t.Eg=p("dg");t.Cb=function(){return A.clone(this.Ad)};
t.pf=function(b){b!=this.dg&&(this.km(this.dg,m),this.dg=b,this.km(b,j));this.dispatchEvent("select")};t.wl=function(){return this.dg?A.indexOf(this.Ad,this.dg):-1};t.dp=function(b){this.pf(this.Rh(b))};t.clear=function(){A.clear(this.Ad);this.dg=k};t.w=function(){uz.n.w.call(this);delete this.Ad;this.dg=k};t.km=function(b,c){b&&("function"==typeof this.of?this.of(b,c):"function"==typeof b.qm&&b.qm(c))};a.vz=function(b,c,d){oj.call(this,b,c||nz.N(),d);this.Ji&=-89};z(vz,oj);t=vz.prototype;t.kc=k;t.Eb=-1;t.la=k;t.w=function(){vz.n.w.call(this);this.la&&(this.la.G(),this.la=k);this.kc=k};t.nm=function(b){vz.n.nm.call(this,b);wz(this);this.la?(this.la.clear(),tz(this.la,b)):(this.la=new uz(b),b=v(this.km,this),this.la.of=b,this.m().e(this.la,"select",this.nj));this.Eb=-1};t.Cg=s("");t.mm=ba();
t.kd=function(b){vz.n.kd.call(this,b);var c=rz(this.L,this,b.target);(!c||!b.relatedTarget||!rc(c,b.relatedTarget))&&c!=xz(this)&&yz(this,c)};t.Uh=function(b){vz.n.Uh.call(this,b);var c=rz(this.L,this,b.target);(!c||!b.relatedTarget||!rc(c,b.relatedTarget))&&c==xz(this)&&sz(this.L,this,c,m)};t.we=function(b){vz.n.we.call(this,b);this.Xb()&&(b=rz(this.L,this,b.target),b!=xz(this)&&yz(this,b))};t.Zd=function(b){var c=xz(this);return c?(this.pf(c),vz.n.Zd.call(this,b)):m};
t.Vb=function(b){var c=this.bb(),c=c?c.length:0,d=this.kc.width;if(0==c||!this.isEnabled())return m;if(13==b.keyCode||32==b.keyCode)return this.Zd(b);if(36==b.keyCode)return this.Nb(0),j;if(35==b.keyCode)return this.Nb(c-1),j;var e=0>this.Eb?this.wl():this.Eb;switch(b.keyCode){case 37:-1==e&&(e=c);if(0<e)return this.Nb(e-1),b.preventDefault(),j;break;case 39:if(e<c-1)return this.Nb(e+1),b.preventDefault(),j;break;case 38:-1==e&&(e=c+d-1);if(e>=d)return this.Nb(e-d),b.preventDefault(),j;break;case 40:if(-1==
e&&(e=-d),e<c-d)return this.Nb(e+d),b.preventDefault(),j}return m};t.nj=ba();t.xl=p("kc");a.zz=function(b,c){b.h()&&f(Error("Component already rendered"));b.kc=oa(c)?new Nb(c,i):c;wz(b)},a.xz=function(b){var c=b.bb();return c&&c[b.Eb]};t.Nb=function(b){b!=this.Eb&&(Az(this,this.Eb,m),this.Eb=b,Az(this,b,j))};a.yz=function(b,c){var d=b.bb();b.Nb(d?A.indexOf(d,c):-1)};t.wl=function(){return this.la?this.la.wl():-1};t.Eg=function(){return this.la?this.la.Eg():k};t.dp=function(b){this.la&&this.la.dp(b)};
t.pf=function(b){this.la&&this.la.pf(b)};a.Az=function(b,c,d){if(b.h()){var e=b.bb();e&&(0<=c&&c<e.length)&&sz(b.L,b,e[c],d)}};t.km=function(b,c){this.h()&&b&&F.enable(b.parentNode,this.L.M()+"-cell-selected",c)};a.wz=function(b){var c=b.bb();if(c)if(b.kc&&b.kc.width){if(c=Math.ceil(c.length/b.kc.width),!oa(b.kc.height)||b.kc.height<c)b.kc.height=c}else c=Math.ceil(Math.sqrt(c.length)),b.kc=new Nb(c,c);else b.kc=new Nb(0,0)};a.Bz=function(b,c,d){this.Fq=b||[];vz.call(this,k,c||nz.N(),d);this.Fq=this.Fq;this.Hs=k;this.Ea(A.map(this.Fq,function(b){var c=this.K().v("div",{"class":this.L.M()+"-colorswatch",style:"background-color:"+b});"#"==b.charAt(0)&&(b=Gs(b),b="RGB ("+[parseInt(b.substr(1,2),16),parseInt(b.substr(3,2),16),parseInt(b.substr(5,2),16)].join(", ")+")");c.title=b;return c},this))};z(Bz,vz);Bz.prototype.Hs=k;Bz.prototype.Aw=function(){var b=this.Eg();return b?(b=tt(b,"background-color"),Cz(b)):k};
Bz.prototype.cp=function(b){b=Cz(b);this.Hs||(this.Hs=A.map(this.Fq,function(b){return Cz(b)}));this.dp(b?A.indexOf(this.Hs,b):-1)};a.Cz=function(b){if(b)try{return pt(b).Jr}catch(c){}return k};a.Dz=function(b,c,d,e){$t.call(this,b,c,d||kz.N(),e)};z(Dz,$t);
a.Ez={sU:"#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "),CV:"#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "),gV:"#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ")},a.Fz=
function(b){var c=new Ut(b);H.forEach(Ez,function(d){d=new Bz(d,k,b);zz(d,8);c.H(d,j)});return c};t=Dz.prototype;t.Aw=function(){return this.S()};t.cp=function(b){this.Aa(b)};t.Aa=function(b){for(var c=0,d;d=this.Rh(c);c++)"function"==typeof d.cp&&d.cp(b);Dz.n.Aa.call(this,b)};t.Hn=function(b){"function"==typeof b.target.Aw?this.Aa(b.target.Aw()):"none"==b.target.S()&&this.Aa(k);Dz.n.Hn.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.sb=function(b,c){b&&0==this.tl()&&(this.fh(Fz(this.K())),this.Aa(this.S()));Dz.n.sb.call(this,b,c)};mj("goog-color-menu-button",function(){return new Dz(k)});a.Gz=function(){};z(Gz,Yt);ia(Gz);Gz.prototype.M=s("goog-toolbar-menu-button");a.Hz=function(){};z(Hz,Gz);ia(Hz);Hz.prototype.createCaption=function(b,c){return Zt(lz(b,c),this.M(),c)};Hz.prototype.Aa=function(b,c){b&&mz(this.V(b),c)};Hz.prototype.ze=function(b){this.Aa(b.h(),b.S());F.add(b.h(),"goog-toolbar-color-menu-button");Hz.n.ze.call(this,b)};a.Iz=function(b,c,d,e){Dz.call(this,b,c,d||Hz.N(),e)};z(Iz,Dz);mj("goog-toolbar-color-menu-button",function(){return new Iz(k)});a.Jz=function(b,c,d,e){$t.call(this,b,c,d||Gz.N(),e)};z(Jz,$t);mj("goog-toolbar-menu-button",function(){return new Jz(k)});a.Lz=function(b,c,d,e){$t.call(this,b,c,d,e);Kz(this,b);this.ap(Uc.QA)};z(Lz,$t);t=Lz.prototype;t.la=k;t.Bv=k;t.z=function(){Lz.n.z.call(this);Mz(this);Nz(this);Mc(this.h(),Tc.Ck,"false")};t.$=function(b){Lz.n.$.call(this,b);(b=this.Cg())?Kz(this,b):this.dp(0)};t.w=function(){Lz.n.w.call(this);this.la&&(this.la.G(),this.la=k);this.Bv=k};t.Hn=function(b){this.pf(b.target);Lz.n.Hn.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.nj=function(){var b=this.Eg();Lz.n.Aa.call(this,b&&b.S());Mz(this)};t.fh=function(b){var c=Lz.n.fh.call(this,b);b!=c&&(this.la&&this.la.clear(),b&&(this.la?Mh(b,function(b){Oz(b);this.la.Ga(b)},this):Pz(this,b)));return c};a.Kz=function(b,c){b.Bv=c;Mz(b)};t.Ga=function(b){Oz(b);Lz.n.Ga.call(this,b);this.la?this.la.Ga(b):Pz(this,this.Ta())};t.Gi=function(b,c){Oz(b);Lz.n.Gi.call(this,b,c);this.la?this.la.Gi(b,c):Pz(this,this.Ta())};t.removeItem=function(b){Lz.n.removeItem.call(this,b);this.la&&this.la.removeItem(b)};
t.pf=function(b){if(this.la){var c=this.Eg();this.la.pf(b);b!=c&&this.dispatchEvent("change")}};t.dp=function(b){this.la&&this.pf(this.la.Rh(b))};t.Aa=function(b){if(b!=k&&this.la)for(var c=0,d;d=this.la.Rh(c);c++)if(d&&"function"==typeof d.S&&d.S()==b){this.pf(d);return}this.pf(k)};t.Eg=function(){return this.la?this.la.Eg():k};t.wl=function(){return this.la?this.la.wl():-1};
a.Pz=function(b,c){b.la=new uz;c&&Mh(c,function(b){Oz(b);this.la.Ga(b)},b);Nz(b)},a.Nz=function(b){b.la&&b.m().e(b.la,"select",b.nj)},a.Mz=function(b){var c=b.Eg();b.Ea(c?c.Cg():b.Bv)},a.Oz=function(b){b.ap(b instanceof Rt?Uc.TA:Uc.RI)};t.sb=function(b,c){Lz.n.sb.call(this,b,c);this.qb()&&this.Ta().Nb(this.wl())};mj("goog-select",function(){return new Lz(k)});a.Qz=function(b,c,d,e){Lz.call(this,b,c,d||Gz.N(),e)};z(Qz,Lz);mj("goog-toolbar-select",function(){return new Qz(k)});a.Rz=function(b){var c=b.indexOf(",");a:{b=(-1!=c?b.substring(0,c):b).toLowerCase();for(c=0;2>c;c++){var d="\"'".charAt(c);if(b.charAt(0)==d&&b.charAt(b.length-1)==d){b=b.substring(1,b.length-1);break a}}}return b},a.Sz=function(b,c){A.forEach(c,function(c){var e=c.caption,c=c.value,g=Rz(c),e=new fz(e,c,b.K());Jh(e,g);b.Ga(e);e.V().style.fontFamily=c})},a.Tz=[10,10,13,16,18,24,32,48],a.Vz=function(b,c,d,e,g,h){d=new jz(Uz(d,e,h),g,h);Jh(d,b);d.Mc(c);return d},a.Wz=function(b,c,d,e,g,h){b=Vz(b,c,d,
e,g,h);rj(b,16,j);return b},a.Xz=function(b,c,d,e,g,h){g=new Qz(k,k,g,h);e&&A.forEach(e.split(/\s+/),g.vh,g);g.vh("goog-toolbar-select");Kz(g,d);Jh(g,b);g.Mc(c);return g},a.Yz=function(b,c,d,e,g,h){d=new Iz(Uz(d,e,h),k,g,h);Jh(d,b);d.Mc(c);return d},a.Uz=function(b,c,d){if((!b||""==b)&&C&&!E("1.9a"))b=" ";return(d||Rb()).v("DIV",c?{"class":c}:k,b)};a.Zz=y("Link");y("Edit Link");y("Text to display:");a.$z=y("Link to:");y("Web address");y("Link to a page or file somewhere else on the web");y("Test this link");
y("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.",{startBold:"<b>",endBold:"</b>",searchEngineLink:"<a href='http://www.google.com/' target='_new'>",endLink:"</a>"});y("To what URL should this link go?");y("Email address");y("Link to an email address");y("Invalid email address");
y("To what email address should this link?");y("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.",{preb:"<b>",postb:"</b>"});y("Open this link in a new window");y("Image");a.aA={},a.bA=y("Normal"),a.cA=y("Normal / serif"),a.dA=[{caption:bA,value:"arial,sans-serif"},{caption:cA,value:"times new roman,serif"},{caption:"Courier New",value:"courier new,monospace"},{caption:"Georgia",value:"georgia,serif"},{caption:"Trebuchet",value:"trebuchet ms,sans-serif"},{caption:"Verdana",value:"verdana,sans-serif"}],a.eA={ja:[{caption:"ＭＳ Ｐゴシック",value:"ms pgothic,sans-serif"},{caption:"ＭＳ Ｐ明朝",value:"ms pmincho,serif"},{caption:"ＭＳ ゴシック",value:"ms gothic,monospace"}],ko:[{caption:"굴림",
value:"gulim,sans-serif"},{caption:"바탕",value:"batang,serif"},{caption:"굴림체",value:"gulimche,monospace"}],"zh-tw":[{caption:"新細明體",value:"pmingliu,serif"},{caption:"細明體",value:"mingliu,serif"}],"zh-cn":[{caption:"宋体",value:"simsun,serif"},{caption:"黑体",value:"simhei,sans-serif"},{caption:"MS Song",value:"ms song,monospace"}]},a.fA=y("Small"),a.gA=y("Normal"),a.hA=y("Large"),a.iA=y("Huge"),a.jA=[{caption:fA,value:1},{caption:gA,value:2},{caption:hA,value:4},{caption:iA,value:6}],a.kA=y("Heading"),
a.lA=y("Subheading"),a.mA=y("Minor heading"),a.nA=y("Normal"),a.oA=[{caption:kA,va:"H2"},{caption:lA,va:"H3"},{caption:mA,va:"H4"},{caption:nA,va:"P"}],a.pA=function(b,c,d,e,g,h){var l=Vz(b,c,d,e,g,h);l.ui=function(b){l.Za(b)};return l},a.qA=function(b,c){var d=c;try{if(B)var e="000000"+d.toString(16),g=e.substr(e.length-6,6),d="#"+g.substring(4,6)+g.substring(2,4)+g.substring(0,2);d!=b.S()&&b.Aa(d)}catch(h){}},a.rA=y("Format"),a.sA=y("Format"),a.tA=y("Undo"),a.uA=y("Redo"),a.vA=y("Font"),a.wA=y("Font size"),
a.xA=y("Text color"),a.yA=y("Bold"),a.zA=y("Italic"),a.AA=y("Underline"),a.BA=y("Text background color"),a.CA=y("Add or remove link"),a.DA=y("Numbered list"),a.EA=y("Bullet list"),a.FA=y("Decrease indent"),a.GA=y("Increase indent"),a.HA=y("Align left"),a.IA=y("Align center"),a.JA=y("Align right"),a.KA=y("Justify"),a.LA=y("Remove formatting"),a.MA=y("Insert image"),a.NA=y("Strikethrough"),a.OA=y("Left-to-right"),a.PA=y("Right-to-left"),a.QA=y("Quote"),a.RA=y("Edit HTML source"),a.SA=y("Subscript"),
a.TA=y("Superscript"),a.UA=y("Edit HTML"),a.VA={};
aA.OA=[{va:"+undo",R:tA,La:"tr-icon tr-undo",factory:pA,eb:j},{va:"+redo",R:uA,La:"tr-icon tr-redo",factory:pA,eb:j},{va:"+fontName",R:vA,La:"tr-fontName",factory:function(b,c,d,e,g,h){var l=Xz(b,c,d,e,g,h),b="en-us".replace(/_/,"-").toLowerCase(),c=[];b in eA&&(c=eA[b]);c.length&&Sz(l,c);Sz(l,dA);Kz(l,bA);F.add(l.Ta().V(),"goog-menu-noaccel");l.ui=function(b){var c=k;b&&0<b.length&&(c=Kh(l.Ta(),Rz(b)));c!=l.Eg()&&l.pf(c)};return l},eb:j},{va:"+fontSize",R:wA,La:"tr-fontSize",factory:function(b,c,
d,e,g,h){var l=Xz(b,c,d,e,g,h);A.forEach(jA,function(b){var c=b.value,b=new fz(b.caption,c,l.K());l.Ga(b);b=b.V();b.style.fontSize=(Tz[c]||10)+"px";b.firstChild.style.height="1.1em"});Kz(l,gA);F.add(l.Ta().V(),"goog-menu-noaccel");l.ui=function(b){var c;if(c=na(b))c=b.match(Is),c="px"==(c&&c[0]||k);c&&(b=A.lastIndexOf(Tz,parseInt(b,10)));b=0<b?b:k;b!=l.S()&&l.Aa(b)};return l},eb:j},{va:"+bold",R:yA,La:"tr-icon tr-bold",eb:j},{va:"+italic",R:zA,La:"tr-icon tr-italic",eb:j},{va:"+underline",R:AA,La:"tr-icon tr-underline",
eb:j},{va:"+foreColor",R:xA,La:"tr-icon tr-foreColor",factory:function(b,c,d,e,g,h){b=Yz(b,c,d,e,g,h);b.cp("#000");b.ui=xa(qA,b);return b},eb:j},{va:"+backColor",R:BA,La:"tr-icon tr-backColor",factory:function(b,c,d,e,g,h){b=Yz(b,c,d,e,g,h);b.cp("#FFF");b.ui=xa(qA,b);return b},eb:j},{va:"+link",R:CA,caption:Zz,La:"tr-link",eb:j},{va:"+insertOrderedList",R:DA,La:"tr-icon tr-insertOrderedList",eb:j},{va:"+insertUnorderedList",R:EA,La:"tr-icon tr-insertUnorderedList",eb:j},{va:"+outdent",R:FA,La:"tr-icon tr-outdent",
factory:Vz},{va:"+indent",R:GA,La:"tr-icon tr-indent",factory:Vz},{va:"+justifyLeft",R:HA,La:"tr-icon tr-justifyLeft",eb:j},{va:"+justifyCenter",R:IA,La:"tr-icon tr-justifyCenter",eb:j},{va:"+justifyRight",R:JA,La:"tr-icon tr-justifyRight",eb:j},{va:"+justifyFull",R:KA,La:"tr-icon tr-justifyFull",eb:j},{va:"+removeFormat",R:LA,La:"tr-icon tr-removeFormat",factory:Vz},{va:"image",R:MA,La:"tr-icon tr-image",factory:Vz},{va:"+strikeThrough",R:NA,La:"tr-icon tr-strikeThrough",eb:j},{va:"+subscript",R:SA,
La:"tr-icon tr-subscript",eb:j},{va:"+superscript",R:TA,La:"tr-icon tr-superscript",eb:j},{va:"ltr",R:OA,La:"tr-icon tr-ltr",eb:j},{va:"rtl",R:PA,La:"tr-icon tr-rtl",factory:function(b,c,d,e,g,h){var l=Wz(b,c,d,e,g,h);l.ui=function(b){b=!!b;F.enable(l.getParent().h(),"tr-rtl-mode",b);l.Yc(b)};return l},eb:j},{va:"+BLOCKQUOTE",R:QA,La:"tr-icon tr-BLOCKQUOTE",eb:j},{va:"+formatBlock",R:rA,caption:sA,La:"tr-formatBlock",factory:function(b,c,d,e,g,h){var l=Xz(b,c,d,e,g,h);A.forEach(oA,function(b){var c=
b.caption,b=b.va,d=l.K(),c=new fz(d.v("DIV",k,c),b,d);Jh(c,b);l.Ga(c)});Kz(l,nA);F.add(l.Ta().V(),"goog-menu-noaccel");l.ui=function(b){b=b&&0<b.length?b:k;b!=l.S()&&l.Aa(b)};return l},eb:j},{va:"editHtml",R:RA,caption:UA,La:"tr-editHtml",factory:Vz}];for(var WA=0,XA;XA=aA.OA[WA];WA++)VA[XA.va]=XA;delete aA.OA;a.YA={};YA.bT=Yk;a.ZA=function(b){Vu.call(this);this.da=new le(this);this.iE=L("div",{style:"display:none"});this.g=this.pc=k;this.F={};H.extend(this.F,this.defaults,b||{})};z(ZA,Vu);ya(ZA.prototype,YA);ZA.prototype.defaults={pk:k,title:"Distraction Free Mode",RJ:"back",LR:"publish",mw:"zu-editing-distraction-free",zS:"sticky-goog-scrollfloater",ZS:"zm-editable-toolbar-container"};ZA.prototype.jd=lf("FullScreenPlugin");VA.toggleFullScreen={va:"toggleFullScreen",R:"写作模式",La:"tr-icon tr-max",factory:Vz};t=ZA.prototype;
t.Ce=xa(H.vg,{NV:"toggleFullScreen",iU:"enterFullScreen",jU:"exitFullScreen"});t.w=function(){this.da.G();M(this.g);this.F=this.vp=this.pc=this.tb=this.g=k;ZA.n.w.call(this)};
t.Yu=function(){var b=this.F,c=document.createElement("div");c.id="zu-distraction-free-editor";c.innerHTML='<div class="header"><div class="wrapper"><h1 class="title">'+b.title+'</h1><a href="#" class="'+b.RJ+'" name="return">返回</a><a href="#" class="'+b.LR+'" name="save">发布</a></div></div><div class="toolbar"><div class="tools"></div></div><div class="content" class="grid"></div>';document.body.appendChild(c);this.da.e(K("back",c),"click",function(b){b.preventDefault();$A(this)},m,this);this.da.e(K("publish",
c),"click",function(b){b.preventDefault();this.dispatchEvent("save")&&$A(this)},m,this);this.g=c;this.pc=K("content",c);this.vp=L("div",{className:"toolbar-info"});this.F.pk||(this.F.pk=this.C.field)};a.aB=function(b){if(b.vp){var c=$(b.vp);c.stop().text("草稿已经保存").fadeTo(600,0.5).delay(3E3).fadeOut(600,function(){c.text("")})}};t.$e=function(b){this.g||this.Yu();switch(b){case "enterFullScreen":bB(this);break;case "exitFullScreen":$A(this);break;case "toggleFullScreen":this.yx()?$A(this):bB(this)}};
t.yx=function(){return F.has(document.body,this.F.mw)};
a.bB=function(b){if(b.dispatchEvent("willEnterFullScreen")){b.RC||(b.zN=history.length);b.RC=j;cB(b,"writing");b.kI=Kc(Rb((fa||window).document));lc(b.iE,b.F.pk);b.pc.appendChild(b.F.pk);F.add(document.body,b.F.mw);b.tb=K(b.F.ZS,b.g);b.tb.appendChild(b.vp);var c=b.g;c.scrollTop=0;var d=b.tb.getBoundingClientRect().top;c.onscroll=pf(v(b.jH,b),function(){return c.scrollTop>d});b.da.e(document,"keydown",b.Co,m,b);Ma(Ec(b.C.field))||b.C.Pf();b.dispatchEvent("enterFullScreen")}},a.$A=function(b){!Mg&&
b.RC&&b.zN!==history.length?history.back():cB(b,"");b.tb.removeChild(b.vp);b.jH(m);b.g.onscroll=k;b.da.Fa(document,"keydown",b.Co,m,b);lc(b.F.pk,b.iE);F.remove(document.body,b.F.mw);window.scrollTo(b.kI.x,b.kI.y);b.dispatchEvent("exitFullScreen")},a.cB=function(b,c){wd(window,"hashchange",b.RF,m,b);location.hash=c||"";setTimeout(v(function(){this.da.e(window,"hashchange",this.RF,m,this)},b))};t.RF=function(){this.yx()?$A(this):"writing"===location.hash.slice(1)&&bB(this)};
t.Co=function(b){27===b.keyCode&&this.dispatchEvent("shouldExitFullScreenOnEscape")&&$A(this)};t.jH=function(b){F[b?"add":"remove"](this.tb,this.F.zS)};a.eB=function(b,c){N.call(this);this.Xf=b;this.zz=c||dB;b.mb||(this.show=ha)};z(eB,Im);a.dB="加载中...";t=eB.prototype;
t.show=function(){jc(this.g=L("div","zg-mt10",[L("h3",{style:"margin:0 0 5px;"},"分享到微博"),L("div","zm-tab-content",[this.gW=L("div",{className:"zg-section zg-clear",innerHTML:'<label><input data-bindurl="/oauth/auth/sina?next=/oauth/callback" class="sina-checkbox" type="checkbox"><i class="zg-ico-sina"></i> 新浪微博</label> '}),L("div","zg-section",L("div","zg-form-text-input",this.ep=L("textarea",{style:"width:100%;height: 66px;"},"加载中..."))),L("div","zm-command",[L("div",["zm-item-meta","zg-left"],this.bS=
L("span")),this.BS=L("a",{"class":"zg-btn-blue weibo-share-button",href:"javascript:;"},"分享到微博")])])]),J("zh-question-answer-form-wrap"));this.m().e(W,"sina_callback",function(b){this.vz(b.Ic.id,b.Ic.name)});this.Pu();this.Pj();Mm.N().refresh();var b=this;this.zz===dB?Ei("/answer/"+b.Xf.mb+"/sharetext",function(c){if((c=Ie(c.target))&&c.sina)b.zz=c.sina,b.nb()},"GET"):this.nb()};t.vz=function(b,c){ph.name=c;this.qS=ph.id=b;this.vc.checked=j;this.Pj()};
t.Pj=function(){var b=K("weibo-share-button",this.g),c=this.vc.checked;F.enable(b,"zg-btn-blue",c);F.enable(b,"zg-btn-disabled",!c)};t.nb=function(){this.ep.value=this.zz;this.Kz=new Pm(this.ep);this.qH=new xu(this.ep,this.bS,140,vu);this.m().e(this.BS,"click",this.ua)};t.Pu=function(){this.vc=K("sina-checkbox",this.g);this.m().e(this.vc,"change",this.By)};t.By=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.vc&&!this.qS?(window.open(c),b.checked=m):this.Pj()};
t.ua=function(b){if((b=b.target)&&F.has(b,"zg-btn-blue")&&this.ep.value){b=new Vk(j);b.add("content",this.ep.value);var c=[];this.vc.checked&&c.push("sina");b.add("via",c.join(","));this.Uj(b);Yk("share",this.fX?"answer_weibo":"question_weibo")}else U("请您选择或绑定微博后再进行分享！")};t.Uj=function(b){b.add("aid",this.Xf.ka);this.xhr=new V(j);ne(this.m(),this.xhr,"complete",this.Du);this.xhr.ajax("/answer/share",b.hd())};t.Du=function(){var b=Ie(this.xhr);b&&b.r?U(b.msg):(U("分享发送完毕"),Q(this.g,m))};a.fB=function(b,c,d){Rt.call(this,b,c,d);this.Wo(j)};z(fB,Rt);mj("goog-checkbox-menuitem",function(){return new fB(k)});a.gB=function(b,c){N.call(this);this.ha=b;this.Ib=c;this.data=dh};z(gB,Im);t=gB.prototype;
t.B=function(){this.cm=J("zh-question-redirect-info");this.cm.innerHTML&&(this.bo=j);this.m().e(this.cm,"click",function(b){"cancel"===b.target.name&&hB(this)});var b=J("zh-question-side-header-wrap");if(bh.uc&&!bh.PE&&b){var c=J("zh-question-filter-wrap");c?ic(b,c):b.style[B?"styleFloat":"cssFloat"]="none"}(this.Yf=J("zh-question-operation-menu"))&&this.uj();this.m().e(Ki,"anon_change",function(b){var c=J("zh-question-side-invitation-anon");c&&Q(c,b.ib);(c=J("zh-question-side-invitation-notanon"))&&
Q(c,!b.ib);this.Vl&&this.Vl.Za(ht(this.data.Zg)||!b.ib)});(this.tk=J("zh-question-webshare-container"))&&this.m().e(this.tk,"click",this.Gz)};
t.uj=function(){this.cb=new Ut;var b=this.data.Lm,c=this.Yf.getAttribute("data-auth"),c=c?c.split(","):[];if(b==k||0===b){this.cb.Ga(this.Ns=iB("使用匿名身份",j));this.Ns.Yc(this.data.ib);if((!kh||!A.contains(kh,"question_op_redirect"))&&"close"!==dh.status)this.cb.Ga(this.Vl=iB(this.bo?"撤消重定向":"问题重定向")),this.Vl.Za(ht(this.data.Zg)||!this.data.ib);A.contains(c,"auth-f-manage")&&this.cb.Ga(this.uQ=iB("更新话题页显示",m));this.m().e(this.cb,"action",this.mj);this.Ns&&this.m().e(Ki,"anon_change",function(b){this.Ns.Yc(!!b.ib)});
this.Ib&&A.contains(c,"auth-pu-mark")&&(this.cb.Ga(this.Dy=iB("优质回答",j)),this.Dy.Yc(this.Ib.lO));b=new $t("Settings",this.cb);b.$j=j;cu(b);b.o(this.Yf)}};a.iB=function(b,c){return!b?new Tt:c?new fB(b):new Rt(b)};
t.mj=function(b){var c=this.Ns;if(b.target===c)Zr(c.Be()?1:0,function(b){b||c.Yc(!c.Be())});else if(b.target===this.Vl){if(ny({am:j})()===m)return m;this.Ko||(this.Ko=new Wx(this.ha),this.m().e(this.Ko,"change",this.OO));this.cb.D(m);this.bo?hB(this):this.Ko.show()}else b.target===this.pQ?Ei("/question/"+this.data.mb+(this.pQ.Be()?"/unlock_summary":"/lock_summary"),function(){top!==window?top.location.href="/question/"+dh.mb:window.location.reload()},"POST"):b.target===this.uQ?$.post("/refresh_topic_feeds",
{q:dh.mb}).done(function(b){b.r||U("操作成功！")}):b.target===this.Dy&&$.post("/answer/"+this.Ib.mb+(this.Dy.Be()?"/good_mark":"/good_unmark")).done(function(b){b.r||U("操作成功！")})};t.OO=function(){this.cm.innerHTML='<div class="zg-wrap"><div class="zu-global-nitify-inner"><span class="zu-global-notify-icon"></span>此问题将跳转至 <a href="/question/'+this.Ko.mt+'">'+this.Ko.AG+'</a> （<a href="javascript:;" name="cancel">撤消重定向</a>）</div></div>';Q(this.cm,j);this.bo=j;this.Vl.mm("撤消重定向")};
a.hB=function(b){b.cm.innerHTML="";Q(b.cm,m);b.bo=m;b.Vl.mm("问题重定向");Ei("/question/unredirect",k,"POST","qid="+b.ha+"&rqid="+b.mt)};t.Gz=function(b){var c=Uk(this.tk,b.target);c&&c.name&&Hm(function(){var b=$("#zh-question-webshare-container").data();new yu([b.title,b.type,b.urlToken,{answer:{aid:b.id},question:{qid:b.id}}[b.type]],"tb-webshare-"+c.name);W.ga({type:"ga_click_share_question_box",target:c,data:{type:c.name}})},function(){return{cd:"letter"===c.name}})()};a.jB=function(b){qp.call(this,j,"/topic/bio/update","bio");this.xp=b[0];this.params=["tid="+this.xp[3]];this.content=b[1];this.Hb='<a href="javascript:;" name="edit">描述你关于 '+this.xp[0]+" 的经验</a>";this.Yt=j};z(jB,qp);jB.prototype.Eh=function(){jB.n.Eh.call(this);this.Tk.innerHTML="更新"};jB.prototype.$=function(b){jB.n.$.call(this,b);var b=this.K(),c=b.v("strong",k,L("a",{href:"/topic/"+this.xp[1],title:this.xp[0],"class":""},this.xp[0]));b.Vn(c,this.Qb)};a.kB=function(b,c){N.call(this);this.SN=c;this.Zk=b;this.items=[];this.gY="/url_to_fetch_question_related_topic_bio_items";this.Px=m};z(kB,Im);
a.lB=k,a.mB=function(){lB||(lB=new kB(fh,m));return lB},a.nB=function(b){if(!b.locked)if(!b.WO&&b.Px){b.locked=j;var c=new V(j);b.m().e(c,"success",function(b){this.WO=j;this.locked=m;b=Ie(b.target);b.r||(this.Zk=b.msg,nB(this))});c.ajax("/question/"+b.KG+"/bios",k,"GET")}else b.ca||(b.ca=new wi,b.ca.Va("修改话题经验"),fi(b.ca,k),$h(b.ca,m),c=b.ca.V(),c.innerHTML='<div class="zg-section-title">修改每个话题旁边靠近你名字的简介：</div>',b.X(c)),b.ca.D(j)};
kB.prototype.X=function(b){this.g=L("div","zu-bio-editor-wrap",[this.VN=L("div","zu-bio-editor-inner-wrap"),this.Ac=L("div","zm-command",[this.Tk=L("a",{name:"save",href:"javascript:;",className:"zg-r3px zg-btn-blue"},"完成")])]);A.forEach(this.Zk,function(b){b=new jB(b);b.X(this.VN);this.items.push(b)},this);this.SN&&Q(this.Ac,m);b.appendChild(this.g);this.m().e(this.Ac,"click",this.ua)};
kB.prototype.ow=function(){var b=this.items.length,c;if(!b&&this.Zk.length)for(c=0;c<this.Zk.length;c++)if(this.Zk[c][1])return this.Zk[c][1];var d=k;for(c=0;c<b;c++)if(d=this.items[c].bb())return d};kB.prototype.ua=function(b){if((b=this.bf(b.target))&&"save"===b.name)this.ca&&this.ca.D(m),this.dispatchEvent("change")};a.oB=function(b,c){T.call(this);this.kb=b;this.JW=this.kb.or();this.ir=Sr(this.kb);this.isContentEditable=this.kb.isContentEditable();this.SS=30;this.Zc=new Hd(1E3*this.SS);this.ha=dh?dh.ha:0;this.GE=c||m};z(oB,T);t=oB.prototype;t.w=function(){pB(this);this.Zc.G();oB.n.w.call(this)};
t.o=function(b){this.g=b;this.Ur=K("draft-saved-info",b);Q(this.Ur,m);this.tE=K("draft-saved-time",b);this.tK=K("draft-clear-button",b);this.uW=this.isContentEditable?dv:["change","input"];b=this.m().e(this.Zc,Id,this.nt).e(this.tK,"click",this.uK).e(this.ir,"keydown",this.xO);"oninput"in this.ir&&!B?b.e(this.ir,"input",this.XN):b.e(this.ir,"keydown",this.YN);var c=ah.Id&&1E3*ah.Id[1];c&&(qB(this,c),this.dA=setInterval(v(function(){qB(this,c)},this),22E3))};
t.xO=function(b){if((b.metaKey||b.ctrlKey)&&"s"===qk[b.keyCode])this.LO(),this.isContentEditable||b.preventDefault()};a.sB=function(b){rB(b,"保存中…");b.sn();b.WN()};t.sn=function(){$(window).on("beforeunload.DraftSaver",v(s("你的修改还未成功保存，确认离开该页面吗？"),this))};t.al=function(){$(window).off("beforeunload.DraftSaver")};t.XN=function(){tB(this);sB(this)};t.YN=function(b){rh(b.keyCode)&&(tB(this),sB(this))};a.tB=function(b){b.Zc.stop()};t.Ea=function(b){this.kb.Ea(b);this.kb.Yo()};t.bb=function(){return this.kb.df()};
t.WG=function(){if(!this.zg){var b=this.bb();if(b){rB(this,"保存中…");var b=(new Rl).add("qid",this.ha).add("content",b),c=new V;c.ajax("/answer/draft/save",b.toString(),"POST");this.m().e(c,"success",v(this.Ug,this));this.XE=c}}};t.vT=150;t.nt=fl(oB.prototype.vT,oB.prototype.WG);t.MO=350;t.LO=fl(oB.prototype.MO,oB.prototype.WG);t.ZN=3E3;t.WN=fl(oB.prototype.ZN,function(){this.zg||(this.bb()?this.nt():uB(this))});a.pB=function(b){b.dA&&(clearInterval(b.dA),b.dA=k)};
t.Ug=function(b){var b=Ie(b.target),c="",d=m;0===b.r?c="已保存":(c=b.msg||"保存失败！请稍后再试。",d=j);pB(this);Q(this.Ur,j);rB(this,c,d);this.al();"保存成功"===b.msg&&this.dispatchEvent("saveContent");this.Zc.start()};a.qB=function(b,c){var d=ct(c||za());/^\d/.test(d)&&(d=" "+d);rB(b,"已存于"+d)},a.rB=function(b,c,d){var e=$(b.tE);d?e.addClass("warning"):e.removeClass("warning");Q(b.Ur,j);wc(b.tE,c)};
t.uK=function(b){b.preventDefault();Bi("清除草稿",this.GE?"你确定要清除保存的草稿并取消编辑吗？":"你确定要清除保存的草稿吗？",function(b){b&&(this.GE?(uB(this),this.kb.dispatchEvent("cancel_edit"),this.kb.pi()):(this.Ea(""),uB(this),this.kb.ready(function(){var b=this.Ja;this.Qd?Wr(b,b.value.length):b.field.lastChild?Ur(b.field.lastChild):b.Pf();this.fl&&(this.fl.scrollTop=this.fl.scrollHeight)})))},this)};a.uB=function(b){Ei("/draft/delete",k,"POST","qid="+b.ha);b.XE&&(b.XE.abort(),b.al());pB(b);Q(b.Ur,m);b.dispatchEvent("clearContent")};a.vB=function(b,c,d){sp.call(this,m);this.ib=!!b;this.kg=c;this.Hb="&nbsp;";this.oq=d;this.Xt=this.Mv=this.hD=this.enabled=j;if(S.Fi||!S.na())this.Vx='<span style="font-style: normal;color: #999;">写回答…</span>'};z(vB,sp);t=vB.prototype;t.vD=function(){var b=Tb("h2","zm-editable-content",J("zh-question-title"))[0];return{title:b&&(/answer\/\d+$/.test(location.pathname)?Ec(b):b.firstChild.nodeValue)||"",pk:this.Zi}};t.ow=p("oq");t.st=ca("ib");
a.wB=function(b,c){b.oq=c?c:S[4];if(b.as&&$.trim(c)){var d=c;20<d.length&&(d=d.substring(0,17)+"...");b.ZJ.innerHTML="，"+Va(d)+'<a name="edit_bio" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a>'}};t.Za=function(b,c){this.enabled=b;this.as?(this.pi(),this.Hb=c,this.Qb.innerHTML=this.Hb):c&&(this.Hb=c)};t.$=function(b){vB.n.$.call(this,b);this.as=j;F.add(this.Qb,"zu-answer-form-disabled-wrap")};t.w=function(){this.Xr&&(M(this.Xr),this.bI=this.Xr=k);vB.n.w.call(this)};
t.ij=function(b){this.st(b.ib);this.cq&&(this.cq.checked=b.ib)};t.z=function(){vB.n.z.call(this);this.m().e(Ki,"anon_change",this.ij)};
t.xg=function(){vB.n.xg.call(this);var b=this.K(),c=S.na();this.Xr=b.v("div","zh-answer-form clearfix",[c?gt(this.kg):"",this.bI=b.v("div",k,[b.v("div","zu-answer-form-title",[c?ft(this.kg):"我来回答这个问题",this.ZJ=b.v("span")])])]);wB(this,this.oq);b.Vn(this.Xr,this.Zi);this.m().e(this.bI,"click",this.ua);S.na()?S.Fi||xB(this,'<div class="active-mask-tip-answer">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>'):xB(this,
'<div class="signin-mask-tip-answer"></div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>')};a.xB=function(b,c,d){c=$(c).css("top",0).css("z-index",9);$(b.Ac).hide();d=$(d);$(b.Zi).append(c).after(d);b=Hm(ha,{na:"question_answer_add_start",cd:j},"#draft");c.on("click",b);d.on("click",b)};
t.vr=function(b){switch(b){case "edit_bio":b=mB();if(!this.Qu){var c=dh.mb;b.Px=j;b.KG=c;this.m().e(b,"change",this.qy)}this.Qu=j;nB(b);break;case "cancel_delete":this.dispatchEvent("cancel_delete_answer");break;case "answer_my_question":var d=this;this.xk?this.xk.show():(d.xk=$('<div class="question-tip-box-bottom">确定想要回答你自己提出的问题吗？<br>如果需要对问题做出更多的解释和说明，请编辑问题描述。 如果需要对其他回答做出回应，请在相应回答下通过评论发布。<br><div class="zg-clear"><a href="javascript:;" class="zg-right zg-btn zg-btn-blue" name="confirm">确定</a><a href="javascript:;" class="zg-right zg-link-gray " name="cancel">取消</a></div></div>'),
d.xk.on("click",'[name="cancel"]',function(){d.xk.hide()}).on("click",'[name="confirm"]',function(){d.xk.hide();$(d.Qb).hide();d.Za(j);d.rf()}),$(d.Qb).after(d.xk))}return j};t.ne=function(){"editing"===this.status?this.Ab&&Q(this.Ab,j):this.Ab&&Q(this.Ab,m);Q(this.dd,m);this.Qb&&Q(this.Qb,!this.enabled)};t.CK='<div class="zm-command clearfix"><div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div><% if (questionStatus !== "normal") { %><span class="zg-gray-normal" style="margin-right:5px;">被<%= statusText %>的问题不允许添加新的回答</span><a class="zg-right" data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a><% } %><span class="<%= (questionStatus !== "normal" ? "hidden" : "") %>"><label style="cursor:pointer"><input name="anno-checkbox" type="checkbox">匿名</label> <a class="submit-button zg-btn-blue" name="save" href="javascript:;">发布回答</a></span></div>';
t.Eh=function(){var b=$k(this.CK);this.Ac=ec(b({questionStatus:dh.status,statusText:{suggest:"建议修改",evaluate:"建议修改",close:"关闭"}[dh.status]}));this.Tk=$(".submit-button",this.Ac)[0];var b=$("input[name=anno-checkbox]",this.Ac)[0],c=$("label",this.Ac)[0];this.cq=b;dh.ib&&(this.cq.checked=j);sg(c,j);this.Ab.appendChild(this.Ac);this.ready(function(){if(this.Ja&&this.Ja.on)this.Ja.on("load",this.px,m,this)})};
t.px=function(){var b=new oB(this);Qc(this,b);this.m().e(b,"saveContent",function(){var b=!this.Qd&&this.Ja.Sh("FullScreenPlugin");b&&aB(b)},m,this);var c=Sr(this);this.m().e(c,"focus",function(){b.Zc.start()}).e(c,"blur",function(){tB(b);b.nt()}).e(this,"saveSuccess",function(){tB(b);uB(b)});b.o(this.Ac);this.JC=b};t.qy=function(){var b=mB().ow();b&&wB(this,b)};a.yB=function(b,c,d,e,g,h){sp.call(this,e,c,d,h);this.ha=b;this.ao=this.Oo=m;this.BQ=g};z(yB,sp);a.zB=[{value:"精简文字描述",label:"精简文字描述"},{value:"补充必要的信息",label:"补充必要的信息"},{value:"改进标点或格式",label:"改进标点或格式"},{value:"other",label:"其他"}];t=yB.prototype;t.o=function(b){yB.n.o.call(this,b);this.m().e(Ki,"anon_change",this.ij)};t.ij=function(b){this.ao||F.enable(this.g,"zm-editable-disabled",b.ib)};
t.Eh=function(){yB.n.Eh.call(this);var b=L("a",{"class":"zg-right zg-link-litblue",href:"http://www.zhihu.com/question/19550238/answer/12202028",target:"_blank"},"为什么问题可以被公共编辑？"),c=L("select",{style:"1px solid #999 "}),d=L("option",{value:"none"},"请选择一个修改理由...");c.appendChild(d);A.forEach(zB,function(b,d){var e=L("option",{value:b.value},d+1+". "+b.label);c.appendChild(e)});this.Xy=L("div",{"class":"zm-editable-require-reason-wrap",style:"padding:10px 0 0 0"},[b,this.RX=c,this.uF=L("span"),this.eR=
L("div",{"class":"zg-form-text-input",style:"height:22px;margin:10px 0 0 0;display:none"},this.dR=L("textarea",{style:"width:100%;height:22px !important;min-height:22px !important;"}))]);ic(this.Xy,this.Ac);this.Oo&&this.mi(" * 必选","zg-gray-normal");var e=Tb("select",k,this.Xy)[0];this.m().e(e,"change",function(){Q(this.eR,"other"===e.value);this.mi(" * 必选","zg-gray-normal")})};
t.Ug=function(b){var c=Tb("select",k,this.Xy)[0],d=c.value;if(this.Oo){if("none"===d){this.mi("请选择一个修改理由");return}if("other"===c.value&&(d=Jk(this.dR.value),!d)){this.mi("请填写修改理由");return}}"title"===this.Pq&&-1===b.indexOf("?")&&-1===b.indexOf("？")?this.mi("还没有输入问号"):("none"===d&&(d=""),this.params=["id="+this.ha+"&reason="+encodeURIComponent(d)+"&question_id="+this.ha],this.dispatchEvent("change"),yB.n.Ug.call(this,b),this.mi("* 必选","zg-gray-normal"),this.Oo=j)};
t.mi=function(b,c){this.uF.innerHTML=b;F.set(this.uF,c||"zg-error-text")};t.df=function(){return this.Qd&&this.BQ?Kk(Ia(this.Ja.value)):yB.n.df.call(this)};t.Ze=function(){$(window).on("beforeunload.EditorWithReason",v(s("你对问题的修改还未保存，确认离开该页面吗？"),this))};t.Hf=function(){$(window).off("beforeunload.EditorWithReason")};t.pi=function(){yB.n.pi.call(this);this.Hf()};t.rf=function(){yB.n.rf.call(this);this.Ze()};a.AB=function(b,c){Ut.call(this,b,c);this.Jm=j;this.Le(j);this.D(m,j);this.tf=new Nd};z(AB,Ut);t=AB.prototype;t.WS=m;t.TE=0;t.Ve=k;t.$=function(b){AB.n.$.call(this,b);(b=b.getAttribute("for")||b.htmlFor)&&this.attach(this.K().h(b),1)};t.z=function(){AB.n.z.call(this);Ld.forEach(this.tf,this.uB,this);var b=this.m();b.e(this,"action",this.kP);b.e(this.K().Ca(),"mousedown",this.NF,j);D&&b.e(this.K().Ca(),"contextmenu",this.NF,j)};
t.attach=function(b,c,d,e,g){if(!b||!this.tf.Kd(ua(b)))b?(c={g:b,zH:c,UO:d,UC:e?"contextmenu":"mousedown",Yx:g},this.tf.set(ua(b),c),b=c):b=k,this.za&&this.uB(b)};t.uB=function(b){this.m().e(b.g,b.UC,this.dG)};t.detach=function(b){(!b||!this.tf.Kd(ua(b)))&&f(Error("Menu not attached to provided element, unable to detach."));b=ua(b);if(this.za){var c=this.tf.get(b);this.m().Fa(c.g,c.UC,this.dG)}this.tf.remove(b)};
a.BB=function(b,c,d,e,g){var h=b.Q();b.Cx()&&b.WS?b.hide():(b.Ve=g||k,b.dispatchEvent("beforeshow")&&(d="undefined"!=typeof d?d:4,h||(b.h().style.visibility="hidden"),Q(b.h(),j),c.Y(b.h(),d,e),h||(b.h().style.visibility="visible"),b.Nb(-1),b.D(j)))};t.oH=function(b,c,d){c=ka(b.zH)?new Ks(b.g,b.zH,j):new Js(c,d);c.om&&c.om(5);BB(this,c,b.UO,b.Yx,b.g)};t.hide=function(){this.Q()&&(this.D(m),this.Q()||(this.TE=za(),this.Ve=k))};t.Cx=function(){return this.Q()||150>za()-this.TE};t.kP=function(){this.hide()};
t.dG=function(b){for(var c=this.tf.Db(),d=0;d<c.length;d++){var e=this.tf.get(c[d]);if(e.g==b.currentTarget){this.oH(e,b.clientX,b.clientY);b.preventDefault();b.stopPropagation();break}}};t.NF=function(b){this.Q()&&!this.Ef(b.target)&&this.hide()};t.Tc=function(b){AB.n.Tc.call(this,b);this.hide()};t.w=function(){AB.n.w.call(this);this.tf&&(this.tf.clear(),delete this.tf)};a.CB=function(){T.call(this)};z(CB,T);CB.prototype.H=function(b,c){CB.n.H.call(this,b,c);this.m().e(b,"beforeexpand",this.lN)};CB.prototype.lN=function(b){var c=b.target;Mh(this,function(b){c!==b&&b.tc()&&b.Ka(m)})};CB.prototype.G=function(){this.m().G();CB.n.G.call(this)};a.DB=function(){Uh.call(this,i,i,i);this.Ih=j;this.D(j)};z(DB,wi);DB.prototype.z=function(){DB.n.z.call(this);yi(this,490);$(this.h()).addClass("user-guiding-dialog")};DB.prototype.Fd=function(b){$('[class^="view"]',this.g).hide();$(".view-"+b,this.g).show()};a.EB=function(b,c){T.call(this);this.bR=b;this.Zs=c;this.dO=this.Z=k;this.fd=m;this.Wn=k;this.Il=[];this.wH=[];this.Wg=j;this.JO="loading";this.CE="zg-btn-white";this.eO="invite-button"};z(EB,T);t=EB.prototype;t.v=function(){this.g=L("div",{style:"display:none",className:"question-invite-panel"})};
t.z=function(){EB.n.z.call(this);var b=this.g,c=this.m();if(!this.Wg){c.e(Ki,"anon_change",this.reload);var d=K("cancel-anon",b);d&&c.e(d,"click",this.fM);if(!K("error-message")){var d=K("search-input",b),e=K("invite-title",b);this.ux=K("invite-status",b);c.e(this.ux,"click",this.gM);var g=K("suggest-persons",b);g&&(c.e(g,"click",this.Rw),this.vH=g);$(".invite-status",b).on("mouseenter mouseleave",".invited-shortlist",function(b){$(".invited-hovercard",this).toggleClass("in","mouseenter"===b.type)});
this.mx(d,e);this.wH=$(this.vH).children().map(this.pG).get();this.Il=$(".invited-fulllist",this.ux).children().map(this.pG).get();var h=function(b){0>b||b>n-1||(w.find("li").hide().slice(4*b,4*(b+1)).show(),0===b?q.addClass("link-disabled"):q.removeClass("link-disabled"),b===n-1?r.addClass("link-disabled"):r.removeClass("link-disabled"),l=b)},b=this.g,l=0,n,q,r,w;w=$(".suggest-persons",b);n=w.find("li").length/4;q=$(".js-prev",b).on("click",function(){h(l-1)});r=$(".js-next",b).on("click",function(){h(l+
1)});h(0);Q(this.g,this.fd)}}};t.hb=function(){EB.n.hb.call(this);this.m().G()};t.Oi=s('<i class="icon icon-spike"></i><div class="spinner">正在加载，请稍等 <i class="spinner-gray"></i></div>');t.reload=function(){this.tc()?this.gi():this.Wg=j};t.gi=function(){var b=this,c=this.JO;this.hb();F.add(this.g,c);this.g.innerHTML=this.Oi();return $.get("/node/QuestionInvitePanelV2",{params:{question_id:this.bR}}).done(function(d){b.Wg=m;F.remove(b.g,c);d=ec(Ma(d));Q(d,b.tc());lc(d,b.g);b.g=d;b.z()})};
t.w=function(){EB.n.w.call(this);this.dO=k;this.Z.G()};t.tc=p("fd");t.expand=function(){this.Ka(j)};t.collapse=function(){this.Ka(m)};t.Ka=function(b){if(b!==this.fd){this.dispatchEvent(b?"beforeexpand":"beforecollapse");var c=v(function(){this.dispatchEvent(b?"expand":"collapse")},this);b&&this.Wg?this.gi().done(c):c();this.fd=b;Q(this.g,b)}};t.xf=function(){this.Ka(!this.fd)};
t.mx=function(b){var c=this,d=$k('<img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><span class="zu-autocomplete-row-name" title="<%-fullname%>"><%-fullname%></span><span class="zg-gray-normal zu-autocomplete-row-description"><%=headline%></span>');this.Z=new rm(b,{Xd:8,source:"/people/autocomplete?type=invite",hi:b.offsetParent,placeholder:"搜索你想邀请的人",Xc:function(b,c,h){h.innerHTML=d(b.data)},filter:function(b){return A.filter(b,function(b){var d=b.id;return!A.find(c.Il,function(b){return b.id===
d})})},select:function(b){FB(c,"ask_to_answer_search");jt(c.Zs,b.id,"search").done(function(d){if(d.r)return U(d.msg);GB(c,b);HB(c,b.id,j)});return""}})};a.IB=function(b,c,d){b=b.CE;d?(F.add(c,b),wc(c,"收回邀请")):(F.remove(c,b),wc(c,"邀请回答"))};t.fM=function(){Zr(0)};a.FB=function(b,c){var d=dh;b.dispatchEvent(new Kv("click!invitation",{category:"invitation",action:"ask_to_answer",label:c,value:d.LE?k:d.le}))};
t.Rw=function(b){var c=b.target;if("BUTTON"===c.tagName||F.has(c,this.eO)){this.Wn&&"pending"===this.Wn.state()&&this.Wn.abort();b="related"===c.getAttribute("data-type")?"recommended_relative_questions":"recommended_top_answerers";FB(this,b);var d=c.getAttribute("data-uid"),e=this.CE,g=v(function(b){b?(IB(this,c,j),b=A.find(this.wH,function(b){return b.id===d}),GB(this,b),this.mK()):(IB(this,c,m),JB(this,d))},this);F.has(c,e)?(this.Wn=it(this.Zs,d),g(m)):(this.Wn=jt(this.Zs,d,b).done(function(b){b.r&&
(U(b.msg),g(m))}),g(j))}};t.gM=function(b){b=b.target;"BUTTON"===b.tagName&&(b=b.getAttribute("data-uid"),it(this.Zs,b),HB(this,b,m),JB(this,b))};a.HB=function(b,c,d){var e=$(".invite-button",b.vH).filter(function(){return this.getAttribute("data-uid")===c}).get(0);e&&IB(b,e,d)};t.pG=function(){var b=$(this),c=$(".zm-item-link-avatar",b);return{id:String($("button",b).data("uid")),avatar:$("img",c).attr("src"),fullname:c.attr("title"),url_token:c.attr("href").split("/").slice(-1)[0]}};
a.GB=function(b,c){b.Il.unshift(c);KB(b);$(".ignore-invite-hint").css("display","none")},a.JB=function(b,c){b.Il&&A.oR(b.Il,function(b){return b.id===c})&&(KB(b),$(".ignore-invite-hint").css("display","none"))};t.cS='你已邀请 <span class="invited-shortlist"><% helper.each(persons.slice(0, 2), function(person, i, sliced) { %><a href="/people/<%=person.url_token%>" class="zg-link-gray"><%=person.fullname%></a><%= i !== sliced.length - 1 ? "、" : ""%><% }); %><%=helper.fullList()%></span><% if (persons.length > 2) { %> 等 <%=persons.length%> 人 <% } %>';
t.OL='<div class="invited-hovercard"><i class="icon icon-spike"></i><ul class="invited-fulllist"><% helper.each(persons, function(person, i) { %><li><a title="<%-person.fullname%>" class="zm-item-link-avatar" href="/people/<%=person.url_token%>"><img src="<%=person.avatar%>" class="zm-item-img-avatar"></a><a href="/people/<%=person.url_token%>" class="zg-link-gray" title="<%-person.fullname%>"><%=person.fullname%></a><button class="cancel-button zg-link-btn zg-link-gray" data-uid="<%=person.id%>">收回邀请</button></li><% }) %></ul></div>';
a.KB=function(b){var c=b.Il,d={each:A.forEach,fullList:function(){return $k(b.OL,{persons:c,helper:d})}};b.ux.innerHTML=c.length?$k(b.cS,{persons:c,helper:d}):""};t.mK=Fk(function(){S.Zg&&$.post("/question/popup",{action:"invite",question_token:dh.mb},function(b){if(b){var c=new DB;c.Va("邀请回答小窍门");c.Ea(b);c.Y();$(".js-close",c.g).on("click",function(){c.D(m)})}})});a.LB=function(b){this.data=b;this.oa=k};z(LB,T);t=LB.prototype;
t.z=function(){LB.n.z.call(this);this.m().e(this.g,"click",this.Fo);var b=K("panel-container",this.g);b&&(this.Pl=new CB,this.H(this.Pl),this.Pl.o(b),this.oa=new Xv(this.data.ha,"question"),this.Pl.H(this.oa),bw(this.oa,this.Pl.h(),$(".toggle-comment",this.g)[0]),this.vj(),"normal"===dh.status&&(b=new EB(this.data.ha,this.data.mb),b.X(this.Pl.h()),this.Pl.H(b),dh.lS&&(b.expand(),this.dispatchEvent(new Kv("show!invitation",{category:"invitation",action:"ask_to_answer_card",label:""}))),this.BE=b));
this.m().e(this,"click!",function(b){"comment"===b.namespace&&b.wc.fill("label","question")})};t.vj=function(){var b=$("a[name=report-question]",this.h());b.length&&ju(new gu("question",this.data.ha),b[0])};
t.Fo=function(b){var c=(b=Uk(this.g,b.target))&&b.name;if(c)switch(c){case "addcomment":"添加评论"===$.trim($(b).text())?Hm(this.sr,{na:"question_add_comment_start"}).call(this,b):this.sr(b);break;case "remove":Bi("删除问题","你确定要删除这个问题吗？相关的评论也将被删除。",function(b){if(b){var c=new V(j);O(c,"complete",function(){var b=Ie(c);b&&!b.r?window.location.href="/":U(b.msg)});c.ajax("/question/delete/"+this.data.ha)}},this);break;case "admin":c=this.kJ;c||(c=new AB,c.o(J("zh-question-admin-menu")),Mh(c,function(b){b.Aa(b.h().getAttribute("data-action"))}),
this.m().e(c,"action",function(b){b=this.bB=b.target;(new Lv).open(b.h(),{id:this.data.ha,type:"question"},v(this.HK,this))}),this.kJ=c);c.Q()?c.D(m):BB(c,new Ks(b,1,j),0,new Of(5,0,5,0));break;case "share":W.ga({type:"ga_click_share_question_box",target:b});this.sc();break;case "invite":this.Rw()}};t.sr=function(b){this.oa.xf();this.oa.tc()&&this.oa.ri("view_comments",parseInt(Ec(b),10)||0)};
t.Rw=function(){this.BE.xf();var b=this.BE.tc();this.dispatchEvent(new Kv("click!invitation",{category:"invitation",action:(b?"show":"hide")+"_ask_to_answer_card",label:"?",value:this.data.le}))};t.sc=Hm(function(){new yu(["分享问题","question",this.data.mb,{qid:this.data.ha}],"tb-webshare-sina")},{na:"question_question_share"});t.HK=function(b){this.bB.S(b.msg.action);this.bB.mm(b.msg.caption)};a.Fw=function(b,c){this.pb=b;this.entryType=c;this.$l=k;this.fd=m};z(Fw,T);t=Fw.prototype;t.tc=p("fd");t.Ka=function(b){this.fd=!!b};t.Sa=function(){return this.Kp.data("votecount")};t.gi=function(){this.$l&&"pending"===this.$l.state()||(this.$l=("post"===this.entryType?zw:lt)(this.pb,this.fd).done(v(this.ht,this)))};t.ht=function(b){if(b=Ma(b))b=$(b),this.Kp.replaceWith(b),this.Kp=b,this.nb(),this.dispatchEvent("change")};t.nb=function(){var b=this;$("a.more",this.Kp).click(function(){b.Ka(j);b.gi()})};
t.z=function(){this.Kp=$(this.g);this.nb()};a.MB=function(b){this.J=$(b);this.gf()};MB.prototype.gf=function(){var b=[this.J.get(0)].concat(this.J.parents().get()),c=$.map(b,function(b){return $(b).data("navigable")})[0],d=c&&$.grep(c.items(),function(c){return~$.inArray(c,b)})[0];this.xX=c;this.eP=d};MB.prototype.getItem=p("eP");a.NB=function(b,c,d,e){sp.call(this,b,c,d,e)};z(NB,sp);t=NB.prototype;t.z=function(){NB.n.z.call(this);this.ready(function(){if(this.Ja&&this.Ja.on)this.Ja.on("load",this.px,m,this)})};
t.px=function(){var b=new oB(this,j);Qc(this,b);this.m().e(b,"saveContent",function(){var b=!this.Qd&&this.Ja.Sh("FullScreenPlugin");b&&aB(b);$(this.yq).text("保存草稿并离开");$(this.g).find(".zu-edit-button span").text("修改（有未发布的编辑草稿）")}).e(b,"clearContent",function(){$(this.yq).text("取消");$(this.g).find(".zu-edit-button span").text("修改")});var c=Sr(this);this.m().e(c,"focus",function(){b.Zc.start()}).e(c,"blur",function(){tB(b);this.KK!==this.df()&&b.nt()}).e(this,"saveSuccess",function(){delete ah.Id;
tB(b);uB(b)}).e(this,"save_unchanged",function(){delete ah.Id;tB(b);uB(b)});b.o(this.Ac);ah.Id&&ah.Id[0]&&$(this.yq).text("保存草稿并离开")};
t.Eh=function(){this.Ac=L("div","zm-command",[this.DW=$('<div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$取消编辑并删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div>')[0],this.yq=L("a",{"class":"zm-command-cancel",name:"cancel",href:"#"},"取消"),this.Tk=L("a",{"class":"zg-r3px zg-btn-blue",name:"save",href:"#"},"发布")]);this.Ab.appendChild(this.Ac)};
t.aw=function(){var b=this;$.get("/draft/get",{qid:this.Po},function(c){c.r||(b.ut(c.msg),b.KK=c.msg)})};t.tD=function(){var b=[];if(!this.disabled){var c="修改";ah.Id&&ah.Id[0]&&(c="修改（有未发布的编辑草稿）");b.push('<a href="javascript:;" class="zu-edit-button" name="edit"><i class="zu-edit-button-icon"></i><span>'+c+"</span></a>")}return b.join("")};a.OB=function(){this.dv=[]};z(OB,Mt);ia(OB);OB.prototype.v=function(b){var c=OB.n.v.call(this,b);F.add(c,"goog-submenu");PB(this,b,c);return c};OB.prototype.o=function(b,c){c=OB.n.o.call(this,b,c);F.add(c,"goog-submenu");PB(this,b,c);var d=Tb("div","goog-menu",c);if(d.length){var e=new Ut(b.K()),d=d[0];Q(d,m);b.K().Ca().body.appendChild(d);e.o(d);b.fh(e,j)}return c};
OB.prototype.Ea=function(b,c){var d=this.V(b),e=d&&d.lastChild;OB.n.Ea.call(this,b,c);e&&(d.lastChild!=e&&F.has(e,"goog-submenu-arrow"))&&d.appendChild(e)};OB.prototype.ze=function(b){OB.n.ze.call(this,b);var c=b.V(),d=b.K(),d=Sb(d.Ha,"span","goog-submenu-arrow",c)[0];QB(b,d);d!=c.lastChild&&c.appendChild(d);Mc(b.h(),Tc.Ck,"true")};
a.PB=function(b,c,d){var e=c.K().v("span");e.className="goog-submenu-arrow";QB(c,e);b.V(d).appendChild(e)},a.QB=function(b,c){b.zd()?(F.add(c,"goog-submenu-arrow-rtl"),wc(c,b.aq?"◄":"►")):(F.remove(c,"goog-submenu-arrow-rtl"),wc(c,b.aq?"►":"◄"))};a.RB=function(b,c,d,e){Rt.call(this,b,c,d,e||OB.N())};z(RB,Rt);a.SB=218;t=RB.prototype;t.Ld=k;t.Fz=k;t.fE=m;t.lc=k;t.fr=m;t.aq=j;t.nO=m;t.z=function(){RB.n.z.call(this);this.m().e(this.getParent(),"hide",this.YF);this.lc&&TB(this,this.lc,j)};t.hb=function(){this.m().Fa(this.getParent(),"hide",this.YF);this.lc&&(TB(this,this.lc,m),this.fr||(this.lc.hb(),M(this.lc.h())));RB.n.hb.call(this)};t.w=function(){this.lc&&!this.fr&&this.lc.G();this.lc=k;RB.n.w.call(this)};
t.pd=function(b,c){RB.n.pd.call(this,b);c&&(this.Ta().Wf=j);b||(this.Ld&&Kd(this.Ld),this.Ld=Jd(this.yg,SB,this))};t.Ct=function(){var b=this.getParent();b&&Xs(b)==this&&(UB(this,j),VB(this),this.nX=m)};t.yg=function(){var b=this.lc;b&&b.getParent()==this&&(UB(this,m),Mh(b,function(b){"function"==typeof b.yg&&b.yg()}))};a.WB=function(b){b.Ld&&Kd(b.Ld);b.Fz&&Kd(b.Fz)};t.D=function(b,c){var d=RB.n.D.call(this,b,c);d&&!this.Q()&&this.yg();return d};
a.VB=function(b){Mh(b.getParent(),function(b){b!=this&&"function"==typeof b.yg&&(b.yg(),WB(b))},b)};t.Vb=function(b){var c=b.keyCode,d=this.zd()?37:39,e=this.zd()?39:37;if(this.fE){if(!this.Ta().Vb(b))if(c==e)this.yg();else return m}else if(this.isEnabled()&&(c==d||c==this.dy))this.Ct(),Ys(this.Ta()),WB(this);else return m;b.preventDefault();return j};t.vP=function(){this.lc.getParent()==this&&(WB(this),this.Xl.pd(this),VB(this))};t.YF=function(b){b.target==this.Xl&&(this.yg(),WB(this))};
t.kd=function(b){this.isEnabled()&&(WB(this),this.Fz=Jd(this.Ct,SB,this));RB.n.kd.call(this,b)};t.Zd=function(b){WB(this);if(this.Ob&8)return RB.n.Zd.call(this,b);this.Ct();return j};
a.UB=function(b,c){b.dispatchEvent(Ih(64,c));var d=b.Ta();if(c!=d.Q()&&(c&&(d.za||d.X(),d.Nb(-1)),b.fE=c,F.enable(b.h(),"goog-submenu-open",c),d.D(c),c)){var d=new Ks(b.h(),b.aq?6:4,b.nO),e=b.Ta(),g=e.h();e.Q()||(g.style.visibility="hidden",Q(g,j));d.Y(g,b.aq?4:6);e.Q()||(Q(g,m),g.style.visibility="visible")}},a.TB=function(b,c,d){var e=b.m();(d?e.e:e.Fa).call(e,c,"highlight",b.vP)};t.Ga=function(b){this.Ta().H(b,j)};t.Gi=function(b,c){this.Ta().Fk(b,c,j)};
t.removeItem=function(b){(b=this.Ta().removeChild(b,j))&&b.G()};t.Rh=function(b){return Oh(this.Ta(),b)};t.tl=function(){return Nh(this.Ta())};t.Cb=function(){return this.Ta().Cb()};t.Ta=function(){this.lc?this.fr&&this.lc.getParent()!=this&&Lh(this.lc,this):this.fh(new Ut(this.K()),j);this.lc.h()||this.lc.v();return this.lc};t.fh=function(b,c){var d=this.lc;b!=d&&(d&&(this.yg(),this.za&&TB(this,d,m)),this.lc=b,this.fr=!c,b&&(Lh(b,this),b.D(m,j),b.Jm=m,b.Le(m),this.za&&TB(this,b,j)))};t.Ef=function(b){return this.Ta().Ef(b)};
mj("goog-submenu",function(){return new RB(k)});a.XB=function(b,c,d,e){RB.call(this,b,c,d,e)};z(XB,RB);XB.prototype.Vb=function(b){var c=XB.n.Vb.call(this,b),b=parseInt(qk[b.keyCode],10);isNaN(b)||this.Ta().Nb(b-1);return c};a.ww=function(b,c,d){T.call(this);this.ha=b;this.ka=d;this.UK=c||dh;this.lv=k};z(ww,T);a.YB={all_can_comment:"允许任何人评论",followee_can_comment:"允许我关注的人评论",nobody_can_comment:"关闭评论"},a.ZB=function(b,c){return Hm(b,c,function(){return this.zn()})};t=ww.prototype;t.zn=function(){return"#answer-"+this.ka};t.vj=function(){var b=$("a[name=report]",this.Gc);if(b.length){var c=new gu("answer",this.ka);ju(c,b[0]);Qc(c,this)}};t.Zx=function(){Cu("answer",this.mb,"read")};
t.Jj=function(){Cu("answer",this.mb,/^\/question\//.test(location.pathname)?"read":"touch")};
t.z=function(){function b(){c();var b=q.Zp.Rh(0);b.Ta&&b.Ta()&&(b.Ct(),b.Ta().Nb(0))}function c(){$B(q);q.Zp.Nb(0)}ww.n.z.call(this);var d=K("zm-item-answer",this.g)||this.g;this.ka=d.getAttribute("data-aid");this.He="1"===d.getAttribute("data-isowner");this.mb=d.getAttribute("data-atoken");this.Kg="1"===d.getAttribute("data-deleted");this.rv=+d.getAttribute("data-created");this.vN=+d.getAttribute("data-helpful");this.lO="1"===d.getAttribute("data-good");this.yj="1"===d.getAttribute("data-collapsed");
this.ib=k;this.Bf=K("zm-item-answer-author-info",this.g);d=m;!S.na()&&0<$(this.g).parents('div[data-fixed-summary="1"]').length&&(d=j);var e={};e.lr=!!d;d=this.It=new It(e);this.H(d);d.o(this.g);d.gd()&&ne(this.m(),d,"expand",this.Zx);Ht(this.g,this.Jj,this);this.Gc=this.Gc||K("zm-item-meta",this.g);(this.ai=K("zm-meta-panel",this.Gc))&&this.m().e(this.ai,"click",this.Fo);if(this.He){d=$('[name="comment_opt"]',this.Gc);if(d.length){var e=d.data(),g=new Ut,h=new fB("禁止转载");h.Yc(!e.copyable);g.Ga(h);
g.Ga(new Tt);this.mv=[];H.forEach(YB,function(b,c){var d=new fB(b);d.Aa(c);d.Yc(c===this.lv);this.mv.push(d);g.Ga(d)},this);g.Ga(new Tt);g.Ga(new Rt("删除"));this.m().e(g,"action",this.kM);aC(this,g);F.add(g.h(),"zg-gray-normal");e=new $t("comment",g);e.$j=j;cu(e);bu(e);e.dc=nf;e.o(d[0]);this.rW=g}this.Bf&&(this.jG=(this.ib=Wa(this.Bf.innerHTML,"匿名用户"))?k:this.Bf.innerHTML.replace(/src=".+?"/g,'src="'+S[2]+'"'),this.m().e(this.Bf,"click",function(b){"cancel-anon"===b.target.name&&Zr(m)}))}else this.rx();
if(d=K("zm-item-vote-info",this.g)){this.rk=new Fw(this.ka);this.H(this.rk);this.rk.o(d);d=$(".zm-item-vote-count",this.g);d[0]||(d=$(".zm-item-vote-count",this.Gc));var l=[d[0],$(".zm-votebar .count",this.g)[0]];if(l.length){var n=this.rk;this.rk.on("change",function(){A.forEach(l,function(b){Gk(b,n.Sa())})})}}this.Tn();$(this.g).on("contentchange",$.proxy(this.Tn,this));this.nx();this.nb();d=new MB(this.g);d=Ek.lI(d.getItem()||this.g);Dk(Dk(Dk(Dk(Dk(Dk(Dk(d.register("v",function(){this.ub&&this.ub.Tt()},
this),{group:"操作",name:"赞同"}).register("d",function(){this.ub&&this.ub.St()},this),{group:"操作",name:"反对"}).register("f x",this.sc,this),{group:"操作",name:"分享"}).register("s c",this.jj,this),{group:"操作",name:"收藏"}).register("t",this.Dr,this),{group:"操作",name:"感谢"}).register("c",this.Kw,this),{group:"操作",name:"打开评论"}).register("shift+c",this.sr,this),{group:"操作",name:"定位到评论框"});var e=jb?"⌘":"ctrl",q=this;bh.EE&&$("a[name=admin]",this.ai)[0]&&Dk(Dk(d.register("meta+.",c),{group:"管理",name:"展开菜单",key:e+
"+."}).register("meta+k",b),{group:"管理",name:"展开折叠子菜单 (Kill)",key:e+"+k"});this.vj();if(rb&&!Mg&&(d=K("more-actions",this.Gc))){var r={share:{label:"分享",action:this.sc},fav:{label:"收藏",action:this.jj},report:{label:"举报",action:this.aN},nohelp:{label:this.vN?"没有帮助":"撤销没有帮助",action:this.MD}},w=new Ut,e=function(b){Nh(w)&&w.Ga(new Tt);var c=new Rt(r[b].label);c.Aa(b);w.Ga(c)};e("share");e("fav");this.He||(e("nohelp"),S.na()&&e("report"));e=new $t("operation",w);e.$j=j;cu(e);bu(e);e.Ul=ba();e.dc=nf;e.o(d);
F.add(w.h(),"zh-answer-more-actions");this.m().e(w,"action",function(b){var c=b.target.S();(c=r[c])&&c.action&&c.action.call(this,b)})}};t.xz=function(b){var c=this.Tn();c&&$o(c,b)};
t.rx=function(){var b=K("zm-votebar",this.g)||K("zm-votebar",this.ai);if(b){var c=new Aw(this.ka);c.o(b);this.ub=c;this.m().e(c,"change",this.lR).e(c,"action",function(b){b.data.state===Bw.he?W.ga({type:"ga_click_vote_up",target:this}):b.data.state===Bw.qg&&W.ga({type:"ga_click_vote_down",target:this})});(b=K("votenum-mobile",this.ai))&&(new Dw(c)).o(b)}};
t.Tn=function(){if(this.Hp)return this.Hp;var b=K("zm-editable-content",this.g),c=this.ub&&this.ub.h();!this.He&&(!rb&&S.na())&&(c&&$(c).is(":visible")&&b&&230<$(b).height())&&(b=this.Hp=new cp(k,b),this.H(b),b.lh="votebar",b.Jy=50,b.o(c))};t.lR=function(){this.rk&&this.rk.gi()};
a.bC=function(b){if(!b.ke&&b.He&&dh&&b.ka){b.ke=new NB(m,"/answer/content","content");Qc(b,b.ke);b.ke.Xt=j;b.ke.Mv=j;b.ke.vD=vB.prototype.vD;var c=K("zm-item-rich-text",b.g);b.ke.params=["id="+b.ha];b.ke.o(c);b.m().e(b.ke,"shouldUpdateContent",function(b){if(la(b.data))return m});b.m().e(b.g,"click",function(b){"suggest_edit"===b.target.name&&(this.ke.rf(),$(".zh-question-censor-tip",this.g).hide());return j})}};
t.nb=function(){this.Bf&&this.m().e(this.Bf,"click",this.ua);this.He&&(this.LJ=S);this.m().e(Ki,"anon_change",function(b){this.He?this.st(b.ib):this.ub.Td()===Bw.he&&this.rk.gi()});bC(this);$(this.g).on("focusin focusout",function(b){$(this).toggleClass("focusin","focusin"===b.type)})};t.bf=function(b){return Uk(this.g,b)};
t.ua=function(b){if(b=(b=this.bf(b.target))&&b.name)if("edit"===b){b=mB();if(!this.Qu){var c=dh.mb;b.Px=j;b.KG=c;this.m().e(b,"change",this.qy)}this.Qu=j;nB(b)}else"complex"===b&&(b=K("zm-item-answer-summary",this.g),c=K("zm-item-rich-text",this.g),Q(b,m),Q(c,j))};t.qy=function(){var b=mB().ow()||S[4]||"";if(b){var c=K("zu-question-my-bio",this.Bf);c.title=b;c.innerHTML=b}};t.nx=function(){var b=K("zm-item-answer-author-wrap",this.g),b=K("zm-list-avatar",b);lk.add(b)};
t.st=function(b){b?this.Bf.innerHTML='<h3 class="zm-item-answer-author-wrap">匿名用户<a class="zg-link-gray cancel-anon" href="javascript:void(0);" name="cancel-anon">取消匿名</a></h3>':this.He&&(this.jG?this.Bf.innerHTML=this.jG.replace("</h3>","").replace("</H3>","")+'<a name="edit" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a></h3>':(b=[],b.push('<h3 class="zm-item-answer-author-wrap">'),b.push(dt()),b.push(et(S,"zm-item-answer-creator")),b.push("</h3>"),this.Bf.innerHTML=
b.join("")))};
a.cC=function(b,c){if(!b.oa){b.oa=new Xv(b.ka,"answer",c);b.H(b.oa);bw(b.oa,b.Gc,$(".toggle-comment",b.Gc)[0]);kw(b.oa);b.oa.tt(b.zn());var d=location.hash.slice(1).split("-"),e=location.pathname.split("/"),e="answer"===e[3]&&e[4];"comment"===d[0]&&d[1]&&e===b.mb&&(b.oa.Ka(j),b.m().e(b.oa,"expand",function(){$v(this.oa)}))}},a.$B=function(b){if(b.Zp)b.Zp.D(j);else{var c;var d=$("a[name=admin]",b.ai)[0];if(d){b.lJ=d;SB=0;c=new AB;b.H(c);c.attach(d,5);var e=b.yj?new Rt("取消折叠"):new XB("折叠");e.Aa("collapse");
var g=function(b,c){var d=new Rt(c+1+" "+b.label);d.Aa(b.value);e.Ga(d)};b.yj||Nv("answer","collapse").then(function(b){A.forEach(b,g);F.add(e.Ta().h(),"manage-menu")});d=new Rt("删除");d.Aa("delete");c.Ga(e);c.Ga(d);c.X(b.g);F.add(c.h(),"manage-menu")}else c=i;c&&(BB(c,new Ks(b.lJ,1,j),0,new Of(5,0,5,0)),b.m().e(c,"action",function(b){var c=b.target,b=c.S(),c=c.h(),d=new Rl;"collapse"===b?(d.add("answer_id",this.ka).add("action","collapse2").add("collapse",this.yj?"cancel":"done"),c.setAttribute("data-op",
this.yj?"uncollapse-answer":"collapse-answer"),c.setAttribute("data-action","/manage?"+d.toString()),dC(this,c)):"delete"===b?(d.add("answer_id",this.ka).add("action","remove_answer2"),c.setAttribute("data-op","remove-answer"),c.setAttribute("data-action","/manage?"+d.toString()),dC(this,c)):oa(b)&&(c=new Rl,c.add("answer_id",this.ka).add("action","collapse2").add("collapse",this.yj?"cancel":"done").add("reason",b),Mv("/manage",c.toString(),v(this.aG,this)))}),aC(b,c),b.Zp=c)}};
t.aG=function(){var b=$(this.g);b.hide("fast",function(){b.remove()});this.G()};a.dC=function(b,c){(new Lv).open(c,{id:b.ka,type:"answer"},v(b.aG,b))};
t.Fo=function(b){var c=this.bf(b.target),d=c&&c.name;if(d)switch(d){case "addcomment":this.Kw();this.oa&&this.oa.tc()&&this.oa.ri("view_comments",parseInt(Ec(c),10)||0);break;case "remove":this.wr();break;case "thanks":W.ga({type:"ga_click_thank_answer",target:c});this.Dr();break;case "comment_opt":if(!this.lv&&(!this.UB||!this.UB.Xb()))b=new V(j),ne(this.m(),b,"success",function(b){if((b=Ie(b.target))&&!b.r){var c=b.msg;A.forEach(this.mv,function(b){b.S()===c&&b.Yc(j)});this.lv=c}else U(b.msg)}),
b.ajax("/answer/comment_permission?answer_id="+this.ka,k,"GET"),this.UB=b;break;case "admin":$B(this);break;case "share":W.ga({type:"ga_click_share_answer_box",target:c});this.sc();break;case "nohelp":this.MD(b);break;case "favo":W.ga({type:"ga_click_collect_answer_box",target:c}),this.jj()}};t.aN=function(){(new gu("answer",this.ka)).mH()};
t.MD=ZB(function(b){var b=b.target,c=!!b.h;W.ga({type:"ga_click_answer_not_helpful",target:c?b.h():b});this.Ev&&"pending"===this.Ev.state()&&this.Ev.abort();var d,e;e=c?b.Cg():b.innerHTML;e=(d=-1<e.indexOf("撤销"))?"没有帮助":"撤销没有帮助";c?b.mm(e):b.innerHTML=e;d=d?"/answer/helpful":"/answer/not_helpful";c||Ok(b);this.Ev=$.post(d,{aid:this.ka})},{na:"question_answer_not_helpful",cd:j});t.sc=ZB(function(){new yu(["分享回答","answer",this.mb,{aid:this.ka}],"tb-webshare-sina")},{na:"question_answer_share"});
t.jj=ZB(function(){var b=Jw.N();Ow(b,this.ka);b.show()},{na:"question_answer_collect",cd:j});t.FK=function(){this.oa||cC(this);this.oa.xf();$(this.ai).toggleClass("focusin",this.oa.tc())};t.Kw=ZB(ww.prototype.FK,function(){return{na:"添加评论"===$.trim($(K("toggle-comment",this.g)).text())?"question_answer_add_comment_start":m}});t.sr=ZB(function(b){this.oa&&this.oa.tc()?this.oa.field.focus():this.Kw();b.preventDefault()},{na:"question_answer_add_comment_start"});
t.Dr=ZB(function(){var b=$("a[name=thanks]",this.ai)[0];b&&!F.has(b,"disabled")&&(Gk(b,"已感谢"),F.add(b,"disabled"),Ok(b),$.post("/answer/thanks",{aid:this.ka}))},{na:"question_answer_thank"});a.aC=function(b,c){b.m().e(c,"show",function(){F.add(this.Gc,"zm-item-meta-has-menu")}).e(c,"hide",function(b){b.currentTarget===b.target&&F.remove(this.Gc,"zm-item-meta-has-menu")})};
t.kM=function(b){var c=b.target,b=c.S();"禁止转载"===b?(b=!c.Be(),$.post("/node/AnswerMetaV2",{method:"set_copyright",params:{answer_id:this.ka,is_copyable:Number(b)}}),$(".copyright",this.Gc).html(b?"":'<span class="zg-bull">&bull;</span> 禁止转载')):"删除"===b?this.wr():b in YB&&$.post("/answer/comment_permission",{answer_id:this.ka,permission:b}).done(v(function(b){b&&!b.r&&A.forEach(this.mv,function(b){b.Yc(b===c)})},this))};
t.wr=function(){Bi("你确定要删除自己的答案吗？","答案内容不会被永久删除，你还可以撤消本次删除操作。",function(b){b&&(this.Kg=j,this.status=-1,eC(this))},this)};a.eC=function(b){var c=new V(j);ne(b.m(),c,"success",function(){Q(this.g,!this.Kg);this.Kg?this.su="set_delete":(bC(this),this.su="cancel_delete");this.dispatchEvent("change");$(this.g).parent(".zm-item").hide()});c.ajax("/answer/"+(b.Kg?"remove":"unremove"),"aid="+b.ka)};t.h=p("g");a.fC=function(b,c,d){ww.call(this,b,c,d)};z(fC,ww);fC.prototype.o=function(b){fC.n.o.call(this,b);this.He&&this.st(this.UK.ib)};fC.prototype.Q=function(){return $(this.g).is(":visible")};a.gC=function(){T.call(this);this.data=dh||{};this.ha=this.data.ha;this.bo=m;this.Hi={};this.Lu=[];this.dq=[];this.ci=0;this.Xf=eh&&eh.url_token?eh:k};z(gC,T);t=gC.prototype;t.B=function(){tr.H(this);this.o(document.body)};
t.z=function(){gC.n.z.call(this);var b=J("zh-question-meta-wrap");b&&(this.CG=new LB(this.data),this.H(this.CG),this.CG.o(b));this.Rn();var c=this;$(".js-ignore-invite").click(function(){$(".question-invited-by").hide();$.post("/question/askpeople",{qid:c.data.mb,uid:S.Ge,op:"pass"})});this.vo=new xy;this.m().e(this.vo,"change",this.Ly);this.vo.B();this.kH();S.Zg&&$.post("/question/popup",{action:"no_answer",question_token:this.data.mb},function(b){if(b){var c=new DB;c.Va("提问无人问津？");c.Ea(b);c.Y();
$(".js-gonext",c.g).on("click",function(){var b=$(this).parents('[class^="view"]').attr("class");"view-starting"===b?(c.Va("第一条"),c.Fd("firsttip")):"view-firsttip"===b?(c.Va("第二条"),c.Fd("secondtip")):"view-secondtip"===b?(c.Va("第三条"),c.Fd("thirdtip")):"view-thirdtip"===b&&c.D(m)})}});(b=qh.topic_errors_info)&&Lm(b)};
t.kH=function(){this.data.mb=dh.mb;hC(this,j);if(S.na()){"close"!==dh.status&&(this.Na=new pn(this.data.iA,this.data.ha),this.Na.ys=5,this.Na.Bs=1,this.Na.eB=j,this.Na.Gs=j,this.Na.o(K("zm-tag-editor",this.g)),this.m().e(this.Na,["remove_tag","add_tag"],function(){W.ga("ga_edit_question_topic_changed")}),this.m().e(this.Na,"start_editing",function(){W.ga("ga_question_topic_edit_finish_changed")}),this.Na.addEventListener("beforeedit",ny({am:j})));"close"===dh.status&&$('.question-status [name="appeal"]').click($.proxy(function(){var b=
this.ha,c=new wi;$h(c,j);c.Ih=j;fi(c,hi);c.Va("请填写你的申诉理由");c.Ea('<textarea class="textarea" name="reason" placeholder="简洁的申诉理由会让管理员更快处理"></textarea>');c.D(j);c.Y();c.m().e(c,di,function(){$.post("/question/appeal",{qid:b,reason:$('[name="reason"]',c.g).val()},function(){Bi({title:"申诉成功！",Ql:j,content:"<p>您的申诉正在等待人工处理，我们会在 24 小时内处理完成。</p><p>处理完成后会「消息」通知您</p>",className:"report-success-dialog",Y:j,Df:["知道啦"]})})})},this));var b=J("zh-question-title");if("false"!==b.getAttribute("data-editable")){this.$c=
new yB(this.data.ha,"/question/title","content",m,j);this.$c.AC=j;this.$c.Qd=j;this.$c.Oo=j;var c=ht(this.data.Zg);this.$c.ao=c;this.$c.o(b);this.m().e(this.$c,"change",function(){Ki.dispatchEvent("question_title_change");document.title=this.$c.bb()+" - 知乎"});this.m().e(this.$c,"click_edit",function(){W.ga("ga_question_title_edit_start")});this.m().e(this.$c,"cancel_edit",function(){W.ga("ga_question_title_edit_cancel")});this.m().e(this.$c,"save_changed",function(){W.ga("ga_question_title_edit_save_changed")});
this.m().e(this.$c,"save_unchanged",function(){W.ga("ga_question_title_edit_save_unchanged")});this.$c.addEventListener("beforeedit",ny({am:j}))}}this.fq=J("zh-question-answer-num");this.gq=J("zh-question-answer-wrap");this.Bh=J("zh-question-collapsed-link");this.an=J("zh-question-collapsed-wrap");this.zK=J("zh-question-collapsed-num");this.DJ=J("zh-question-answer-form-wrap");this.lk=J("zh-question-notification-summary");this.ym=J("zh-answers-filter");this.at=J("zh-add-question-sug");this.fq&&(this.data.le=
+this.fq.getAttribute("data-num"));this.gq&&(this.data.HQ=+this.gq.getAttribute("data-pagesize"));this.Bh&&this.m().e(this.Bh,"click",this.GS);this.at&&this.m().e(this.at,"click",this.GD);this.ym&&Rg&&this.m().e(this.ym,"click",function(b){b.stopPropagation();F.add(this.ym,"activated");ne(this.m(),document,"click",function(){F.remove(this.ym,"activated")})});(this.jv=J("zg-question-suggested-topics"))&&this.m().e(this.jv,"click",this.mP);this.Qn();this.m().e(window,"hashchange",function(b){b=b.Ub;
b.oldURL&&"writing"===b.oldURL.split("#")[1]||iC(this)});if(b=J("zh-question-answer-wrap")){var d=new Jt({ma:["expandLimit","nodeSource"],hh:this.data.le>this.data.HQ&&!K("question-page-pager")});this.H(d);this.m().e(d,"itemcreated",function(b){d.H(jC(this,b.item));$("img.lazy",b.item).lazyload({data_attribute:"actualsrc",threshold:400})});d.o(b)}b=S[4];fh&&fh.length&&(b=fh[0][1]);this.kb=new vB(this.data.ib,S,b);this.H(this.kb);this.kb.o(this.DJ);ah.Id&&ah.Id.length?this.kb.Ea(ah.Id[0]):!bh.uc&&
C&&this.kb.Ea("<p></p>");if(!this.data.Bx&&!this.ci&&(!this.Xf||!this.Xf.url_token))if(this.data.Lm&&this.data.Lm.length&&this.data.Lm[3]!==S.Ge)this.kb.Za(m,"只有 "+et(this.data.Lm)+" 能回答此问题");else if("normal"===dh.status||ah.Id)S.Zg||this.kb.rf();this.m().e(this.kb,"change",this.nP);this.m().e(this.kb,"cancel_delete_answer",this.uP);this.kb.ready(function(){var b=this.or();b&&"writing"===location.hash.slice(1)&&b.execCommand("toggleFullScreen")});kC(this);iC(this,k);lC(this);this.m().e(Ki,"anon_change",
function(b){this.data.ib=b.ib});ch&&setTimeout(function(){location.href=ch},5E3)};t.Rn=function(){Cu("question",this.data.mb,"read");this.m().e(this,["click!","show!"],function(b){"comment"===b.namespace&&b.wc.fill("category","question_answer").fill("label","question_answer");"invitation"===b.namespace&&b.wc.fill("label","question_page")})};
t.Ly=function(){this.tN=j;this.lk=$(this.vo.gP)[0];jc(this.lk,J("zh-question-redirect-info"));Q(this.lk,j);bh.uc||(this.cj=new Vo,this.cj.o(this.lk),Tr(this.cj));this.m().e(this.lk,"click",this.GD);iC(this)};a.hC=function(b,c){!S.na()||!c?(mC(b,"zh-question-detail",ha),mC(b,"zh-question-answer-summary",ha)):(mC(b,"zh-question-detail",b.LN),mC(b,"zh-question-answer-summary",b.ON))},a.mC=function(b,c,d){if(c=J(c)){var e=new It;b.m().e(e,"expand",d).e(e,"invalid",d);e.o(c)}};
t.LN=function(b){if("close"!==dh.status){b=b.target.h();this.xb=new yB(this.data.ha,"/question/detail","content",j,k,600);var c=ht(this.data.Zg);this.xb.ao=c;this.xb.nW=Wk;K("zm-editable-content",b).innerHTML&&(this.xb.Oo=j);this.xb.o(b);this.m().e(this.xb,"click_edit",function(){W.ga("ga_question_supplement_edit_start")});this.m().e(this.xb,"cancel_edit",function(){W.ga("ga_question_supplement_edit_cancel")});this.m().e(this.xb,"save_changed",function(){W.ga("ga_question_supplement_edit_save_changed")});
this.m().e(this.xb,"save_unchanged",function(){W.ga("ga_question_supplement_edit_save_unchanged")});this.xb.addEventListener("beforeedit",ny({am:j}))}};
t.ON=function(b){var b=b.target.h(),c=J("zh-question-answer-summary-link"),d;if(b&&(bh.EE||!this.data.ES))d=new sp(j,"/question/summary","content"),d.params=["id="+this.data.ha],d.xq=m,d.o(b);if(c){var e=J("zh-question-answer-summary-wrap");this.m().e(c,"click",function(){d&&(Q(e,j),d.rf())}).e(e,"click",function(b){"cancel"===b.target.name&&(b=!d.df(),Q(e,!b))})}this.DS=d;this.DS.addEventListener("beforeedit",ny({am:j}))};
t.GD=function(b){if("close"===b.target.name){if(this.cj&&(ap(this.cj),$o(this.cj,m),history.replaceState)){var b=new vf(location.href),c=b.hd();c.remove("q");c.remove("psq");history.replaceState({},"",b.ag+"?"+c.toString())}Q(this.lk,m);Q(this.at,m)}else if("A"===b.target.tagName&&"zh-question-suggest-reask"===b.target.id&&(Q(this.at,m),vp.N().show()),c="a"===$(b.target).prop("tagName").toLowerCase()?b.target:this.bf(b.target,"A"))b.preventDefault(),b.stopPropagation(),b=c.getAttribute("data-source")||
c.href,c=b.indexOf("#"),b=0>c?k:b.substr(c+1),iC(this,b&&decodeURIComponent(b))};
a.lC=function(b){b.data.Dq=+b.zK.innerHTML;S.na()||(b.data.Dq=0);Q(b.Bh,0<b.data.Dq);b.fq&&wc(b.fq,b.data.le?b.data.le+" 个回答":"还没有回答");b.ym&&Q(b.ym,1<b.data.le);Q(b.Bh,0<b.data.Dq)},a.jC=function(b,c,d,e){e=new fC(b.ha,k,e);e.o(c);b.Hi[e.ka]=e;b.dq.push(e.ka);b.m().e(e,"change",b.py);e.He&&(b.ci=e.ka,e.LJ=S,b.m().e(e.ke,"change",b.SM),b.sg=e);e.yj?e.He&&b.an.appendChild(e.h()):b.Lu.push({added_time:e.rv,vote:d,aid:e.ka});e.Kg&&Q(e.h(),m);return e};
t.SM=function(){var b=this.sg,c=b.h(),d=b.ke.bb()[0];Q(c,m);d=ec(Ma(d));ic(d,c);this.Hi[b.ka]=k;this.dq=A.filter(this.dq,function(c){return c!==b.ka},this);var e=999;this.Lu=A.filter(this.Lu,function(c){c.aid===b.ka&&(e=c.vote);return c.aid!==b.ka},this);M(c);b.G();jC(this,d,e,m)};
t.py=function(b){b=b.target;if(b instanceof fC){var c=b.h();switch(b.su){case "collap":this.an.appendChild(c);F.add(c,"zm-item-collapsed");this.data.le--;lC(this);break;case "cancel_collap":this.gq.appendChild(c);F.remove(c,"zm-item-collapsed");nC(this,c);this.data.le++;lC(this);break;case "set_delete":kC(this);this.data.le--;lC(this);break;case "cancel_delete":nC(this,this.Hi[this.ci].h()),kC(this),this.data.le++,lC(this)}}};
a.kC=function(b){var c=k,d=k,e,g={suggest:"建议修改",evaluate:"建议修改",close:"关闭"};!ah.Id&&"normal"!==dh.status&&(d="被"+g[dh.status]+'的问题不允许添加新的回答。<a data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a>');b.ci?(e=b.Hi[b.ci],c="#answer-"+e.ka,e=e.Kg):b.Xf&&(c="/question/"+dh.mb+"/answer/"+b.Xf.url_token,e=b.Xf.is_delete);c&&(d=e?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':'一个问题你只能回答一次，但你可以对 <a href="'+
c+'">现有的回答</a> 进行修改');S.Zg&&(!b.ci&&!b.Xf)&&(d='添加回答：<a href="javascript:;" name="answer_my_question">回答自己的提问</a>');b.data.Bx&&(d='该问题目前已经被锁定，无法添加新答案。<a href="http://www.zhihu.com/question/19604313" target="_blank">问题为什么会被锁定？</a>');d&&b.kb.Za(m,d)};t.nD=function(b){return this.Hi[b]};a.oC=function(b,c){var d=J("zh-question-collapsed-switcher");c?(d.name="collap",b.VB=j,Q(b.an,j),F.add(b.Bh,"zu-question-collap-title-active")):(b.VB=m,d.name="expand",Q(b.an,m),F.remove(b.Bh,"zu-question-collap-title-active"))};
t.GS=function(b){if((b=Uk(this.Bh,b.target))&&b.name)if("expand"===b.name){if(!this.BK){this.BK=j;var c=this,d=this.an,b=$.get("/node/QuestionCollapsedAnswerListV2",{params:{question_id:this.data.ha}});b.done(function(b){b=ec(b);oC(c,j);F.remove(d,"zm-question-collapsed-list-loading");d.appendChild(b);A.forEach(nc(d),function(b){b!==e&&jC(c,b,99999)});$("img.lazy",d).lazyload({data_attribute:"actualsrc",threshold:400})});var e=nc(d)[0];e&&(Q(e,m),b.done(function(){Q(e,j)}));Q(d,j);F.add(d,"zm-question-collapsed-list-loading")}oC(this,
j)}else oC(this,m)};t.uP=function(){var b=this.Hi[this.ci],c;b?(b.Kg=m,b.status=0,eC(b),nC(this,b.h())):(c=this.Xf,b=new V(j),ne(this.m(),b,"success",function(){window.location.href="/question/"+dh.mb+"/answer/"+c.url_token}),b.ajax("/answer/unremove","aid="+c.id))};
t.nP=function(){var b=this.kb.cq.checked,c={Ql:j,title:"确认放弃匿名身份？",content:"你在该问题下的赞同和关注行为将以实名显示。"},d=v(function(){if(!this.xhr||!this.xhr.Xb()){var c=this.kb.df();if(c){var d=new V(j),h=new Rl,l=b?1:0;h.add("id",this.ha).add("content",c).add("anon",l);d.on("success",function(){dh.ib!==l&&Ki.dispatchEvent(new Pr(l));var b=Ie(this.xhr);b&&!b.r?(b=ec(Ma(b.msg[0])),this.gq.appendChild(b),jC(this,b,this.dq.length,j),kC(this),tB(this.kb.JC),uB(this.kb.JC),this.kb.G(),dh.ib||(this.cP=new eB(this.Hi[this.ci]),
this.cP.show()),S.CL&&$("#answer-my-question-tip").insertAfter($("#zh-question-answer-form-wrap")).show(),this.data.le++,lC(this)):U(b.msg)},m,this);d.ajax("/answer/add",h.toString());this.xhr=d}}},this);dh.ib&&!b?Bi(c,function(b){b&&d()}):d()};t.bf=ba();t.mP=function(b){if((b=this.bf(b.target))&&b.name){var c=b.name;"close"===c?Q(this.jv,m):"addtag"===c&&(this.Na.Qe(b.id.split("-")[1],b.innerHTML),Q(b,m))}};t.Qn=function(){this.Iz=new gB(this.ha);this.Iz.B()};
a.iC=function(b,c){if(c=c||location.hash.slice(1)){var d=c.split("-"),e=d[1];"answer"===d[0]&&(d=b.nD(e))&&(d.yj&&!b.VB?nC(b,b.Bh):nC(b,d.h()))}},a.nC=function(b,c){if(c){var d=wg(document.body).top,e=b.tN?ng(b.lk).height:0,d={paddingTop:d+e};"number"===$.type(d)&&(d={offsetTop:d});d.fI=Ds;Cs(c,d);Ok(c);b.cj&&b.cj.Bp()}};a.pC=function(){gC.call(this);this.data=dh;this.ha=this.data.ha};z(pC,gC);t=pC.prototype;
t.kH=function(){(this.Uq=J("zh-single-answer-disable-wrap"))&&this.m().e(this.Uq,"click",this.GR);this.Hl();this.Qn();var b=$("#zh-question-answer-collestions");b.length&&$("a[name=focus]",b).click(function(){Np(this,"favlist")});hC(this,m);if(b=$("#zh-question-answer-collections > .zh-general-list").get(0)){var c=new Jt({ma:["autoload","nodeSource"]});this.H(c);c.o(b)}if(b=$(".awesome-answer-list").get(0)){var d=new Jt({ma:["expandLimit"],hh:m});this.H(d);this.m().e(d,"itemcreated",function(b){var c=
new tw;c.o(b.item);d.H(c)});d.o(b)}};t.Rn=function(){this.m().e(this,["click!","show!"],function(b){"invitation"===b.namespace&&b.wc.fill("label","answer_page")});pC.n.Rn.call(this)};t.GR=function(b){b.target&&b.target.name&&(b=this.Ib,b.Kg=m,b.status=0,eC(b))};
t.Hl=function(){var b=K("zm-item-answer",J("zh-question-answer-wrap"));if(b){this.Ib=new fC(this.ha);this.H(this.Ib);this.Ib.o(b);b=this.m();b.e(this.Ib,"change",this.py);if(this.Ib.He){b.e(Ki,"anon_change",function(b){var c=b.ib,b=$("#js-sidebar-author-info");if(!$("a[name=focus]",b).length){var g={"0":"fullname",1:"url_token",2:"avatar_path",3:"hash",4:"headline"},h=A.reduce(S,function(b,c,d){b[g[d]]=c;return b},{}),c=$k(this.MJ,{author:!c&&h});b.html(c)}});var c=this.Ib.ke;c&&b.e(c,"change",function(){var b=
Ma(c.bb()[0]),b=ec(b);lc(b,this.Ib.g);this.Ib.G();this.Hl(b)})}qC(this);cC(this.Ib,{autofocus:m,dF:j})}};t.nD=function(b){if(this.Ib.ka===b)return this.Ib};t.MJ='<h3>关于作者</h3><% if (author) { %>    <a class="zm-list-avatar-link" href="/people/<%= author.url_token %>" tabindex="-1">        <img class="zm-list-avatar-medium" src="<%= author.avatar_path.replace("_s.","_m.") %>"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">            <a href="/people/<%= author.url_token %>"><%= author.fullname %></a>        </h2>        <div class="zg-gray-normal"><%= author.headline || "" %></div>    </div><% } else { %>    <a class="zm-list-avatar-link" href="javascript:;">        <img class="zm-list-avatar-medium" src="http://img.zhihu.dev:4080/66/6b/666b0abfc_m.jpg"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">匿名用户</h2>    </div><% } %>';
t.Qn=function(){this.Iz=new gB(this.ha,this.Ib);this.Iz.B();var b=J("js-sidebar-author-info");b&&(new ky(b)).B()};t.py=function(b){b=b.target;if(b instanceof fC)switch(b.su){case "collap":F.add(b.h(),"zm-item-collapsed");break;case "cancel_collap":F.remove(b.h(),"zm-item-collapsed");break;case "set_delete":case "cancel_delete":qC(this),location.reload()}};
a.qC=function(b){b.Ib?b.Ib.Kg?(b.Uq.innerHTML=b.Ib.He?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':"此答案已经被作者删除",Q(b.Ib.h(),m)):Q(b.Ib.h(),j):b.Uq.innerHTML="此答案已经被作者删除"};a.rC=function(){T.call(this);this.page=1};z(rC,T);t=rC.prototype;t.B=function(){var b=K("js-topic-feed-page");this.o(b)};
t.z=function(){function b(b){l.hasClass("disabled")||(n.random(b)||(l.addClass("disabled"),$(".hidden-topics-plaza").show(),X("topic","show_hidden_enter_topics_square","topic_feed_recommend")),g.html(pw(n,n.td,n.Xg)))}rC.n.z.call(this);var c=this;this.BA=$(".js-topic-feed-container",this.g);this.BA.find(".js-topic-item").each(function(){var b=new sC;c.H(b);b.o(this);c.m().e(b,"unfollow",function(){tC(c)})});this.Ts=new uC;this.Ts.o($(".js-pinned-topics",this.element)[0]);(this.Yb=J("js-load-more"))&&
this.m().e(this.Yb,"click",this.yy);this.m().e(this.Ts,"change",function(b){$("#tf-"+b.IH).find(".js-pin").replaceWith('<a href="javascript:;" data-action="pin-topic" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>设为常去话题</a>')});this.hu=$(".follow-topics-count");var d=this,e=$(this.h()),g=$(".js-list",e),h=$(".js-hidden-list",e),l=$(".js-pager",e),h=$.makeArray($("<div>").html(h.html()).children().add(g.children())),n=new ow(h,3);l.on("click",function(){b(g.find(".zg-btn-follow").length)});
g.on("click","[data-follow]",function(c){var e=$(c.target),h=e.data("id"),x=$(".new-follow-topics span"),G=x.data("ids");if(e.hasClass("zg-btn-follow"))c=$(c.target).closest(".topic-item"),n.remove(c[0]),x.length?(G.push(h),x.data("ids",G),x.text(G.length)):$('<a href="#" class="new-follow-topics">新关注 <span data-ids="['+h+']">1</span> 个话题，点击查看</a>').insertBefore($(".topic-recommend")),1===$(".zg-btn-follow",g).length&&(l.hasClass("disabled")?$(".topic-recommend").fadeOut():setTimeout(function(){b(0)})),
h=parseInt(d.hu.text()),vC(d,h+1);else if(e.hasClass("zg-btn-unfollow")){var I=$(".js-topic-item[data-id="+h+"]");I.length?I.fadeOut(function(){I.remove();tC(d)}):G&&(1<G.length?(G.splice(G.indexOf(h),1),x.data("ids",G),x.text(G.length)):x.parent().remove(),tC(d))}});e.on("click",".new-follow-topics",function(b){b.preventDefault();var c=$(b.target);$.get("/topic/newest-feeds",{ids:JSON.stringify($("span",c).data("ids"))},function(b){b&&!b.r&&(wC(d,b.msg),c.remove())})}).on("click",".js-nomore-recommend",
function(){$.post("/topic/suggest-topics/close",function(b){b&&!b.r&&$(".topic-recommend").fadeOut()})});this.Rn()};a.xC=function(b,c){wc(b,c?"加载中...":"更多")};t.yy=function(){xC(this.Yb,j);this.xhr=new V(j);ne(this.m(),this.xhr,"complete",v(this.Sg,this));var b=new Vk;b.add("page",++this.page);this.xhr.ajax(location.pathname,b.hd())};t.Sg=function(){var b=Ie(this.xhr);b&&!b.r&&(0<b.msg.length?(wC(this,b.msg),xC(this.Yb,m)):$(this.Yb).hide())};
a.wC=function(b,c){$.each(c,function(c,e){var g=new sC;b.H(g);g.o($(e)[0]);b.BA.append(g.h());b.m().e(g,"unfollow",function(){tC(b)})})},a.tC=function(b){var c=parseInt(b.hu.text());vC(b,c-1)},a.vC=function(b,c){b.hu.text(c);$(".no-topics").toggle(0===c)};
t.Rn=function(){var b=$(this.h());$.each({".zu-main-sidebar .topics-plaza a":["visit_topic_square","topic_feed_sidebar"],".hidden-topics-plaza a":["visit_topic_square","topic_feed_recommend"],".js-pager.topics-pager":["click_change_recommend_topic","topic_feed_recommend"],".js-nomore-recommend":["click_nomore_recommend_topic","topic_feed_recommend"],".js-list .zg-btn-follow":["click_follow_recommend_topic","topic_feed_recommend"],".js-list .zg-btn-unfollow":["click_unfollow_recommend_topic","topic_feed_recommend"],
'.topic-recommend .topic-feed-item a[href^="/question/"]':["visit_question","topic_feed_recommend"]},function(c,d){b.on("click",c,function(){X.apply(k,["topic"].concat(d))})})};a.sC=function(){T.call(this)};z(sC,T);sC.prototype.z=function(){sC.n.z.call(this);this.m().e(this.g,"click",v(this.ny,this))};
sC.prototype.ny=function(b){var c=b.target,b=$(c).attr("data-action"),d=$(this.g).find(".topic-avatar img"),e=d.clone(),g,h=$(this.g).data("id");if("pin-topic"===b)g=this.getParent().Ts,$.post("/pin-topic/add",{tid:h},$.proxy(function(b){!b.r&&b.msg?($(this.g).append($(this.wR({topic:b.msg})).hide().fadeIn()),yC(this)):U(b.msg,2E3)},g)).done(function(b){if(!b.r&&b.msg){$(".zu-main-sidebar .side-title").show();Ok(c);$(c).replaceWith('<a href="javascript:;" data-action="unpin-topic" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消常去话题</a>');
var b=d.offset(),h=$(g.g).offset();1E3<b.top-h.top?(h=$(".top-nav-topic-selector.current a").offset(),h={top:h.top+20,left:h.left+15,width:"25px",height:"25px",opacity:0.1},e.css({position:"absolute","z-index":"999"}).css("top",b.top).css("left",b.left).appendTo("body").animate(h,300,function(){e.remove()})):e.css({position:"absolute","z-index":"999"}).appendTo("body").css("top",b.top).css("left",b.left).animate({top:h.top-63+$(g.g).height(),left:h.left,width:"-=50px",height:"-=50px",opacity:0.5},
300,function(){e.remove()});$(".no-pin-topics").hide()}});else if("unpin-topic"===b){var l=this.getParent().Ts,n=function(){var b=$(c).replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>设为常去话题</a>')[0];Ok(b)},q=$(l.g).find("[data-topicid="+h+"]");q.fadeOut(function(){q.remove();l.Kt().done(function(){n&&n()});l.dispatchEvent({type:"change",IH:q.attr("data-topicid")});0===$(".js-pin-item").length&&$(".no-pin-topics").show()})}else if("unfollow"===
b){var r=this,w=$(r.g);(b=$(".topic-recommend .zg-btn-unfollow[data-id="+c.id.match(/-(.*)/)[1]+"]").get(0))?Np(b,"topic",k,["zg-btn-follow","zg-btn-unfollow"]):Np(c,"topic",k,["follow","unfollow"]);w.fadeOut(function(){w.remove();r.dispatchEvent("unfollow")})}};a.uC=function(){T.call(this)};z(uC,T);uC.prototype.wR=$k('<div class="side-topic-item js-pin-item  cursor-move" data-topicid="<%=topic.id%>" >    <a href="/topic/<%=topic.url_token%>" class="pin-topic-avatar-link">        <img src="<%=topic.avatar_path%>" alt="" title="拖动以排序" class="side-topic-avatar js-topic-avatar">    </a>    <div class="side-topic-content ellipsis">        <a href="/topic/<%=topic.url_token%>" class="topic-link side-topic-title"><%=topic.name%></a>        <div class="side-topic-meta">        <% if (topic.children_num > 0) { %>            <span class="zg-gray"><%=topic.children_num%> 个子话题</span>            <span class="bull">&bull;</span>        <% } %>            <span class="zg-gray"><%=topic.followers_num%> 人关注</span>        </div>        <% if (topic.feed_num > 0) { %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>"><%=topic.feed_num %> 条动态&nbsp;&raquo;</a>        <% }else{ %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>">进入话题 &raquo;</a>        <% } %>    </div>    <a href="javascript:;" data-action="up" class="up" data-tip="s$b$置顶"></a>    <a href="javascript:;" data-action="remove" class="delete"></a></div>');
uC.prototype.z=function(){uC.n.z.call(this);this.m().e(this.g,"click",v(this.ny,this));yC(this)};a.yC=function(b){b.If&&b.If.G();var c=new xs;c.Yq="pin-topic-moving";ys(c,b.g,0);c.B();b.m().e(c,"dragend",v(b.Kt,b));b.If=c;$("a",b.g).each(function(){b.m().e(this,"mousedown",function(b){b.stopPropagation()})})};
uC.prototype.ny=function(b){var c=this,d=b.target,e=$(d).attr("data-action");if(e){var g=$(d).parents(".js-pin-item");if("up"===e){var b=g.position(),h=g.clone();g.before(h).css({position:"absolute","z-index":"999"}).css("top",b.top).animate({top:$(c.g).position().top},200,function(){h.remove();g.css({position:"relative",top:0}).prependTo(c.g);c.Kt()});h.css("opacity",0)}else"remove"===e&&g.fadeOut(function(){g.remove();c.Kt();c.dispatchEvent({type:"change",IH:g.attr("data-topicid")});0===$(".js-pin-item").length&&
$(".no-pin-topics").show()})}else b.stopPropagation()};uC.prototype.Kt=function(){var b=[];$(this.g).find("div.js-pin-item").each(function(){b.push($(this).attr("data-topicid"))});return $.post("/pin-topic",{topic_ids:b.join(",")},ba())};a.zC=function(){T.call(this);this.TC="even";this.hn="current"};z(zC,T);t=zC.prototype;t.B=function(){tr.H(this);this.o(document.body)};
t.z=function(){zC.n.z.call(this);this.gu=$("ul.zm-topic-cat-main").children();var b=this.rd=$("div.zh-general-list"),c=new Jt({ma:["autoload","nodeSource"]});this.H(c);c.o(b.get(0));this.m().e(c,"next",this.$p);this.ZE=c;b.on("click","a.follow",function(){Np(this,"topic",xa(Ok,this),k,{follow_text:"关注"})});O(window,"hashchange",this.SF,m,this);this.SF()||(b.show(),this.$p())};
t.$p=function(){var b=this.rd.show().children();if(!b.length)return this.rd.html('<p class="zg-gray-normal" style="text-align:center;line-height:4;">没有子话题。</p>');b.removeClass("no-border "+this.TC);b.filter(":odd").addClass(this.TC);b=b.last();b.index()%2?b.add(b.prev()).addClass("no-border"):b.addClass("no-border");var b=this.rr(),c=b.params&&b.params.topic_id,b=this.gu.filter(function(){return $(this).attr("data-id")===String(c)});b.length&&b.addClass(this.hn).siblings().removeClass(this.hn)};
t.rr=function(){return this.rd.data("init")};t.SF=function(){var b;a:{var c=decodeURIComponent(location.hash.slice(1));if(c&&(b=this.gu.filter(function(){return $(this).text()===c}),b.length&&this.gu.filter("."+this.hn).text()!==c)){b.addClass(this.hn).siblings().removeClass(this.hn);b={params:{topic_id:b.data("id")}};var d=this.rr();$.extend(j,d,b);this.rd.attr("data-init",JSON.stringify(d));this.rd.empty();this.ZE.Ni();this.ZE.Tx();b=j;break a}b=i}return b};a.AC=function(){T.call(this)};z(AC,T);
AC.prototype.B=function(){$(".report-table .report-appeal").click(function(b){b.preventDefault();var c=$(this).closest("tr"),d=new wi;$h(d,j);d.Ih=j;fi(d,hi);d.Va("请填写你的申诉理由");d.Ea('<textarea class="textarea" name="reason" placeholder="简洁的申诉理由会让管理员更快处理"></textarea>');d.D(j);d.Y();d.m().e(d,di,function(){$.post("/report/appeal",{report_id:c.data("id"),reason:$('[name="reason"]',d.g).val()},function(){Bi({title:"申诉成功！",Ql:j,content:"<p>您的申诉正在等待人工处理，我们会在 24 小时内处理完成。</p><p>处理完成后会「消息」通知您</p>",className:"report-success-dialog",
Y:j,Df:["知道啦"]})})})});$(".report-table .report-show-deleted").click(function(b){b.preventDefault();$(this).next(".report-deleted").toggleClass("hidden")})};a.BC=function(){T.call(this)};z(BC,T);BC.prototype.B=function(){tr.H(this);this.o(document.body)};BC.prototype.z=function(){BC.n.z.call(this);CC(this,"zh-global-logs-wrap");CC(this,"zh-global-logs-questions-wrap");CC(this,"zh-question-log-list-wrap")};
a.CC=function(b,c){var d=J(c);if(d){var e=new Jt;b.H(e);e.ma("locationSource",{Rs:j});e.o(d);$(d).on("click",'a[name="revert"]',function(){if(ny({am:j})()===m)return m;ay(this);return m}).on("click",'.zm-item-meta a[name="report"]',function(){(new gu("activity",$(this).data("id"))).submit();return m})}};a.DC=function(){T.call(this)};z(DC,T);DC.prototype.B=function(){tr.H(this);this.o(document.body)};DC.prototype.z=function(){DC.n.z.call(this);this.Pn("zh-question-followers-list-wrap")};DC.prototype.Pn=function(b){if(b=J(b)){var c=new Jt;this.H(c);c.ma("locationSource");c.o(b)}};a.EC=function(b,c){var d;if(b&&c){d=d||"text-highlight";var e=RegExp(c,"i");$(b).find("*").andSelf().contents().each(function(){if(3===this.nodeType){var b=this,h=b.parentNode;if(!F.has(h,d))for(var l,n;-1!==(l=b.data.search(e));)l=0<l?b.splitText(l):b,b=l.splitText(c.length),n=document.createElement("em"),n.className=d,n.appendChild(l.cloneNode()),h.replaceChild(n,l)}})}};a.FC=function(){At.call(this,{ma:["autoload","dataPagingSource"]})};z(FC,Jt);FC.prototype.uq=function(){return ec('<button class="feeds-loading"><span>更多</span></button>')};FC.prototype.Ez=function(b){this.Jd&&(wc(this.Jd.firstChild,b?"努力加载中...":"更多"),F.enable(this.Jd,"loading",b))};a.GC=function(){T.call(this);this.Vg="roundtable";this.Ro=qh.roundtable};z(GC,T);GC.prototype.Ci=function(){lw.call(this,"answer");this.Xv="entry-expaneded";this.As="item-footer";this.Gp="votebar"};z(GC.prototype.Ci,lw);t=GC.prototype.Ci.prototype;
t.Qm=function(){GC.prototype.Ci.n.Qm.call(this,{".js-expand":this.Ka,".js-thank":this.Dr});this.rx();var b=$(".phone-actions",this.h());if(b.length){var c=new Ut;c.o($(".menu",b)[0]);c=new $t("operation",c);c.$j=j;cu(c);bu(c);c.dc=nf;c.o($(".menubutton",b)[0])}var d=new It({nv:"content",AH:"script.content"});this.H(d);d.o(this.h());this.m().e(this,["expand","collapse"],function(b){b.target===this&&d.Ka("expand"===b.type,j)}).e(d,["expand","collapse"],function(b){this.Ka("expand"===b.type)})};
t.rx=function(){var b,c,d=$("."+this.Gp,this.h())[0];d&&(b=this.ub=new Aw(this.pb,this.entryType),this.H(b),Qc(this,b),b.o(d),(d=$(".js-mobi-vote",this.h())[0])&&(new Dw(b)).o(d));if(d=$(".zm-item-vote-info",this.h())[0])c=new Fw(this.pb,this.entryType),this.H(c),Qc(this,c),c.o(d);b&&c&&this.m().e(b,"change",function(){c.gi()}).e(c,"change",function(){$("[data-bind-votecount]",this.h()).text(c.Sa())})};
t.Dr=mw(function(b){if((b=b.target)&&!F.has(b,"thanked"))Gk(b,"已感谢"),F.add(b,"thanked"),$.post("/answer/thanks",{aid:this.pb})},{na:"question_answer_thank"});t.sc=function(){GC.prototype.Ci.n.sc.call(this,"分享回答","answer",this.Lh,{aid:this.pb})};t.jj=mw(function(){var b=Jw.N();Ow(b,this.pb);b.show()},{na:"question_answer_collect",cd:j});
t.je=function(){GC.prototype.Ci.n.je.call(this);Dk(this.eg.register("v",function(){this.ub&&this.ub.Tt()},this),{group:"操作",name:"赞同"});Dk(this.eg.register("d",function(){this.ub&&this.ub.St()},this),{group:"操作",name:"反对"});Dk(Dk(Dk(Dk(Dk(this.eg.register("o",this.xf,this),{group:"操作",name:"显示全部/收起"}).register("c",this.up,this),{group:"操作",name:"打开评论"}).register("f x",this.sc,this),{group:"操作",name:"分享"}).register("s c",this.jj,this),{group:"操作",name:"收藏"}).register("shift+c",this.Pw,this),{group:"操作",
name:"定位到评论框"})};GC.prototype.VA=function(){lw.call(this,"question");this.As="item-footer"};z(GC.prototype.VA,lw);GC.prototype.B=function(){tr.H(this);this.o(document.body);this.Sn();this.Yr();HC();var b=$(".rt-comment-box")[0];if(b){var c=new Xv(this.Ro.id,"roundtable");this.H(c);c.o(b)}};GC.prototype.Sn=function(){this.m().e(this,"click!",function(b){"comment"===b.namespace&&b.wc.fill("label","roundtable").fill("category",this.Vg)})};
GC.prototype.Yr=function(){function b(b){b=b.getAttribute("data-type");return(b={answer:GC.prototype.Ci,question:GC.prototype.VA}[b])?new b:new T}var c=this;$("[data-paging]").each(function(){var d=new FC;d.ma("childConstructor",{factory:b});this.getAttribute("data-navigable")!==k&&d.ma("shortcut",{items:">.item"});c.H(d);d.o(this)})};
a.HC=function(){var b=$(".roundtable-profile");$(".share",b).click(Hm(function(){var b=$(this).data();new yu(["分享活动","roundtable",b.token,{roundtable_id:b.id}],"tb-webshare-sina");W.ga({type:"ga_click_share_roundtable_box",target:this,data:{type:"sina"}})}));$(".follow",b).click(Hm(function(){var c=this;Np(c,"roundtable",function(d){$(".label",c).text(d?"取消关注":"关注");var e=$(".followers .count",b),d=Number(e.data("count"))+(d?1:-1);e.length&&(d=Math.max(d,0),e.text(d).data("count",d))},["button-success",
"button-cancel"])}))};a.IC=function(){T.call(this);this.mz=qh.searchKeyword};z(IC,T);
IC.prototype.B=function(){function b(b,d){var g=$(b);$.each(d(),function(b,d){g.on("click",b,function(b){e.apply(k,c(d,b))})})}function c(b,c){return g(b,function(b){return pa(b)?b(c):b})}tr.H(this);this.o(document.body);this.Yr();var d=encodeURIComponent(this.mz);$("ul.list[data-paging]").on("click",".item a[href!=#]",function(b){b=b.currentTarget;b.host&&(b=$(b).closest(".item").index()+1,Nf.set("s-q",d),Nf.set("s-i",b),Nf.set("sid",gl()))});var e=xa(X,"search"),g=A.map;b(".related-topics",function(){return{"a.avatar-link":["visit_topic",
"search_result_card_topic_avatar"],"a.name-link":["visit_topic","search_result_card_topic"],"a[href$=questions]":["visit_topic_questions","search_result_card_topic"],"a[href$=top-answers]":["visit_topic_topanswers","search_result_card_topic"],"a[href$=followers]":["visit_topic_followers","search_result_card_topic"],"button.zg-btn-follow":["click_follow_topic","search_result_card_topic"],"button.zg-btn-unfollow":["click_unfollow_topic","search_result_card_topic"],'a[href^="/search?"]':["click_search_result_more",
"search_result_card_topic"]}});b(".related-users",function(){return{"a.avatar-link":["visit_people_profile","search_result_card_people_avatar"],"a.name-link":["visit_people_profile","search_result_card_people"],"a[href$=answers]":["visit_people_answers","search_result_card_people"],"a[href$=followers]":["visit_people_followers","search_result_card_people"],"a[href$=posts]":["visit_people_posts","search_result_card_people"],"button.zg-btn-follow":["click_follow_people","search_result_card_people"],
"button.zg-btn-unfollow":["click_unfollow_people","search_result_card_people"],'a[href^="/search?"]':["click_search_result_more","search_result_card_people"]}});b(document.body,function(){var b=xa(Ga,"search_result_%s_more_button");return{"ul.list.questions + .zu-button-more":["click_search_result_more",b("all")],"ul.list.users + .zu-button-more":["click_search_result_more",b("user")],"ul.list.topics + .zu-button-more":["click_search_result_more",b("topic")]}});b(".search-tabs",function(){var b=xa(Ga,
"search_result_tab_%s");return{'a[href^="/search?type=question"]':["click_search_result_tab",b("all")],'a[href^="/search?type=people"]':["click_search_result_tab",b("user")],'a[href^="/search?type=topic"]':["click_search_result_tab",b("topic")]}});b(".range-selector",function(){var b=xa(Ga,"search_result_range_%s");return{'a[href*="range=1d"]':["click_search_result_range",b("1d")],'a[href*="range=1w"]':["click_search_result_range",b("1w")],'a[href*="range=3m"]':["click_search_result_range",b("3m")]}});
b("ul.list.questions",function(){function b(){return function(b){return"search_result_all_list_"+($(b.target).closest(".item").index()+1)+""}}return{"a.question-link":["visit_question",b()],".js-expand, .summary":["click_expand",b()],'a[name="collapse"]':["click_collapse_answer",b()],"a.zg-follow":["click_follow_question",b()],"a.zg-unfollow":["click_unfollow_question",b()]}});b("ul.list.users",function(){function b(c){return function(b){return"search_result_user_list_"+($(b.target).closest(".item").index()+
1)+(c||"")}}return{"a.avatar-link":["visit_people_profile",b("_avatar")],"a.name-link":["visit_people_profile",b()],"a[href$=answers]":["visit_people_answers",b()],"a[href$=followers]":["visit_people_followers",b()],"a[href$=posts]":["visit_people_posts",b()],"button.zg-btn-follow":["click_follow_people",b()],"button.zg-btn-unfollow":["click_unfollow_people",b()]}});b("ul.list.topics",function(){function b(c){return function(b){return"search_result_topic_list_"+($(b.target).closest(".item").index()+
1)+(c||"")}}return{"a.avatar-link":["visit_topic",b("_avatar")],"a.name-link":["visit_topic",b()],"a[href$=questions]":["visit_topic_questions",b()],"a[href$=followers]":["visit_topic_followers",b()],"button.zg-btn-follow":["click_follow_topic",b()],"button.zg-btn-unfollow":["click_unfollow_topic",b()]}});this.m().e(this,"click!",function(b){"comment"===b.namespace&&b.wc.fill("category","search").fill("label","search_result_answer")});var h=$("#js-search-question-form");h.length&&h.submit(function(b){b.preventDefault();
b=vp.N();b.show();yp(b,$(".title-input",h).val())});EC("[data-highlight]",this.mz)};
IC.prototype.Yr=function(){function b(b){var c=new T;$("li.answer-item",b).each(function(){var b=new GC.prototype.Ci;b.As="actions";b.Gp="zm-votebar";c.H(b);b.o(this)});return c}var c=this;$("[data-paging]").each(function(){var d=new Jt({ma:["autoload","dataPagingSource"]});d.ma("childConstructor",{factory:b});var e=$(this).data("navigable");e&&d.ma("shortcut",e);c.H(d);d.o(this);Bt(d,function(b){EC($("[data-highlight]",b),c.mz)})})};a.JC=function(b,c){var d=this.F={};H.extend(d,this.defaults,c||{});this.input=b;this.Tb=d.Tb;this.mh=this.MQ();this.Zu=[];this.Zu.push({action:"remove",method:this.removeTag,tv:d.mR,R:"删除"});setTimeout(v(this.rg,this))};z(JC,Fd);
ya(JC.prototype,{defaults:{source:"/topic/autocomplete",Tb:k,ZK:"",cv:m,nT:"/topic/%s",template:'<li data-id="<%=id%>"><a class="tag-link" href="<%=url%>"><%=name%></a></li>',parse:function(b){var c=$(b);return{it:j,id:c.data("id"),url:b.href,name:c.text()}},hS:nf,pL:"canedit",Lv:"empty",Vm:"button",mR:"remove-button"},KS:function(b){return Et(this.F.nT,b.url_token)},has:function(b){return!!A.find(this.mh,function(c){return c.name===b.name||c.id===b.id})},AL:function(b){return A.find(this.mh,function(c){return c.name===
b})},KW:function(b){return A.find(this.mh,function(c){return c.id===b})},Bd:function(){var b=!!nc(this.Tb).length;F.enable(this.Tb,this.F.Lv,!b);this.dispatchEvent("change")},add:function(b,c){if(b&&(this.has(b)||this.mh.push(b),b.it=m,c||this.F.hS.call(this,b)))this.uR(b),b.it=j,this.dispatchEvent("add"),this.Bd()},remove:function(b){this.mh=A.filter(this.mh,function(c){return b!==c.id},this);this.dispatchEvent("remove");this.Bd()},YL:function(){return A.filter(this.mh,function(b){return b.it!==
m})},XL:function(){return A.map(this.YL(),function(b){return b.id})},uR:function(b){b=ec(this.OG(b));this.Tb.appendChild(b);this.Ee(b)},OG:function(b){return $k(this.F.template,b)},X:function(){this.Tb.innerHTML=A.map(this.mh,this.OG,this).join("")},MQ:function(){return A.map(this.zD(),this.F.parse)},zD:function(){return nc(this.Tb)},rg:function(){var b=this,c=b.F,d=this.input,e={source:c.source,hi:Gc(b.input,function(b){return"static"!==$.css(b,"position")}),placeholder:this.input.getAttribute("placeholder"),
select:function(d){b.add({id:d.id,name:d.id?d.label:b.input.value,url:b.KS(d),avatar:d.avatar,url_token:d.url_token});return c.ZK},filter:function(d){return A.filter(d,function(d){return c.cv&&!d.id?m:!A.find(b.mh,function(b){return b.it&&b.id===d.id})})}},g={Xc:function(b,c,d){d.innerHTML=l(b.data)}};H.extend(g,e||{});var h=new rm(d,g);O(h,"show",function(){1<h.Ya.length&&!h.Ya[0].id&&ul(h)});var l=$k('<% if (data.avatar) { %><img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><% } %><% if(data.type === "search_link" || !data.id){ %><span class="zu-autocomplete-row-name zu-autocomplete-row-name-info"><%=data.type === "search_link"?("添加 "+label+" 话题"):label%></span><% } else { %><span class="zu-autocomplete-row-name"><%=label%></span><% } %><span class="zg-gray-normal zu-autocomplete-row-description"><% if (data.alias && data.followers) { %><% if ( data.alias ) { %>又称 <%=alias%><% } %><% if ( data.alias && data.followers ){ %>，<% } %><% if ( data.followers ){ %><%=followers%> 人关注<% } %><% }else{ %>&nbsp;<% } %></span>');
this.Z=h;A.forEach(this.zD(),this.Ee,this);O(this.input,"keypress",function(d){var e;if(13===d.keyCode&&!c.cv&&(e=Ma(this.value))&&!b.Z.qb())b.add(b.AL(e)||{id:k,name:e,url:"/topic/"+e})});this.Bd()},removeTag:function(b){this.remove($(b).remove().data("id"))},NQ:function(b,c){var d=A.find(this.Zu,function(c){return c.action===b});d&&d.method&&d.method.call(this,c);this.input.focus()},Ee:function(b){var c=this.F;F.add(b,c.pL);A.forEach(this.Zu,function(d){var e=new vj(" ",Ej.N());e.vh([c.Vm,d.tv].join(" "));
e.X(b);e.Za(j);e.Mc(d.R);e.addEventListener("action",function(){this.NQ(d.action,b)},m,this)},this)}});a.KC=function(){this.DA=this.HA=k};
KC.prototype.B=function(){function b(b,c){var g=L("li"),h=L("span","item-label",b);g.appendChild(h);var l=new vj("",Ej.N());l.vh("zm-profile-tag-btn zm-profile-tag-btn-del");l.Za(j);l.Mc("移除动作");l.Aa(c);l.addEventListener("action",function(){var b=l.S();e(b,m);M(g);Z.ft(j);d()});l.X(g);Lb.appendChild(g)}function c(){ta.D(Z.tl()!==A.filter(Z.Cb(),function(b){return!!(b.W&8)}).length)}function d(){A.forEach(R,function(b){b.selected||(b=new fz(b.text,b.value),Z.Ga(b))});c()}function e(b,c){var d=A.find(R,
function(c){return c.value===b});d&&(d.selected=c)}function g(){var b=$.grep(n.get(0).options,function(b){return b.selected});$.map(b,function(b){return b.value})}function h(){q=G.XL();I.val(q.join(","))}var l=$("#rq-settings-ui"),n=$("select.select",l);$(".topics-num",l);$(".actions-num",l);var q=[];this.DA=$("#rq-info-block");l.on("click",".beginedit-button",function(b){b.preventDefault();l.addClass("expanded-view")}).on("click",".exitedit-button",function(b){b.preventDefault();l.removeClass("expanded-view")}).on("click",
".endedit-button",function(b){b.preventDefault();l.get(0).submit()});var r=$(".topic-editor",l),w=$("input.topic-input",r).get(0),x=$("ul.tag-list",r).get(0),G=new JC(w,{cv:j,Tb:x}),I=$('input[name="topics"]',r);G.on("change",h);n.on("change",g);h();g();r=n.get(0);Q(r,m);var R=r.options,Z=new Ut;Z.on("action",function(d){d=d.target;b(d.Cg(),d.S());e(d.S(),j);Z.removeItem(d);c()});var ta=new $t("添加动作",Z);ta.vh("menu-button");ta.X(r.parentNode);ta.$j=j;cu(ta);var Lb=L("ul","display-list");d();A.forEach(R,
function(c){c.selected&&b(c.text,c.value)});r.parentNode.insertBefore(Lb,ta.h());var La=this,r=$("#rq3-item-list"),Sa={OS:function(b){return $.post("/watch/thank",{id:b,rq_type:"thank"})},cR:function(b){return $.post("/watch/seen",{id:b,rq_type:"seen"})}};r.on("click",".read-button",function(){var b=$(this).closest(".rq-item"),c=b.data("id");Sa.cR(c);c=we.text()||0;0<c&&we.text(c-1);var d=La.DA,e=Number(La.HA.text());setTimeout(function(){d.toggleClass("hidden",!!e)},210);b.slideUp(function(){b.remove()})}).on("click",
".thank-button",function(b){b.preventDefault();var b=$(this),c=b.closest(".rq-item").data("id");b.hasClass("thanked")||(Sa.OS(c),b.addClass("thanked").text("已感谢"))});by(r);r=new mu(r.get(0),location.href,j);r.qG=function(b){return b.getAttribute("data-id")};r.li("rq-item");r.B();var r=$("#rq3-sidenav-link"),we=$(".zg-num",r);this.HA=we};a.LC=function(){};LC.prototype.B=function(){$("a.js-obfuscate-email").each(function(){var b=$(this),c=b.data("email").split("").reverse().join("");b.attr("href","mailto:"+c).text(c)})};a.MC=function(){};z(MC,T);MC.prototype.B=function(){tr.H(this);this.o(document.body)};MC.prototype.z=function(){MC.n.z.call(this);var b=$("#zh-following-question-item-list").children(".zh-general-list");if(b.length){var c=new Jt;this.H(c);c.ma("nodeSource");c.o(b.get(0))}};a.NC=function(){T.call(this)};z(NC,T);NC.prototype.z=function(){this.m().e(this.g,"click",this.zo)};NC.prototype.zo=function(b){var c=b.target;c&&"rmdraft"===c.name&&Bi("删除草稿","你确定要删除这个草稿吗？",function(b){b&&(Ei("/draft/delete",k,"POST","qid="+c.id.split("-")[1]),M(this.g))},this)};a.OC=function(){};z(OC,T);OC.prototype.B=function(){var b=J("zh-draft-page-wrap");b&&this.o(b)};
OC.prototype.z=function(){O(J("zh-clear-all-draft"),"click",function(){Bi("删除所有草稿","你确定要删除所有草稿吗？删除后将无法恢复",function(b){b&&Ei("/draft/clear",function(){window.location.href="/draft"},"POST")});return m});this.Pn()};OC.prototype.Pn=function(){var b=J("zh-draft-item-list");if(b){var c=new Jt;c.ma("locationSource",{Rs:j}).ma("childConstructor",{Pi:NC});c.o(b)}};a.PC=void 0,a.QC=function(b,c){b.style.WebkitTransition=c;b.style.MozTransition=c;b.style.WU=c;b.style.LI=c;b.style.cT=c};a.RC=function(b,c,d,e,g){Lj.call(this);this.g=b;this.mL=c;this.RN=d;this.aD=e;this.dT=la(g)?g:[g]};z(RC,Lj);t=RC.prototype;
t.play=function(){if(1==this.W)return m;this.Rg();this.Pc("play");this.startTime=za();this.W=1;if(!ka(PC))if(B)PC=E("10.0");else{var b=document.createElement("div");b.innerHTML='<div style="-webkit-transition:opacity 1s linear;-moz-transition:opacity 1s linear;-o-transition:opacity 1s linear;transition:opacity 1s linear">';b=b.firstChild;PC=ka(b.style.cT)||ka(b.style.WebkitTransition)||ka(b.style.MozTransition)||ka(b.style.LI)}if(PC)return Tf(this.g,this.RN),this.EH=Jd(this.PQ,i,this),j;this.Tz(m);
return m};t.PQ=function(){var b=this.g,c=this.dT;la(c)||(c=[c]);c=A.map(c,function(b){return na(b)?b:b.$Q+" "+b.duration+"s "+b.timing+" "+b.delay+"s"});QC(b,c.join(","));Tf(this.g,this.aD);this.EH=Jd(v(this.Tz,this,m),1E3*this.mL)};t.stop=function(){1==this.W&&this.Tz(j)};t.Tz=function(b){QC(this.g,"");Kd(this.EH);Tf(this.g,this.aD);this.hl=za();this.W=Kj;b?this.Pc("stop"):this.Pc("finish");this.Tg()};t.w=function(){this.stop();RC.n.w.call(this)};a.SC=function(b,c,d,e){return new RC(b,0.15,{opacity:d},{opacity:e},{$Q:"opacity",duration:0.15,timing:c,delay:0})};a.TC=function(){this.Vg="explore";this.zL="explore_feed"};z(TC,T);TC.prototype.B=function(){tr.H(this);this.o(document.body)};
TC.prototype.z=function(){TC.n.z.call(this);var b=this,c=$("#js-explore-tab");if(c.length){var d=$(".tab-panel",c),e=$(".tab-nav",c),g=k;e.children().click(function(){g=Zb(document)});c=function(){var c={"daily-hot":0,"monthly-hot":1}[window.location.hash.slice(1)]||0;e.removeClass("active").eq(c).addClass("active");c=d.hide().eq(c).show().children("[data-type]");if(!c.data("inited")){c.data("inited",j);var h={daily:uy,monthly:wy}[c.data("type")],h=new UC(h);h.ma("expandLimit");b.H(h);h.o(c[0])}g&&
window.scrollTo(g.x,g.y)};this.m().e(window,"hashchange",c);c()}this.qx();if(c=$("#zh-recommend-list-full>.zh-general-list")[0]){var h=new Jt;h.ma("nodeSource");Bt(h,function(b){var c=Hw(b);c&&(h.H(c),c.o(b))});this.H(h);h.o(c)}var c=$("ul.hot-roundtables"),l=$(".hot-roundtables-feature-popup");if(c.children().length&&l.length&&!(300>c.offset().left)){var n=c.children().first(),q=new sq(l[0]);q.lm(m);q.yt(SC(l[0],"ease-out",0,1),SC(l[0],"ease-in",1,0));l.on("click",".dismiss",function(){$.post("/notifeature",
{feature:"explore_roundtable"});q.D(m)});setTimeout(function(){q.D(m);tq(q,2);Rr(q,new Of(-25,10,0,0));q.Lc(new Ks(n[0],0));q.D(j)},200)}this.m().e(this,"click!",function(b){"comment"===b.namespace&&b.wc.fill("category",this.Vg).fill("label",this.zL)})};TC.prototype.qx=function(){var b=1,c=$("ul.hot-favlists"),d=k;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=vy(b).done(function(b){c.html(b)}))})};
a.UC=function(b){At.call(this,{source:function(){return b($(this.Cb()).last().data("offset")).then(function(b){return{results:b}})},ma:["autoload"]})};z(UC,Jt);UC.prototype.z=function(){UC.n.z.call(this);this.ma("childConstructor",{Pi:tw})};a.VC=function(){T.call(this)};z(VC,T);VC.prototype.B=function(){tr.H(this);this.o(document.body)};VC.prototype.z=function(){VC.n.z.call(this);this.Pn()};VC.prototype.Pn=function(){var b=J("js-suggest-people");if(b){var c=0,d=new Jt({source:function(){return $.get("",{start:c+20,limit:20}).then(function(b){if(!b.r)return b=b.msg,b.hasmore&&(c+=20),{results:b.htmls,next:Boolean(b.hasmore)}})}});this.H(d);d.o(b)}};a.WC=function(b){function c(b,c){var d;d=d||"slug";return{source:b,filter:function(b){return b.filter(function(b){return c.every(function(c){return c[d]!==b[d]})})},select:function(b){c.push(b);return""}}}this.pt=b;b.activityUrl="";var b=this.pt,d=b.roundtable;b.topicsSuggestOpitons=c("/r/ac/topics",d.topics);b.organizationsSuggestOpitons=c("/r/ac/topics",d.organizations);b.presentersSuggestOpitons=c("/r/ac/users",d.presenters);b.guestsSuggestOpitons=c("/r/ac/users",d.guests)};WC.$inject=["$scope"];
WC.prototype.removeTag=function(b,c){b.splice((0,A.indexOf)(b,c),1)};WC.prototype.moveupTag=function(b,c){var d=(0,A.indexOf)(b,c);0<d&&(b.splice(d,1),b.splice(d-1,0,c))};WC.prototype.onActvityUrlChange=function(){var b=this.pt,c=b.activityUrl,d=b.roundtable.activityUrls;c&&-1===(0,A.indexOf)(d,c)&&(d.push(c),b.activityUrl="")};
WC.prototype.submit=function(b,c){var d="create"===c,e={roundtable:JSON.stringify(b)};if(d&&3>b.activityUrls.length)return U("请至少添加三条动态");$.post(location.pathname+location.search,e).then(function(d){d.success?"create"===c?(U(d.message||"活动创建成功，请等待审核"),setTimeout(function(){location.href="/roundtable"},3E3)):(U(d.message||"活动修改成功"),setTimeout(function(){location.href="/roundtable/"+b.slug},3E3)):U(d.message||"提交失败")})};a.XC=function(b,c){var d={Xd:5,className:"ui-suggest",bh:"row",XC:200};H.extend(d,c||{});var e=d.X;e&&(d.Xc=ha,d.X=function(b,c){e.apply(this,arguments)!==m&&(b.cg=Ub(b.bh,c))});rm.call(this,b,d);var g=this.L;g.className=d.className;g.bh=d.bh;g.qo=d.XC};z(XC,rm);a.YC=function(b,c){return function(d,e,g){$(e).datetimepicker({autoclose:j,forceParse:m,format:"yyyy 年 m 月 d 日 hh:ii",startDate:new Date,language:"zh-CN"});c(function(){$(e).datetimepicker("update",new Date(b(g.ngModel)(d)))})}};YC.$inject=["$parse","$timeout"];
a.ZC=function(){return{scope:{id:"@id",avatar:"=avatar"},link:function(b,c){var d=new Bx(4,b.id,"xl");d.o(c);d.addEventListener("success",function(){b.$apply(function(){b.avatar.id=d.getData().id})})}}},a.$C=function(b){return{scope:{options:"=suggestOptions"},link:function(c,d,e){var g,h,e={JR:'<div class="row"><img class="avatar" src="[[avatar | avatarUrl]]"><span class="name">[[name]]</span></div>',XC:100,source:e.source,hi:d.parent()[0],X:function(b,c,d){c.innerHTML=d.map(function(b){return h(b.data)}).join("")}};
h=b(e.JR);angular.extend(e,c.options);if(e.select){var l=e.select;e.select=function(b){return c.$apply(function(){return l(b)})}}g=new XC(d[0],e);return c.$on("destroy",function(){return g.G()})}}};$C.$inject=["$interpolate"];a.aD=function(){return function(b,c){return"string"===typeof b?b:b.template.replace("{id}",b.id).replace("{size}",c||"xs")}},a.bD=function(b){b.startSymbol("[[").endSymbol("]]")};bD.$inject=["$interpolateProvider"];a.cD=function(){GC.call(this);this.Ro=qh.roundtable};z(cD,GC);
cD.prototype.B=function(){tr.H(this);this.o(document.body);var b=$(".add-pending-activities-form");if(b.length){var c=$(".url",b),d=$(".time",b);d.datetimepicker({autoclose:j,forceParse:m,format:"yyyy 年 m 月 d 日 hh:ii",startDate:new Date,language:"zh-CN"}).datetimepicker("update",new Date);var e=this.Ro;b.submit(function(b){function g(b){b.success?(U("添加成功"),setTimeout(function(){location.reload()},3E3)):U(b.message||"提交失败")}b.preventDefault();if(!c.val())return U("回答或问题地址必须填写");if(!d.val())return U("发布时间必须填写");
var b=(b=c.val().match(/\/question\/\d+\/answer\/(\d+)/))&&b[1],h=c.val().match(/\/question\/(\d+)/),h=h&&h[1];b?$.post("/roundtable/"+e.slug,{action:"add_pending_activity",publish_time:d.val(),type:"answer",url_token:b},g):h?$.post("/roundtable/"+e.slug,{action:"add_pending_activity",publish_time:d.val(),type:"question",url_token:h},g):U("回答或问题地址不正确")})}var g=this.Ro;$(".feeds.pending-questions").on("click",".add",function(){var b=$(this).data("token"),c=$(this).closest(".item");$.post("/roundtable/"+
g.slug,{action:"approve_question",url_token:b}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})}).on("click",".remove",function(){var b=$(this).data("token"),c=$(this).closest(".item");$.post("/roundtable/"+g.slug,{action:"ignore_question",url_token:b}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})});var h=this.Ro;$(".feeds.pending-activities").on("click",".remove",function(){var b=$(this).data(),c=$(this).closest(".item");
$.post("/roundtable/"+h.slug,{action:"remove_pending_activity",type:b.type,url_token:b.token}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})});HC();this.Yr()};Ca("ZH.entryCommunity",function(){(new AC).B()});Ca("ZH.entryQuestionLog",function(){(new BC).B()});Ca("ZH.entryQuestionFollowersPage",function(){(new DC).B()});Ca("ZH.entrySQ",function(){(new gC).B()});Ca("ZH.entrySA",function(){(new pC).B()});Ca("ZH.entryL",function(){(new yy).B()});Ca("ZH.entryT",function(){(new qy).B()});Ca("ZH.entryTS",function(){(new zC).B()});Ca("ZH.entryP",function(){(new cy).B()});Ca("ZH.entrySearch",function(){(new IC).B()});Ca("ZH.entryPM",function(){(new ku).B()});
Ca("ZH.entryPMDetail",function(){(new lu).B()});Ca("ZH.entrySettings",function(){(new iy).B()});Ca("ZH.entryTopicFeed",function(){(new rC).B()});Ca("ZH.entryRQ3",function(){(new KC).B()});Ca("ZH.entryTerms",function(){(new LC).B()});Ca("ZH.entryHome",function(){(new cz).B()});Ca("ZH.entryQuestionFollowing",function(){(new MC).B()});Ca("ZH.entryDraft",function(){(new OC).B()});Ca("ZH.entryExplore",function(){(new TC).B()});Ca("ZH.entryLookup",function(){(new VC).B()});
Ca("ZH.entryCC",function(){$(function(){$("#js-apply-button").click(Hm(function(){$.post("/classical-chinese");var b=$(this),c=b.data("num");b.text("您已申請使用").addClass("disabled");$(".apply-num").text("已有 "+(c+1)+" 人申請")}))})});Ca("ZH.entryRb",function(){(new GC).B()});
Ca("ZH.entryRbEdit",function(){var b=angular.module("roundtableApp",[]);b.controller("RoundtableFormCtrl",WC);b.directive("uiAvatarEditor",ZC);b.directive("uiSuggest",$C);b.directive("uiTimepicker",YC);b.filter("avatarUrl",aD);b.config(bD);angular.bootstrap(document.body,["roundtableApp"])});Ca("ZH.entryRbPending",function(){(new cD).B()});If("app");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/app.js